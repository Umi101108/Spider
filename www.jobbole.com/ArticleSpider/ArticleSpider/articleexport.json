[{"url_object_id": "4328959c58aa9ead28de3477f219829b", "create_date": "2017/08/03", "front_image_path": "full/13524960e8d4632f6f07ce3aa9b88181ad54518f.jpg", "title": "一文带你理解深度学习的局限性", "url": "http://blog.jobbole.com/112109/", "tags": "IT技术,深度学习", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"https://blog.keras.io/the-limitations-of-deep-learning.html\">Francois Chollet</a>   译文出处：<a target=\"_blank\" href=\"http://www.iteye.com/news/32557\">CSDN - 聂震坤</a>   </div><h3><strong>深度学习：几何视图</strong></h3>\n<p>深度学习最令人惊讶的特点便是极易上手。十年以前，没有人可以猜得到经过梯度下降法训练过的简单参数模型可以在机器感知问题上实现如此惊人的结果。现在，事实证明，研究者所需要做的只是使用足够大的梯度下降素材来训练参数模型。正如 Feynman 曾经描述宇宙一样，“它并不复杂，只是里面包含的东西实在太多。”</p>\n<p>在深度学习中，所有的东西都是一个向量（任何的东西都是几何空间中的一个点）。模型的输入（可能是文字，图片，等等）和目标首先被向量化（变成了一些初始输入向量空间和目标向量空间）。深度学习模型中的每个层都对通过它的数据进行一个简单的几何变换。同时，模型的层链形成一个非常复杂的几何变换，分解成一系列简单的几何变换。这种复杂的转换尝试将输入空间映射到目标空间，一次一个点。该变换按层级的比重进行参数化，这些层根据模型当前执行的程度进行迭代更新。这种几何变换的一个关键特征是它必须是可微分的，这是为了使我们能够通过梯度下降来学习来获得其参数。更直接一点，这意味着从输入到输出的几何变形必须是平滑和连续的——这是一个显着的约束。</p>\n<p>这种复杂的几何变换应用到输入数据的整个过程可以理解为一个试图破坏纸球的人在3D中被可视化。褶皱的纸球可以理解为模型开始时的大量输入数据。每一次人的行为则是数据通过不同层级被处理的过程。完整的不起眼的人的手势序列是整个模型的复杂变换。深度学习模型是用于解决高维数据的复杂流形的数学机器。</p>\n<p>这便是深度学习的奥妙：将含义转化为向量，几何空间，然后逐步学习将一个空间映射到另一个空间的复杂几何变换。所以开发者需要有足够高的维度的空间以便拥有原始数据关系的全部范围。</p>\n<p><strong>深度学习的局限性</strong></p>\n<p>可以通过这种简单策略实现的应用程序空间几乎是无限的。然而到目前为止，更多的应用程序对于当前的深入学习技术是完全无法实现的——即使是大量人为注释的数据。例如，你可以组装一个数据，数十万甚至数百万的英文语言描述软件产品的功能。由产品经理编写，由一个团队开发的相应的源代码并且有工程师满足这些要求。即使有这些数据，也不能训练出一个深入的学习模型来简单地阅读产品描述并生成相应的代码库。这只是其中一个例子。</p>\n<p>一般来说，无论投入多少数据，任何需要推理式编程或应用科学方法（长期规划和类似算法的数据操作）都无法使用深度学习模式进行实现。 即使是学习具有深层神经网络的排序算法也是非常困难的。</p>\n<p>这是因为一个深入的学习模型是“简单的”连续的几何变换链，将一个向量空间映射到另一个。他所可以做的是将一个数据包X映射到另一个数据包Y，并假设存在从X到Y的可学习的连续变换与X:Y的秘籍采用可用性作的数据。所以即使一个深入的学习模型可以被解释为一种程序，相反的大多数程序不能表示为深度学习模型 – 对于大多数任务，要么没有相应的实际大小的深层神经网络来解决任务，要么即使存在一个，它也可能不可学习，即相应的几何变换可能太复杂，或者可能没有可用的数据来学习它。通过堆叠更多层次和使用更多的培训数据来扩展当前的深度学习技术，只能表面缓解其中的一些问题。 深度学习模式在可以代表的方面是非常有限的，而且大多数希望学习的程序不能被表达为连续几何变形的数据流。</p>\n<p><strong>拟人化机器学习模型的隐患</strong></p>\n<p>现阶段人工智能的一个不得不面对的问题在于研究者们误解了深度学习模式的做法，并高估了自己的实力。人类思想的一个根本特征是我们的“主观意识”，我们倾向于对我们周围的事物投射意向，信仰和知识。在一个石头上画一个笑脸感觉石头都变高兴了。同样在深度学习中，当我们有能力成功地训练一个模型来创作描述图片的标题时，我们误认为该模型“理解”图片的内容以及它产生的标题。然而，当轻微改变训练数据中存在的图像时，研发者会非常惊讶的发现模型开始创作完全荒谬的字幕。</p>\n<div><img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/80b358a0334bd3f848b9040a6ecc43b0.png\"></div>\n<h3>通常，这类行为被强调为对抗例子，是通过向深度学习网络输出错误的样本来欺骗模型进行分类。通过梯度上升，可以稍微修改图像，以便最大化给定类的预测。 通过拍摄一只熊猫，并添加一个“长臂猿”梯度，我们可以得到一个神经网络将这只熊猫分类为长臂猿。 这证明了这些模型的脆弱性，以及它们运行的输入到输出映射与我们自己的人类感知之间的深刻差异。</h3>\n<div><img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/28bc6f2c7b510a1638a064d2f67bb284.png\"></div>\n<h3>简而言之，深度学习模式对他们的输入没有任何理解，至少不是从人的意义上来说。我们对图像，声音和语言的理解是基于我们的运动感觉体验。然而机器人却没有这种经验，因此不能以任何以人为本的方式理解他们的驶入。通过输入大量的培训示例来训练我们的模型，我们让他们学习一个几何变换，将数据映射到这个特定的一组示例上的人类概念，但是这个映射只是我们思想中原始模型的简单草图， 从我们的体验中发展出来的假想——就像一面镜子中的一个昏暗的形象。</h3>\n<div><img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/1ed2a28a045dfe53e0409369570c5fb6.png\"></div>\n<h3>作为一名机器学习从业者，始终要注意这一点，不要陷入陷阱，认为神经网络了解他们所执行的任务（并不会） – 至少不会对我们有意义。 他们接受了不同于我们教导，进行了不同的，更窄的任务的训练：即将训练投入与训练目标进行比较。 如果向他们展示偏离训练数据的任何东西，机器将以最荒谬的方式打破以前的结论。</h3>\n<p><strong>局部泛化与极端泛化</strong></p>\n<p>在深度学习模型所做的输入与输出之间的简单的几何变形以及人类思考和学习的方式之间似乎存在着根本的区别。人类不仅仅是从亲身体验中进行学习，还提供了明确的学习方法。除了不同的学习过程外，底层的特性有着根本的却别。</p>\n<p>人类的能力远不止对刺激做出回应，因为深网或者昆虫也可以。人会对目前的情况形成抽象复杂的模型，并根据这些模型来预测不同的未来，且进行长期的规划。人类有能力将已知的概念融合在一起，来表现以前从未经历过的事情，比如穿着牛仔裤的马，或者想象如果中了彩票会做什么。这种处理假设的能力，使我们的心理模型空间远远超过了我们可以直接体验到的一切。这种行为被称为极端泛化。</p>\n<p>这与深层网络的局部泛化形成了鲜明的对比：如果训练时间内新的输入信息差异甚微，则停止从输入到输出的映射。假设使用机器来学习适当的发射参数以解决火箭登陆月球的问题，在使用深网进行此项任务时，无论是使用监督学习还是强化学习进行培训，都需要数以千万次的启动试验作为补充，以便学习从入空间到输出空间的可靠映射。相比之下，人类可以利用抽象能力来提出物理模型——火箭科学，并得到一个精确地解决方案，只需要一次或几次时间即可以让火箭成功登月。同理，如果开发一款控制人体的深网，并希望他学会安全的在城市里行驶。那么在在这种情况下则需要现在各种情况下死掉数千次直到可以推断出危险的行车路线并制定合适的回避行为。当进入一个新的城市，深网有需要重新学习大部分知识。相反，人类能够直接学习安全行为而不用经历死亡，这都要归功于人脑的抽象建模。</p>\n<div><img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/cff17cac3a2dbd53c2f8a966899831d1.png\"></div>\n<h3>简而言之，尽管我们在机器感知方面取得了不小的进步，但是我们仍然离人类级别的人工智能有很大区别。我们的模型只能执行局部泛化，在过去中学习来适应最新的情况。而人类可以极端泛化，迅速适应大胆新奇的情况，或为长期未来的情况进行规划。</h3>\n<p><strong>总结</strong></p>\n<p>作为一个开发者应当记住：迄今为止，深入学习的唯一真正的成功是使用大量的人为注释的数据让机器使用连续的几何变换将空间X映射到空间Y。 做好这一切，则可以改变行业的游戏规则。但想让AI拥有人类的智慧，仍然有很长的路要走。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112109\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112109votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112109\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 1 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "1", "fav_nums": "1", "comment_nums": "", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2016/08/c4ec441b51f9ac4f55dc702a6ae0e757.jpg"]},{"url_object_id": "8d43f3214a6d4c3595599b41dd869a1d", "create_date": "2017/07/31", "front_image_path": "full/d6573fc92df4aa98014ce9dc55320411b7b5bf1d.jpg", "title": "这些奇怪的排序算法，你没见过吧？", "url": "http://blog.jobbole.com/112051/", "tags": "IT技术,趣文小说,排序算法", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文由 <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/snowhere\">孙腾浩</a> 翻译。未经许可，禁止转载！<br>英文出处：<a target=\"_blank\" href=\"https://www.quora.com/What-is-the-strangest-sorting-algorithm\">Quora</a>。欢迎加入<a target=\"_blank\" href=\"http://group.jobbole.com/category/feedback/trans-team/\">翻译组</a>。</div><p>【伯乐在线导读】：如果有人问你哪种排序算法最奇怪，可能你会先在冒泡排序、选择排序、快速排序等常见排序算法中「搜索」了。</p>\n<p>有人在 Quora 上也发帖问了这个问题。于是乎，各种脑洞大开的奇特算法就被列出来了。它们可能存在性能问题或无法实现，但是不可否认其创造性。</p>\n<p><img class=\"alignnone wp-image-112059\" src=\"http://jbcdn2.b0.upaiyun.com/2017/07/15cdc9eaec6ba9ac858b0eaebfb6b949.jpg\" alt=\"黑人问号\" width=\"571\" height=\"326\"></p>\n<h3>睡眠排序（Nipun Ramakrishnan 的回答）</h3>\n<p>这个搞笑算法流传于 4chan 的 /prog/ 板块。无从查证具体出自哪位程序员，伪代码如下</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59870c993a86e727432829\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nprocedure printNumber(n)\r\n    sleep n seconds\r\n    print n\r\nend\r\n\r\nfor arg in args\r\n    run printNumber(arg) in background\r\nend\r\nwait for all processes to finish</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59870c993a86e727432829-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59870c993a86e727432829-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59870c993a86e727432829-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59870c993a86e727432829-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59870c993a86e727432829-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59870c993a86e727432829-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59870c993a86e727432829-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59870c993a86e727432829-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59870c993a86e727432829-9\">9</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59870c993a86e727432829-1\"><span class=\"crayon-e\">procedure </span><span class=\"crayon-e\">printNumber</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">n</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59870c993a86e727432829-2\"><span class=\"crayon-h\">    </span><span class=\"crayon-i\">sleep</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">n</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">seconds</span></div><div class=\"crayon-line\" id=\"crayon-59870c993a86e727432829-3\"><span class=\"crayon-e\">    </span><span class=\"crayon-i\">print</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">n</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59870c993a86e727432829-4\"><span class=\"crayon-st\">end</span></div><div class=\"crayon-line\" id=\"crayon-59870c993a86e727432829-5\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59870c993a86e727432829-6\"><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">arg </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">args</span></div><div class=\"crayon-line\" id=\"crayon-59870c993a86e727432829-7\"><span class=\"crayon-e\">    </span><span class=\"crayon-e\">run </span><span class=\"crayon-e\">printNumber</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">arg</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">background</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59870c993a86e727432829-8\"><span class=\"crayon-st\">end</span></div><div class=\"crayon-line\" id=\"crayon-59870c993a86e727432829-9\"><span class=\"crayon-e\">wait </span><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">all </span><span class=\"crayon-e\">processes </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">finish</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0011 seconds] -->\r\n<p>算法运行如下： 对于数组中每个元素 x，开启一个新程序：</p>\n<ul>\n<li>休眠 x 秒</li>\n<li>打印 x 所有元素同时开始计时。 只适用于非负数字。</li>\n</ul>\n<h3>Bogo 排序/猴子排序 （Ryan Turner的回答）</h3>\n<p>Bogo 排序/猴子排序，名字很奇怪。它是<a href=\"https://en.m.wikipedia.org/wiki/Stupid_sort\">愚蠢排序</a>中的一员。</p>\n<p>主要来说，算法就是你把元素随机排列。</p>\n<p>如果没有排好序，再次把元素随机排列。</p>\n<p>如果还没有排好序，你懂的。下面是个例子：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59870c993a879655669417\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n4, 7, 9, 6, 5, 5, 2, 1 (未排序)\r\n2, 5, 4, 7, 5, 9, 6, 1 (随机排列)\r\n1, 4, 5, 6, 9, 7, 5, 2 (再次随机排列)\r\n1, 2, 4, 5, 5, 6, 7, 9 (天呐，真幸运)</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59870c993a879655669417-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59870c993a879655669417-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59870c993a879655669417-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59870c993a879655669417-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59870c993a879655669417-1\"><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">7</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">9</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">6</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">5</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">5</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span>未排序<span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59870c993a879655669417-2\"><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">5</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">7</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">5</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">9</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">6</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span>随机排列<span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59870c993a879655669417-3\"><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">5</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">6</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">9</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">7</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">5</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span>再次随机排列<span class=\"crayon-sy\">)</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59870c993a879655669417-4\"><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">5</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">5</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">6</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">7</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">9</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span>天呐，真幸运<span class=\"crayon-sy\">)</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0021 seconds] -->\r\n<p>你不停地随机排序，直到得到一个有序数组。</p>\n<p>毫无疑问这是最低效的排序算法之一，除非你非常非常幸运。它时间复杂度是令人窒息的 O(n!)，而且随着元素数量增加，很有 O(∞) 的趋势。</p>\n<h3>量子 Bogo 排序（Tyler Schroeder 的回答）</h3>\n<p>我是量子 Bogo 排序的粉丝：</p>\n<ul>\n<li>随机排列数组中元素。</li>\n<li>如果数组没有排好序，摧毁当前宇宙（这一步就拜托你了）</li>\n<li>存活的宇宙将会有排好序的数组。 时间复杂度仅仅 O(n) 注意：这种算法依赖于量子力学的平行宇宙理论的可靠性。如果量子力学的平行宇宙理论不准确，这个算法时间复杂度达不到 O(n)</li>\n</ul>\n<h3>打印店页码排序 （Yi Wang的回答）</h3>\n<p>这并不是我发明的，我从别处看到的。</p>\n<p>一个学生去打印店打印材料。他需要两份，但并没有直接打印两份，而是将每一页打印了两次，像下面这样：</p>\n<p>需要的页码顺序: 1 2 3 4 … N; 1 2 3 4 … N</p>\n<p>手上的页码顺序: 1 1 2 2 3 3 4 4 …. N N</p>\n<p>他开始对打印材料排序，取一页放在左边，然后取一页放在右边。打印店老板看不下去了，直接把材料拿过来。</p>\n<p>老板首先取一页放在左边，然后两页放在右边，再然后两页左边，两页右边…… 排序速度瞬间翻倍 ……</p>\n<p>（有网友评论提醒：这是归纳，不是排序）</p>\n<h2>下面是其他网友的回答：</h2>\n<h3>慢排序</h3>\n<p>这是一个非常幽默却没什么用的排序算法。它基于“合而不治”的原则（分治算法基本思想“分而治之”的反义词，文字游戏），它由 Andrei Broder 和 Jorge Stolfi 于 1986 年发表在论文《Pessimal Algorithms and Simplexity Analysis（最坏排序和简单性分析）》中，伪代码如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59870c993a87e629057551\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nfunction slowSort(array,start,end){\r\n    if( start &gt;= end ) return; //已经不能再慢了\r\n    middle = floor( (start+end)/2 );\r\n\r\n    //递归\r\n    slowSort(array,start,middle);\r\n    slowSort(array,middle+1,end);\r\n\r\n    //比较得出最大值放在队尾\r\n    if( array[end] &lt; array[middle] )\r\n        swap array[end] and array[middle]\r\n\r\n    //去掉最大值之后再排序\r\n    slowsort(array,start,end-1);\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59870c993a87e629057551-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59870c993a87e629057551-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59870c993a87e629057551-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59870c993a87e629057551-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59870c993a87e629057551-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59870c993a87e629057551-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59870c993a87e629057551-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59870c993a87e629057551-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59870c993a87e629057551-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59870c993a87e629057551-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-59870c993a87e629057551-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59870c993a87e629057551-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-59870c993a87e629057551-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59870c993a87e629057551-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-59870c993a87e629057551-15\">15</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59870c993a87e629057551-1\"><span class=\"crayon-t\">function</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">slowSort</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">start</span><span class=\"crayon-sy\">,</span><span class=\"crayon-st\">end</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59870c993a87e629057551-2\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">if</span><span class=\"crayon-sy\">(</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">start</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&gt;=</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">end</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">return</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">//已经不能再慢了</span></div><div class=\"crayon-line\" id=\"crayon-59870c993a87e629057551-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">middle</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">floor</span><span class=\"crayon-sy\">(</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">start</span><span class=\"crayon-o\">+</span><span class=\"crayon-st\">end</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59870c993a87e629057551-4\"> </div><div class=\"crayon-line\" id=\"crayon-59870c993a87e629057551-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-c\">//递归</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59870c993a87e629057551-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">slowSort</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">start</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">middle</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59870c993a87e629057551-7\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">slowSort</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">middle</span><span class=\"crayon-o\">+</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-st\">end</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59870c993a87e629057551-8\"> </div><div class=\"crayon-line\" id=\"crayon-59870c993a87e629057551-9\"><span class=\"crayon-h\">    </span><span class=\"crayon-c\">//比较得出最大值放在队尾</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59870c993a87e629057551-10\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">if</span><span class=\"crayon-sy\">(</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">[</span><span class=\"crayon-st\">end</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">middle</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-59870c993a87e629057551-11\"><span class=\"crayon-h\">        </span><span class=\"crayon-e\">swap </span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">[</span><span class=\"crayon-st\">end</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">and</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">middle</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59870c993a87e629057551-12\"> </div><div class=\"crayon-line\" id=\"crayon-59870c993a87e629057551-13\"><span class=\"crayon-h\">    </span><span class=\"crayon-c\">//去掉最大值之后再排序</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59870c993a87e629057551-14\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">slowsort</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">array</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">start</span><span class=\"crayon-sy\">,</span><span class=\"crayon-st\">end</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-59870c993a87e629057551-15\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0024 seconds] -->\r\n<p></p>\n<ul>\n<li>递归排序好前一半</li>\n<li>递归排序好后一半</li>\n<li>比较中间和队尾的值，得到整个数组的最大值，将最大值放到队尾。</li>\n<li>去掉最大值，递归整个数组</li>\n</ul>\n<h3>Stack 排序</h3>\n<p>从 StackOverflow 上搜索标题含有“数组排序”的帖子，复制粘贴并运行其中的代码片段，直到数组排好序。我认为这种排序算法事实上验证了整个数组。它被发表在<a href=\"https://xkcd.com/1185/\">xkcd网站</a>上，这里有一个在线版的具体实现<a href=\"https://gkoberger.github.io/stacksort/\">stacksort</a></p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/07/87e983d6fd4a07bf10518f60d84c2595.png\"><img class=\"alignnone size-medium wp-image-65367\" src=\"http://jbcdn2.b0.upaiyun.com/2017/07/87e983d6fd4a07bf10518f60d84c2595.png\" alt=\"stacksort\"></a></p>\n<h3>随机排序</h3>\n<p>运行如下： 创建一个随机程序。 传入数组并运行随机程序。 如果程序的输出恰好是排好序的，完成。 否则重复上面过程。</p>\n<h3>太阳能比特翻转排序</h3>\n<p>太阳发出的阿尔法粒子偶尔能够翻转内存中的比特位，所以这种算法主要基于希望这种翻转能够使元素正确排序。运行方式如下：</p>\n<p>检查数组是否排好序。 如果排好序，返回这个数组。 如果没有，等 10 秒钟并祈祷太阳辐射使得比特位翻转，而且使得数组排好序，重复第一步。</p>\n<h3>意大利面排序</h3>\n<p>这是一种线性时间算法，是需要 O(n) 空间的稳定排序。它需要并行处理器。简单来说，假设我们排序一列自然数。排序方法需要使用很多根生的意大利面条。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/07/eb19bcfbd683bded0fdd0b92891aac90.png\"><img class=\"size-medium wp-image-65368\" src=\"http://jbcdn2.b0.upaiyun.com/2017/07/eb19bcfbd683bded0fdd0b92891aac90.png\" alt=\"意大利面\"></a></p>\n<p>将数据按比例转换成表示意大利面条长度的数字。 在每根面条上写下数字，并将面条折断成数字表示的长度。 把所有面条攥成一捆并把底部在平面上敲击。 取出最突出的一根面条，也就是最长的一根，获取上面的数字，转换成原始的数据并记录下来。 重复这个过程直到处理完所有意大利面。</p>\n<h3>指鹿为马排序</h3>\n<p>这个算法时间复杂度 O(n)。 聚集一帮人并向他们展示数组。 询问他们这个数组是否是排序好的。 干掉其中认为没有排序好的人。 重复几次，直到所有人同意这个数组是排序好的。</p>\n<h3>智能设计排序</h3>\n<p>无论你的数组状态是什么样的，它都算是排好序的。 解释：原始输入按照某种顺序的概率是 1/(n!)。概率是如此小，（当前的顺序）归结于运气成分显然是荒谬的，所以它是按照“智能设计”排序过的。所以完全可以说数组已经排好序了，只是不是我们传统意义上的“升序”。如果按照我们传统观点对它进行操作，只会让它乱序。（<a href=\"https://zh.wikipedia.org/wiki/%E6%99%BA%E8%83%BD%E8%AE%BE%E8%AE%A1\">“智能设计”涉及宗教和哲学，不过多解释</a>）</p>\n<h3>互联网排序</h3>\n<p>这是一种冒泡排序，但每次比较都依靠互联网的搜索。比如 “0.211 和 0.75 哪个大？”</p>\n<h3>委员会排序</h3>\n<p>排序一个包含 N 个自然数的数组，首先用纸打印出 N 份整个数组。 然后在办公室周围选择几个恰好路过的倒霉委员。每个委员对应数组中的一个数字。 给每个委员一份打印的数组，并让他们通过开会或其他手段，来决定自己代表的数字应该在有序数组中的位置。 当这些委员有结论并答复你时，数组自然排好序了。</p>\n\r\n        \r\n            <blockquote class=\"rewards\">\n        <p><strong>打赏支持我翻译更多好文章，谢谢！</strong></p>\n        <a href=\"#rewardbox\" id=\"rewards-button\" class=\"fancybox\"><span class=\"btn-bluet-blue href-style\"><i class=\"fa fa-jpy\"></i> 打赏译者</span></a>\n    </blockquote>\n\n    <div id=\"rewardbox\">\n        <h4>打赏支持我翻译更多好文章，谢谢！</h4>\n                <p>任选一种支付方式</p>\n                <p>\n                        <img src=\"http://jbcdn2.b0.upaiyun.com/2017/01/5085cce1bd4e144b7d148079a34b20c1.jpg\">\n            \n                            <img src=\"http://jbcdn2.b0.upaiyun.com/2017/01/02b09a29fdb3ab5fe03d4bd1afe95664.jpg\">\n                    </p>\n    </div>\n\n    \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112051\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112051votetotal\">2</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112051\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 6 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/snowhere\">孙腾浩</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/snowhere\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2017/06/47765e50cfb7c4e598e72d893ab4f62f.jpg\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            毕业于郑州大学软件工程专业，身为 Java 程序猿却同样热爱着 JavaScript 。为了兴趣而写代码，做自己喜欢做的事。Keep coding ... Stay Cool ...        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/snowhere\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/snowhere/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/snowhere/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 17</a> · <a title=\"我的网站\" target=\"_blank\" href=\"http://snowhere.me/\"><i class=\"fa fa-link\"></i></a> <a title=\"GitHub主页\" target=\"_blank\" href=\"https://github.com/Snowhere/\"><i class=\"fa fa-github\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "2", "fav_nums": "6", "comment_nums": "", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/07/15cdc9eaec6ba9ac858b0eaebfb6b949.jpg"]},{"url_object_id": "1a8e6c64968ed6db401b5769221f9b4f", "create_date": "2017/07/31", "front_image_path": "full/f42d1238aa0f889b8988c70dd7481c7a4bd3b456.jpg", "title": "Neo4j 图数据库基础", "url": "http://blog.jobbole.com/112064/", "tags": "IT技术,数据库", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"https://opensource.com/article/17/7/fundamentals-graph-databases-neo4j\">Ruth Holloway</a>   译文出处：<a target=\"_blank\" href=\"https://linux.cn/article-8728-1.html\">Linux中国/geekpi</a>   </div><blockquote><p>在这个三篇系列文章的第一篇文章中，我们将学习图数据库（graph database）的基础知识，它支持了这地球上最大的一些数据池。</p></blockquote>\n<p>对于海量的各种非结构化信息来说，图数据库已经成为帮助收集、管理和搜索大量数据的技术。在这三篇系列文章中，我们将使用开源图数据库软件 Neo4j 来研究图数据库。</p>\n<p>在本文中，我将向你展示图数据库的基础知识，帮助你快速了解概念模型。在第二篇中，我将向你展示如何启动 Neo4j 数据库，并使用内置的浏览器工具填充一些数据。而且，在本系列的最后一篇文章中，我们将探讨一些在开发工作中使用的 Neo4j 编程库。</p>\n<p>掌握图数据库的概念模型是有用的，所以我们从那里开始。图数据库中只存储两种数据：节点node和边edge。</p>\n<ul>\n<li><strong>节点是实体：</strong>诸如人物、发票、电影、书籍或其他具体事物。这些有些等同于关系数据库中的记录或行。</li>\n<li><strong>边名关系：</strong>连接节点的概念、事件或事物。在关系数据库中，这些关系通常存储在具有链接字段的数据库行中。在图数据库中，它们本身就是有用的，是可以以其自己的权限搜索的对象。</li>\n</ul>\n<p>节点和边都可以拥有可搜索的<em>属性</em>。例如，如果你的节点代表人，他们可能拥有名字、性别、出生日期、身高等属性。而边的属性可能描述了两个人之间的关系何时建立，见面的情况或关系的性质。</p>\n<p>这是一个帮助你可视化的图表：</p>\n<p><img class=\"aligncenter\" title=\"Graph database image 1\" src=\"http://jbcdn2.b0.upaiyun.com/2017/07/61f03ca246db79a877365543604ae7de.jpg\" alt=\"Graph database image 1\"></p>\n<p>在这张图中，你知道 Jane Doe 有一个新的丈夫 John；一个女儿（来自她以前的夫妻关系）Mary Smith 和朋友 Robert 和 Rhonda Roe。Roes 有一个儿子 Ryan，他正在与 Mary Smith 约会。</p>\n<p>看看它怎么工作？每个节点代表一个独立于其他节点的人。你需要找到关于<em>那个</em>人的一切都可以存储在节点的属性中。边描述了人们之间的关系，这与你在程序中需要的一样多。</p>\n<p>关系是单向的，且不能是无向的，但这没有问题。由于数据库可以以相同的速度遍历两个方向，并且方向可以忽略，你只需要定义一次此关系。如果你的程序需要定向关系，则可以自由使用它们，但如果双向性是暗含的，则不需要。</p>\n<p>另外需要注意的是，图数据库本质上是无 schema 的。这与关系数据库不同，关系数据库每行都有一组列表，并且添加新的字段会给开发和升级带来很多工作。</p>\n<p>每个节点都可以拥有一个标签label；对于大多数程序你需要“输入”这个标签，是对典型的关系数据库中的表名的模拟。标签可以让你区分不同的节点类型。如果你需要添加新的标签或属性，修改程序来用它就行！</p>\n<p>使用图数据库，你可以直接开始使用新的属性和标签，节点将在创建或编辑时获取它们。不需要转换东西；只需在你的代码中使用它们即可。在这里的例子中，你可以看到，我们知道 Jane 和 Mary 最喜欢的颜色和 Mary 的出生日期，但是别人没有（这些属性）。这个系统不需要知道它；用户可以在正常使用程序的过程中访问节点时为其添加信息（属性）。</p>\n<p>作为一名开发人员，这是一个有用的特性。你可以将新的标签或属性添加到由节点处理的表单中并开始使用它，而不必进行数据库 schema 的修改。对于没有该属性的节点，将不显示任何内容。你可以使用任何一种类型的数据库来为表单进行编码，但是你可以放下在关系型数据库中要进行的许多后端工作了。</p>\n<p>让我们添加一些新的信息：</p>\n<p><img class=\"aligncenter\" title=\"Graph database image 2, defining a new type of node\" src=\"http://jbcdn2.b0.upaiyun.com/2017/07/5362edb32fd33fc06def8b3a179b978a.jpg\" alt=\"Graph database image 2, defining a new type of node\"></p>\n<p>这是一个新的节点类型，它代表一个位置，以及一些相关关系。现在我们看到 John Doe 出生在加利福尼亚州的 Petaluma，而他的妻子 Jane 则出生在德克萨斯州的 Grand Prairie。 他们现在住在得克萨斯州的赛普拉斯，因为 Jane 在附近的休斯顿工作。Ryan Roe 缺乏城市关系对数据库来说没有什么大不了的事情，我们<em>不知道</em>那些信息而已。当用户输入更多数据时，数据库可以轻松获取新数据并添加新数据，并根据需要创建新的节点和关系。</p>\n<p>了解节点和边应该足以让你开始使用图形数据库。如果你像我一样，已经在考虑如何在一个图中重组你的程序。在本系列的下一篇文章中，我将向你展示如何安装 Neo4j、插入数据，并进行一些基本的搜索。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112064\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112064votetotal\">2</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112064\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 1 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "2", "fav_nums": "1", "comment_nums": "", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2012/03/database-logo.png"]},{"url_object_id": "965945816f129cd59abb415e3b1e26c9", "create_date": "2017/07/31", "front_image_path": "full/e8f8b7fe8c56ba964bd5eb1fadab627b06618a67.jpg", "title": "ss：查看网络连接的另一种方法", "url": "http://blog.jobbole.com/112061/", "tags": "IT技术,Linux", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"https://insights.ubuntu.com/2017/07/25/ss-another-way-to-get-socket-statistics/\">Mathieu Trudel-lapierre</a>   译文出处：<a target=\"_blank\" href=\"https://linux.cn/article-8727-1.html\">Linux中国/Vic020</a>   </div><p>在之前的文章中，我提到过 <code>ss</code>，它是 iproute2 包附带的另一个工具，允许你查询 socket 的有关统计信息。可以完成 <code>netstat</code> 同样的任务，但是，<code>ss</code> 稍微快一点而且命令更简短。</p>\n<p>直接输入 <code>ss</code>，默认会显示与 <code>netstat</code> 同样的内容，并且输入类似的参数可以获取你想要的类似输出。例如：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987218216961014196276\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ ss -t\r\nState       Recv-Q Send-Q       Local Address:Port                        Peer Address:Port\r\nESTAB       0      0                127.0.0.1:postgresql                     127.0.0.1:48154\r\nESTAB       0      0            192.168.0.136:35296                      192.168.0.120:8009\r\nESTAB       0      0            192.168.0.136:47574                     173.194.74.189:https\r\n[…]</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987218216961014196276-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987218216961014196276-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987218216961014196276-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987218216961014196276-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987218216961014196276-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987218216961014196276-6\">6</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987218216961014196276-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ss</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">t</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987218216961014196276-2\"><span class=\"crayon-i\">State</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-v\">Recv</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">Q</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Send</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">Q</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-e\">Local </span><span class=\"crayon-v\">Address</span><span class=\"crayon-o\">:</span><span class=\"crayon-i\">Port</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-e\">Peer </span><span class=\"crayon-v\">Address</span><span class=\"crayon-o\">:</span><span class=\"crayon-e\">Port</span></div><div class=\"crayon-line\" id=\"crayon-5987218216961014196276-3\"><span class=\"crayon-i\">ESTAB</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">127.0.0.1</span><span class=\"crayon-o\">:</span><span class=\"crayon-i\">postgresql</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-cn\">127.0.0.1</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">48154</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987218216961014196276-4\"><span class=\"crayon-i\">ESTAB</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">192.168.0.136</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">35296</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">192.168.0.120</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">8009</span></div><div class=\"crayon-line\" id=\"crayon-5987218216961014196276-5\"><span class=\"crayon-i\">ESTAB</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">192.168.0.136</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">47574</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-cn\">173.194.74.189</span><span class=\"crayon-o\">:</span><span class=\"crayon-i\">https</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987218216961014196276-6\"><span class=\"crayon-sy\">[</span>…<span class=\"crayon-sy\">]</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0033 seconds] -->\r\n<p><code>ss -t</code> 只显示 TCP 连接。<code>ss -u</code> 用于显示 UDP 连接，<code>-l</code> 参数只会显示监听的端口，而且可以进一步过滤到任何想要的信息。</p>\n<p>我并没有测试所有可用参数，但是你甚至可以使用 <code>-K</code> 强制关闭 socket。</p>\n<p><code>ss</code> 真正耀眼的地方是其内置的过滤能力。让我们列出所有端口为 22（ssh）的连接：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721821697f305922320\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ ss state all sport = :ssh\r\nNetid State      Recv-Q Send-Q     Local Address:Port                      Peer Address:Port\r\ntcp   LISTEN     0      128                    *:ssh                                  *:*\r\ntcp   ESTAB      0      0          192.168.0.136:ssh                      192.168.0.102:46540\r\ntcp   LISTEN     0      128                   :::ssh                                 :::*</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721821697f305922320-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721821697f305922320-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-598721821697f305922320-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721821697f305922320-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-598721821697f305922320-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721821697f305922320-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ss </span><span class=\"crayon-e\">state </span><span class=\"crayon-e\">all </span><span class=\"crayon-v\">sport</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-e\">ssh</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721821697f305922320-2\"><span class=\"crayon-e\">Netid </span><span class=\"crayon-i\">State</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-v\">Recv</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">Q</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Send</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">Q</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-e\">Local </span><span class=\"crayon-v\">Address</span><span class=\"crayon-o\">:</span><span class=\"crayon-i\">Port</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-e\">Peer </span><span class=\"crayon-v\">Address</span><span class=\"crayon-o\">:</span><span class=\"crayon-e\">Port</span></div><div class=\"crayon-line\" id=\"crayon-598721821697f305922320-3\"><span class=\"crayon-i\">tcp</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-i\">LISTEN</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">128</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-o\">*</span><span class=\"crayon-o\">:</span><span class=\"crayon-i\">ssh</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-o\">*</span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">*</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721821697f305922320-4\"><span class=\"crayon-i\">tcp</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-i\">ESTAB</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">192.168.0.136</span><span class=\"crayon-o\">:</span><span class=\"crayon-i\">ssh</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">192.168.0.102</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">46540</span></div><div class=\"crayon-line\" id=\"crayon-598721821697f305922320-5\"><span class=\"crayon-i\">tcp</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-i\">LISTEN</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">128</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-o\">::</span><span class=\"crayon-o\">:</span><span class=\"crayon-i\">ssh</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-o\">::</span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">*</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0037 seconds] -->\r\n<p>如果只想看已建立的 socket（排除了 <em>listening</em> 和 <em>closed</em> ）：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987218216985594848215\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ ss state connected sport = :ssh\r\nNetid State      Recv-Q Send-Q     Local Address:Port                      Peer Address:Port\r\ntcp   ESTAB      0      0          192.168.0.136:ssh                      192.168.0.102:46540</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987218216985594848215-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987218216985594848215-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987218216985594848215-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987218216985594848215-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ss </span><span class=\"crayon-e\">state </span><span class=\"crayon-e\">connected </span><span class=\"crayon-v\">sport</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">:</span><span class=\"crayon-e\">ssh</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987218216985594848215-2\"><span class=\"crayon-e\">Netid </span><span class=\"crayon-i\">State</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-v\">Recv</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">Q</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Send</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">Q</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-e\">Local </span><span class=\"crayon-v\">Address</span><span class=\"crayon-o\">:</span><span class=\"crayon-i\">Port</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-e\">Peer </span><span class=\"crayon-v\">Address</span><span class=\"crayon-o\">:</span><span class=\"crayon-e\">Port</span></div><div class=\"crayon-line\" id=\"crayon-5987218216985594848215-3\"><span class=\"crayon-i\">tcp</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-i\">ESTAB</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">192.168.0.136</span><span class=\"crayon-o\">:</span><span class=\"crayon-i\">ssh</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">192.168.0.102</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">46540</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0019 seconds] -->\r\n<p>类似的，可以列出指定的 host 或者 ip 段。例如，列出到达 74.125.0.0/16 子网的连接，这个子网属于 Google：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987218216989613590741\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ ss state all dst 74.125.0.0/16\r\nNetid State      Recv-Q Send-Q     Local Address:Port                      Peer Address:Port\r\ntcp   ESTAB      0      0          192.168.0.136:33616                   74.125.142.189:https\r\ntcp   ESTAB      0      0          192.168.0.136:42034                    74.125.70.189:https\r\ntcp   ESTAB      0      0          192.168.0.136:57408                   74.125.202.189:https</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987218216989613590741-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987218216989613590741-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987218216989613590741-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987218216989613590741-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987218216989613590741-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987218216989613590741-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">ss </span><span class=\"crayon-e\">state </span><span class=\"crayon-e\">all </span><span class=\"crayon-i\">dst</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">74.125.0.0</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">16</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987218216989613590741-2\"><span class=\"crayon-e\">Netid </span><span class=\"crayon-i\">State</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-v\">Recv</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">Q</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Send</span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">Q</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-e\">Local </span><span class=\"crayon-v\">Address</span><span class=\"crayon-o\">:</span><span class=\"crayon-i\">Port</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-e\">Peer </span><span class=\"crayon-v\">Address</span><span class=\"crayon-o\">:</span><span class=\"crayon-e\">Port</span></div><div class=\"crayon-line\" id=\"crayon-5987218216989613590741-3\"><span class=\"crayon-i\">tcp</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-i\">ESTAB</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">192.168.0.136</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">33616</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-cn\">74.125.142.189</span><span class=\"crayon-o\">:</span><span class=\"crayon-e\">https</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987218216989613590741-4\"><span class=\"crayon-i\">tcp</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-i\">ESTAB</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">192.168.0.136</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">42034</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">74.125.70.189</span><span class=\"crayon-o\">:</span><span class=\"crayon-e\">https</span></div><div class=\"crayon-line\" id=\"crayon-5987218216989613590741-5\"><span class=\"crayon-i\">tcp</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-i\">ESTAB</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-cn\">192.168.0.136</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">57408</span><span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span> <span class=\"crayon-h\"> </span><span class=\"crayon-cn\">74.125.202.189</span><span class=\"crayon-o\">:</span><span class=\"crayon-v\">https</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0032 seconds] -->\r\n<p><code>ss</code>与 iptables 的语法非常相同，如果已经熟悉了其语法，<code>ss</code> 非常容易上手。也可以安装 iproute2-doc 包， 通过 <code>/usr/share/doc/iproute2-doc/ss.html</code> 获得完整文档。</p>\n<p>还不快试试! 你就可以知道它有多棒。无论如何，让我输入的字符越少我越高兴。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112061\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112061votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112061\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 1 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "1", "fav_nums": "1", "comment_nums": "", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2016/04/149000d5c8b1bb08b8de6914ed749f28.gif"]},{"url_object_id": "5e8243d793df35a9502c06640a79ceee", "create_date": "2017/07/28", "front_image_path": "full/4ccab0a38c3c13879135519b200e0c60ce7498bb.jpg", "title": "可能是迄今为止最好的 GitHub 代码浏览插件", "url": "http://blog.jobbole.com/112011/", "tags": "工具与资源,Github", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"http://www.geeksense.cn/plugin/\">geeksense</a>   </div><p>【伯乐在线转注】：以前曾介绍过一个 Chrome 插件 <a href=\"http://t.cn/RPZJZfD\" target=\"_blank\">Octotree</a>。安装之后，浏览托管在 Github上的项目，可看到左侧的树形结构，更方便查看代码。今天这篇文章介绍另外一个同类插接。</p>\n<hr>\n<p>GitHub是很多开发者远(tong)程(xing)协(jiao)作(you)的重要工具，其社交化编码的理念伴随着开源运动改变着整个开发社区的生态，无数优质项目依托GitHub在全球开源开发者的参与下蓬勃发展。</p>\n<p><strong>不过，讲真，你有在GitHub上好好读过代码吗？</strong></p>\n<p>对于大部分人来说恐怕是没有，GitHub作为一款基于Git的代码管理工具和协同工具是很优秀的，然而作为代码浏览和搜索工具，就和IDE差的很远了。不然为什么到今天GitHub连个侧栏的文件树没有，很多开发者要专门去下载浏览器插件才能有文件树？为什么你还是需要git clone到本地在把代码装到你的IDE里才能愉快的阅读代码？是不是有想过如果能像IDE那样在GitHub上浏览代码多好？</p>\n<p>今天我们就来介绍一款Chrome浏览器插件Insight.io，让你能像在GitHub上像你的IDE里一样浏览和搜索代码，让你的Github就像穿上了钢铁侠的战衣。</p>\n<p><img id=\"pic\" class=\"\" src=\"http://wx2.sinaimg.cn/large/7cc829d3gy1fhzg5vidjjg20dq094wp8.gif\"></p>\n<h2 id=\"\">功能总览</h2>\n<p><a href=\"https://chrome.google.com/webstore/detail/insightio/pmhfgjjhhomfplgmbalncpcohgeijonh\">下载安装</a>后，打开一个GitHub上的项目，会看到左边有个侧边栏，是不是已经有了自己在IDE里面的感觉了？插件提供以下功能</p>\n<ul>\n<li><strong>跳转到定义</strong></li>\n<li><strong>查找引用</strong></li>\n<li><strong>目录树功能</strong></li>\n<li><strong>基于符号的代码搜索</strong></li>\n</ul>\n<p><img src=\"http://wx3.sinaimg.cn/large/7cc829d3gy1fhzg5waddog21410osb29.gif\" alt=\"Glance\"></p>\n<p> </p>\n<h2 id=\"\">交叉引用</h2>\n<p>用<a href=\"https://github.com/apache/spark\">Apache Spark</a>做例子，悬浮在某个节点(类，方法，变量等)上就可以看到相应的类型和文档说明。点击左边的结构(Structure)按钮就可以看到改文件的类结构，包括成员变量，成员函数等，点击也可以跳到相应的行。</p>\n<p><img src=\"http://wx3.sinaimg.cn/large/7cc829d3gy1fhzg5y5wqwg21400ot1l0.gif\" alt=\"Cross Reference\"></p>\n<h2 id=\"\">查找引用</h2>\n<p>点击任何节点的用例就能跳到这个类，方法或者变量定义的地方（类似于IDE中的Ctrl + click）。</p>\n<p>点击类，方法和变量的定义节点，则可以找出所有该节点的使用例子。其中使用例子又会以被引用(Referenced At), 继承 (Inherit), 被继承(Inherited By), 重写(Override)等类型进一步分类方便查找。如果结果太多，用例的右上方也会有支持regular expression的文本框可以用来过滤出感兴趣的文件。</p>\n<p><img src=\"http://wx3.sinaimg.cn/large/7cc829d3gy1fhzg5zayzeg21650q4kjn.gif\" alt=\"Find References\"></p>\n<h2 id=\"\">目录树</h2>\n<p>点击文件(File)按钮你会看到树状的目录结构，忘记GitHub上切换文件的痛苦吧，文件树让你轻松的在项目之内的文件中自如切换。</p>\n<p>对于私有项目需要点击下方的<strong>Sign In</strong>按钮并到insight.io上导入私有项目文件树才会生效。</p>\n<p><img src=\"http://wx4.sinaimg.cn/large/7cc829d3gy1fhzg60wyodg21420othdv.gif\" alt=\"Directory Tree\"></p>\n<h2 id=\"\">代码搜索</h2>\n<p>GitHub只支持纯文本搜索，这时常让搜索代码变得很困难，特别是当你想搜的关键词是常用词的时候，大量的无用结果会让搜索功能完全不可用。而是用Insight.io插件，点击搜索(Search)按钮可以按类名，方法名，变量名，文件名等等搜索代码，并且有自动补全功能。试试在Insight.io和GitHub原生搜索上搜一下RDD.map对比下搜索结果吧？</p>\n<p><img src=\"http://wx2.sinaimg.cn/large/7cc829d3gy1fhzg62hd81g21660q44qr.gif\" alt=\"Code Search\"></p>\n<h2 id=\"insightio\">跳转到Insight.io</h2>\n<p>你也可以一键点击跳转到Insight.io上获得更好的浏览体验。</p>\n<p><img src=\"http://wx2.sinaimg.cn/large/7cc829d3gy1fhzg645xmfg21410oru0y.gif\" alt=\"View on insight.io\"></p>\n<h2 id=\"insightio\">提交项目给Insight.io</h2>\n<p>Insight.io目前收录了2000多个最活跃的开源项目，包括<a href=\"https://github.com/apache/kafka\">Apache Kafka</a>, <a href=\"https://github.com/torvalds/linux\">Linux-kernel</a>这样的大型项目，也有像<a href=\"https://github.com/daimajia/AndroidSwipeLayout\">AndroidSwipeLayout</a>这样优质的个人项目。如果你需要的项目并未被我们收录，点击<strong>Information</strong>栏下的<strong>Request Analyze</strong>就可以提交你目前正在浏览的项目了。</p>\n<p><img src=\"http://wx3.sinaimg.cn/large/7cc829d3gy1fhzg65lh83g213y0oru0x.gif\" alt=\"Request Analyze\"></p>\n<h2 id=\"\">快捷键</h2>\n<p>用快捷键可以快速打开关闭插件功能:</p>\n<ul>\n<li><strong>文件树</strong>: <code>⌘+⇧+f</code></li>\n<li><strong>类结构</strong>: <code>⌘+⇧+o</code></li>\n<li><strong>信息</strong>: <code>⌘+⇧+i</code></li>\n<li><strong>搜索</strong>: <code>⌘+⇧+s</code></li>\n</ul>\n<hr>\n<p><a href=\"https://chrome.google.com/webstore/detail/insightio-for-github/pmhfgjjhhomfplgmbalncpcohgeijonh/\" target=\"_blank\">插件下载传送门</a></p>\n<p>目前插件支持的语言有Java, C/C++, Scala, Python和Ruby。想跟开发团队吐个槽或者点个赞？想知道最好的编程语言PHP什么时候支持？想知道怎么让公司代码库也能用上Insight.io？欢迎邮件到 support@insight.io 。想实时吐槽的也可以加入我们的gitter房间</p>\n<p><a href=\"https://gitter.im/Insight-io/Lobby\"><img title=\"\" src=\"https://badges.gitter.im/Insight-io/Lobby.png\" alt=\"Gitter chat\"></a></p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112011\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112011votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112011\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 6 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 2 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "1", "fav_nums": "6", "comment_nums": "2", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2013/03/124.jpg"]},{"url_object_id": "1e1a2c0afbf124146e1e745069e53328", "create_date": "2017/07/28", "front_image_path": "full/947d74929f5809c543dc9539bb00815a461c9e7c.jpg", "title": "REST 的 6 个约束", "url": "http://blog.jobbole.com/112006/", "tags": "IT技术,API,Rest", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文由 <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/yalishizhude\">亚里士朱德</a> 翻译。未经许可，禁止转载！<br>英文出处：<a target=\"_blank\" href=\"https://en.wikipedia.org/wiki/Representational_state_transfer#Client-server\">wikipedia</a>。欢迎加入<a target=\"_blank\" href=\"http://group.jobbole.com/category/feedback/trans-team/\">翻译组</a>。</div><p>定义个一个 RESTful 系统的时候应该遵循 6 个约束。</p>\n<p>它们限制了服务端只能遵循这些约束来处理和响应客户端请求，但是遵循这些约束服务也可以获取理想的非函数化的属性，例如性能、可伸缩、简单程度、可变能力、可见度、灵活性、可信度。</p>\n<p>如果任何一个服务违背了其中一个原则，将不能被称作 RESTful 系统。</p>\n<p>标准的 REST 约束如下：</p>\n<h3 id=\"客户端-服务器\">客户端-服务器</h3>\n<p><em>参考内容：<a href=\"https://en.wikipedia.org/wiki/Client%E2%80%93server_model\" target=\"_blank\" rel=\"external\">客户端-服务器模型</a></em></p>\n<p>第一个约束是基于<strong>客户端-服务器</strong>架构背后的原则——关注点分离。通过分离用户界面和数据存储这两个关注点，提高了用户界面跨平台的可能性，通过简化服务器组件提高了其可伸缩性。这种分离对于Web来说更加重要的意义是，它使得组件能够进行独立修改和扩展，从而能够支持大量组织的网络化需求。</p>\n<h3 id=\"无状态\">无状态</h3>\n<p><em>参考内容：<a href=\"https://en.wikipedia.org/wiki/Stateless_protocol\" target=\"_blank\" rel=\"external\">无状态协议</a></em></p>\n<p>客户端-服务器通信的一个制约条件就是服务端无法存储客户端的上下文执行环境。从任何客户端发出的每个请求都包含了服务端所必要的信息，但是会话状态仍留在客户端。</p>\n<p>然而在服务端会话状态可以轻松实现跨服务调用，例如利用数据库做持久化来保存一段时间内的身份认证信息。客户端开始发送请求时，它已准备好过渡到一个新的状态。当一个或多个请求正在发送时，客户端处于过渡状态。每个应用程序状态的表示包含可在下一次客户端选择发起一个新的状态过渡使用的链接。</p>\n<h3 id=\"可缓存\">可缓存</h3>\n<p><em>参考内容：<a href=\"https://en.wikipedia.org/wiki/Web_cache\" target=\"_blank\" rel=\"external\">网页缓存</a></em></p>\n<p>互联网中的客户端和中间层服务器可以缓存响应。因此响应必须直接或间接定义自身是否可被缓存，以免客户端使用过期的响应数据来发送其它请求。良好的缓存策略可以有效减少客户端-服务器之间的交互，从而进一步提高系统的可伸缩性和性能。</p>\n<h3 id=\"分层系统\">分层系统</h3>\n<p><em>参考内容：<a href=\"https://en.wikipedia.org/w/index.php?title=Representational_state_transfer&amp;action=edit&amp;section=7\" target=\"_blank\" rel=\"external\">分层系统</a></em></p>\n<p>客户端通常无法判断它是否是直接连接到后端服务器，还是中间服务器。中间服务器可通过启用负载平衡，并通过提供共享高速缓存来提高系统的可扩展性。当然也可以强制执行安全政策。</p>\n<h3 id=\"按需代码（可选）\">按需代码（可选）</h3>\n<p><em>参考内容：<a href=\"https://en.wikipedia.org/wiki/Dynamic_web_page#Client-side_scripting\" target=\"_blank\" rel=\"external\">客户端脚本</a></em></p>\n<p>服务端可以通过传递可执行代码临时为客户端扩展或自定义功能。这方面的例子包括可编译的组件如Java applets和客户机端脚本如JavaScript。</p>\n<h3 id=\"统一的接口\">统一的接口</h3>\n<p>统一接口约束是设计任何REST服务的基础。它简化和解耦的架构，使得每个部分可以独立被修改。这个统一的接口包含了四个约束：</p>\n<h3 id=\"资源的标识\">资源的标识</h3>\n<p>各种资源都在请求中被确定，例如在使用URI的Web REST系统中，资源本身就表明它们想要被返回给客户端的格式。例如服务端可以从它的数据库发送HTML，XML或JSON格式的数据，即使这些都不是服务端的内部数据格式。</p>\n<h3 id=\"通过表述来操作资源\">通过表述来操作资源</h3>\n<p>当一个客户端持有一种资源的表述时，包括任何关联的元数据，它都有足够的信息来修改或删除该资源。</p>\n<h3 id=\"自描述的消息\">自描述的消息</h3>\n<p>每条信息都包含足够的信息来描述如何处理消息本身。例如，一个网络媒体类型本身就定义了能运行该媒体的解析器（以前被称为MIME类型）。</p>\n<h3 id=\"超媒体作为应用程序状态的引擎（HATEOAS）\">超媒体作为应用程序状态的引擎（HATEOAS）</h3>\n<p>已经初始化URI的REST客户端应用，应该就像人们访问了一个Web网站主页一样，能够使用服务器提供的动态链接，请求它所需的资源和进行所需的操作。</p>\n<p>处理客户端访问时，服务端将响应内容也包括当前可用的其它行为的超链接。没有必要对REST服务的结构或动态信息进行硬编码来响应客户端客户端。</p>\n\r\n        \r\n            <blockquote class=\"rewards\">\n        <p><strong>打赏支持我翻译更多好文章，谢谢！</strong></p>\n        <a href=\"#rewardbox\" id=\"rewards-button\" class=\"fancybox\"><span class=\"btn-bluet-blue href-style\"><i class=\"fa fa-jpy\"></i> 打赏译者</span></a>\n    </blockquote>\n\n    <div id=\"rewardbox\">\n        <h4>打赏支持我翻译更多好文章，谢谢！</h4>\n                <p>任选一种支付方式</p>\n                <p>\n                        <img src=\"http://www.jobbole.com/wp-content/uploads/2016/03/981844a17323ad7e3f25209b78bc671c1.jpg\">\n            \n                            <img src=\"http://www.jobbole.com/wp-content/uploads/2016/03/ccd097a7b57abdd91d882ff55cda32091.jpg\">\n                    </p>\n    </div>\n\n    \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112006\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112006votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112006\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 2 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/yalishizhude\">亚里士朱德</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/yalishizhude\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2017/06/4a4b7e0673565612b7c599e582face0c.jpg\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            JSP工程师，多年大型国际项目开发经验。WEB前端工程师，擅长PC端以及移动端开发。js全栈工程师，熟悉node.js、mongoDB。开发者头条top10专栏作者慕课网签约讲师个人博客：yalishizhude.github.io        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/yalishizhude\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/yalishizhude/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/yalishizhude/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 19</a> · <a title=\"我的网站\" target=\"_blank\" href=\"http://yalishizhude.github.io/\"><i class=\"fa fa-link\"></i></a> <a title=\"微博主页\" target=\"_blank\" href=\"http://weibo.com/arisjutle\"><i class=\"fa fa-weibo\"></i></a> <a title=\"QQ：381355576\" target=\"_blank\" href=\"#\"><i class=\"fa fa-qq\"></i></a> <a title=\"GitHub主页\" target=\"_blank\" href=\"https://github.com/yalishizhude\"><i class=\"fa fa-github\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "1", "fav_nums": "2", "comment_nums": "", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2015/08/544851c6c17d5b59f6fe22f223db85aa.png"]},{"url_object_id": "092a09180ce44fb76ec5789f381f96da", "create_date": "2017/07/27", "front_image_path": "full/5df4d74ef333e85bce73952b363632b42fa5301b.jpg", "title": "开发团队面临的 3 大安全挑战", "url": "http://blog.jobbole.com/112007/", "tags": "IT技术,安全,开发", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文作者： <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/thoughtworkschina\">ThoughtWorks</a> 。未经作者许可，禁止转载！<br>欢迎加入伯乐在线 <a href=\"http://blog.jobbole.com/99322\" target=\"_blank\">专栏作者</a>。</div><p>应用安全不能只依靠防火墙，必须要在应用开发阶段采取适当的安全控制措施，使得应用在发布上线前就具备较好的安全性，避免人为失误造成安全隐患。</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/1-security.jpg\" alt=\"\" width=\"1000\" height=\"414\"></p>\n<p>不少企业早就意识到了这一点，然而理想和现实之间还隔着几十个安全漏洞，尤其是那些采用敏捷或者精益开发模式的团队，在具体的实践过程中，几乎无可避免的会遭遇到下面几个挑战。</p>\n<h3>挑战1：一次性的安全检查无法匹配持续性的交付</h3>\n<p>为确保团队开发出来的应用具有足够的安全性，最常见的选择是对其进行全方位的安全渗透测试。无论这样的测试是由企业自己的安全团队执行，还是购买外部第三方服务，最终都会得到一份详细的安全报告，团队接下来需要做的就是基于这份报告所揭露的漏洞，对应用进行相应的调整，直到安全漏洞被修复为止。</p>\n<p>持续交付是敏捷、精益开发团队的核心能力之一，这意味着团队可以做到每周甚至任意时刻发布产品，持续性的从真实环境中获取市场反馈，然后基于这些反馈对产品进行调整。一个可以参考的案例是，早在2014年的时候，亚马逊平均每秒有一次以上的产品部署，每天如此。</p>\n<p>与此同时，安全渗透测试却没有这么高的“交付”速度。由于渗透测试的特殊性，虽然有大量的自动化漏洞扫描工具可以使用，但是一次全面、高质量的渗透测试依然需要人工参与，几天甚至一两周之后才能得到测试报告是普遍现象。</p>\n<p>那么问题来了，一方面开发团队持续性的每周都有新功能上线和旧功能调整，另一方面渗透测试却没办法在这么短的时间里完成，它只能是阶段性、或者定期性的进行，例如每个季度测试一次。</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/2-develop-team-1024x614.jpg\" alt=\"\" width=\"700\" height=\"420\"></p>\n<p>这种情况下，开发团队该何去何从？如果要安全，那么就得等着做渗透测试，而且一旦发现安全漏洞还要花额外的时间去修复，产品发布必定会延期。如果要效率，那么就只能冒着风险发布，因为谁也不知道当前应用有没有安全漏洞，万一被黑客发现并且加以利用，后果不堪设想。</p>\n<p>问题的关键在于，开发团队是在持续的发布应用到生产环境，然而渗透测试却是个相当耗时的一次性活动，它没办法跟上这么快的交付速度。</p>\n<h3>挑战2：缺乏自动化、自助化的支持，安全实践落地难</h3>\n<p>开发团队其实明白安全对于应用而言至关重要，也知道在开发过程中就应当通过运用各种安全最佳实践来主动消除安全问题，把安全风险降至最低。不过现状却是，不少安全实践要么无法落地实施，要么有流于形式的倾向。</p>\n<p><strong>一个真实的案例</strong></p>\n<p><em>一个开发团队在做完业务需求梳理后，立即进入了开发阶段。安全团队虽然在项目启动时提出过安全要求，例如要求团队采用威胁建模活动，识别出应用面临的安全威胁，并制定应对措施。然而由于该项目交付压力大，时间紧任务重，再加上团队成员对于威胁建模并不熟悉，最后这个活动被一拖再拖，直到应用开发完毕进行上线前的审批时，才发现没有做威胁建模，而此刻为了能让应用按时上线，只好回过头来临时补一份威胁建模的文档，仅用于应付安全部门的要求。这种情况下，安全威胁根本得不到全面的分析和应对，风险由此而生。</em></p>\n<p>在项目前期的设计阶段是进行威胁识别的最佳时刻，开发团队只要在这时做一次威胁建模，就能识别出潜在的安全风险，并且在接下来的开发过程中采取适当的措施加以应对。但是开发团队却仿佛是懒癌晚期患者，硬是拖到上线前才把威胁建模补上，而此时它早已失去意义。</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/3-useless-1024x683.jpg\" alt=\"\" width=\"700\" height=\"467\"></p>\n<p>为何开发团队一边认同安全的重要性，一边却又对安全实践如此怠慢呢？本质原因在于，某些安全实践需要大量人工参与，或者对人员安全技能有很高的要求，与此同时又缺乏自动化、自助化的支持，因此在开发团队看来，这些实践的采纳成本太高，在面临交付压力的情况下选择性的忽略，或者认认真真的走个形式，就成了再正常不过的结果。</p>\n<h3>挑战3：高耸的部门墙让开发和安全团队难以进行高效的协作</h3>\n<p>随着敏捷、精益开发模式的普及，再加上DevOps转型的助推，不少企业已经开始组建全功能开发团队，团队中各个角色有着共同的目标，相互协作以更高的效率交付应用。但是安全团队却依然隶属于一墙之隔的安全部门。</p>\n<p>别小看了这堵墙，说它是万恶之源有点太夸张，但它的存在确确实实阻碍了企业实现其业务价值最大化。墙的这边，开发团队竭尽所能的以最快的速度完成应用开发，以求尽快上线获取反馈；墙的另一边，安全团队只关心应用是否安全，至于是否急着上线，那不是他们关心的问题。但是他们都忽略了一个事实，那就是企业的成功需要两者共同高效的协作。</p>\n<h3>小结</h3>\n<p>敏捷、精益团队一方面要保持快速的交付速度，一方面还要提高应用的安全质量，看上去这是鱼和熊掌不可兼得的事情，然而事实上我们依然有办法解决这些挑战。</p>\n<p>开发团队可以通过自动化，显著降低安全实践的实施难度和成本，把一次性的安全检查转变为持续性的安全质量反馈。对于安全团队，也应当向着开发团队迈进一步，打通开发和安全部门之间的隔离，以更加紧密和高效协作的方式，共同确保应用具备更高的安全质量。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112007\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112007votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112007\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/thoughtworkschina\">ThoughtWorks</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/thoughtworkschina\">\r\n\t\t\t<img src=\"http://tp3.sinaimg.cn/1774908135/180/0/1\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            ThoughtWorks是一家全球IT咨询公司，追求卓越软件质量，致力于科技驱动商业变革。擅长构建定制化软件产品，帮助客户快速将概念转化为价值。同时为客户提供用户体验设计、技术战略咨询、组织转型等咨询服务。        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/thoughtworkschina\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/thoughtworkschina/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/thoughtworkschina/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 64</a> · <a title=\"我的网站\" target=\"_blank\" href=\"http://insights.thoughtworkers.org/\"><i class=\"fa fa-link\"></i></a> <a title=\"微博主页\" target=\"_blank\" href=\"http://weibo.com/thoughtworkschina\"><i class=\"fa fa-weibo\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "1", "fav_nums": "", "comment_nums": "", "front_image_url": ["http://insights.thoughtworkers.org/wp-content/uploads/2017/07/1-security.jpg"]},{"url_object_id": "ac282b4e104c307d34b2e97c8a8a1aa6", "create_date": "2017/08/01", "front_image_path": "full/21812d9d62b935e7b375b95677300b715fa3a48f.jpg", "title": "优秀的程序员都有哪些习惯？", "url": "http://blog.jobbole.com/112067/", "tags": "开发,程序员", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文由 <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/qingfeng6438\">阿慧</a> 翻译，<a href=\"http://www.jobbole.com/members/young605867996\">Lada</a> 校稿。未经许可，禁止转载！<br>英文出处：<a target=\"_blank\" href=\"https://news.ycombinator.com/item?id=14709076\">nostrademons</a>。欢迎加入<a target=\"_blank\" href=\"http://group.jobbole.com/category/feedback/trans-team/\">翻译组</a>。</div><p>【伯乐在线导读】：「我不是卓越的程序员，我只不过是一个有着卓越习惯的程序员。」技术大牛 Kent Beck 曾这样说过自己。</p>\n<p>7月初，nostrademons 在 Hacker News 发起一个讨论，是哪些习惯成就了优秀/卓越的程序员？</p>\n<hr>\n<p>可变的习惯：学习着在不同的情况中采用不同的习惯。考虑到这一点，我总结了一些适用于不同情况的通用技巧：</p>\n<h3>为了数据科学类问题研究新领域的发展：</h3>\n<p>1.尽量亲自动手去完成事情。你将会有一种直觉，知道如何去处理该事物。</p>\n<p>2.积累案例，从数据表中标注着你已获得的数据开始。</p>\n<p style=\"padding-left: 30px;\"><span style=\"color: #999999;\">（关于这一点：rluhar 评论补充说，这不仅适用于数据科学，也适用于解决任何数值问题。用一个电子表格（或一个R／Python Notebook）来实现算法并获得一些结果，在过去帮助我真正理解了问题，避免走死胡同。例如，在建立一个外汇定价系统时，我能够使用电子表格来描述定价算法是如何工作的，并向交易者（最终用户）解释它。在执行和部署算法之前，我们可以调整计算并确保一切都清楚。很好的建议！）</span></p>\n<p>3.在找到通用办法之前，先找到一种能解决当前问题的办法。</p>\n<p>4.让算法本身输出调试信息。你应该能够转储每一步的中间结果，并用文本编辑器或是 Web 浏览器手动检查它们。</p>\n<p>5.不要为单元测试操心，定义出正确行为才是首要的。</p>\n<h3>维护大的、不熟悉的代码库程序：</h3>\n<p>1.检查文件的大小。最大的文件总是包含了程序的实体部分，至少是指向程序实体内容的分派程序。 main.cc  通常很小，并且对寻找代码结构毫无用处。</p>\n<p>2.从主循环调度开始单步调试程序。可以学到很多关于控制流的东西。</p>\n<p>3.寻找数据结构，特别是做为参数传递到许多函数中的那些。大多数程序具有一个小的关键数据结构集合，找到它们，理解代码的其余部分会变得容易的多。</p>\n<p>4.写单元测试。这是确认你所理解的代码与真实代码工作方式无误的最好方法。</p>\n<p>5.移除代码，看看什么出问题了。（但不要 check in！）</p>\n<h3>性能工作：</h3>\n<p>0.一般不需要做，除非你所构建的东西对用户来说太慢了。制定出需要提高的性能目标，达成这个目标即可。</p>\n<p>1.在开始所有工作之前，甚至是在剖析（profile）之前，建立一套代表典型现实世界的使用基准。别让性能倒退，除非你确信已经登峰造极，高处不胜寒，并且更好的解决方法还藏在世界的某个角落里无人发现（如果出现了那种情况，在版本控制系统（VCS）中标记你的分支，以便在发现错误之后回来更改。）。</p>\n<p>2.许多性能瓶颈都出现在系统的交叉处。在所有 RPC 框架中搜集时间统计数据，并且有一些方式来传播和可视化每个服务器的请求时间，以及哪些部分的请求是并行的，哪里是关键路径。</p>\n<p>3.剖析（Profile）。</p>\n<p>4.通常，避免不必要的工作可使你赢在起跑线上。缓存最大的计算结果，粗略评估不常用的东西。</p>\n<p>5.不要忽视常量因素。有时候一个渐进性更差的算法在实践中执行的很好，原因是其具有更好的缓存局部性。为此，你可以在多次调用的函数中识别出威胁。</p>\n<p>6.当你获得了程序大致剖析之后，更改数据结构往往会获得更多收益。注意内存的使用，时常缩小内存需求来减小缓存压力，可显著地提高系统的速度。注意局部性，将常用数据放到一起。如果你的编程语言允许（为 Java 感到遗憾 ），可以消除指针雕镂（pointer-chasing）来支持值控制。</p>\n<blockquote><p>译注：指针雕镂（Pointer-chasing）程序：该程序中会遍历一个由指针链在一起的数据结构，即一个链表。但是在遍历的过程中会不断的引起内存操作。因为下一个元素总不在 Cache 中。</p></blockquote>\n<h3>编码常规</h3>\n<p>1.不要想当然地去构建，确保你所加入的每个特性都有客户在用。</p>\n<p>2.谨慎地控制依赖。为了某个效果而引入的库，可能会帮你节省一个小时，但也会导致更多地方被破坏——部署、版本控制、安全性、日志记录、意外的进程死亡。</p>\n<p>3.当为个人或小团体开发的时候，把出现的问题累积起来，然后一次性全部解决（或者扔掉代码库，然后重新启动）。当为大型团队开发时，永远都不要让问题堆积，代码库应该始终处于新的开发人员可以看懂的状态，他们会说：“我知道这是做什么的，也知道如何更改它”（代码的）阅读者/编写者的比例结果是这样的：初始代码的编写多过阅读，因此可读性不那么重要，但成熟代码的阅读多过编写。（当你要求开发前一种初始代码去获得用户、资金和存活了，转换到后一种成熟代码中去就是给阅读者留下的操练了。）</p>\n<p> </p>\n<p>欢迎大家补充。</p>\n\r\n        \r\n            <blockquote class=\"rewards\">\n        <p><strong>打赏支持我翻译更多好文章，谢谢！</strong></p>\n        <a href=\"#rewardbox\" id=\"rewards-button\" class=\"fancybox\"><span class=\"btn-bluet-blue href-style\"><i class=\"fa fa-jpy\"></i> 打赏译者</span></a>\n    </blockquote>\n\n    <div id=\"rewardbox\">\n        <h4>打赏支持我翻译更多好文章，谢谢！</h4>\n                <p>任选一种支付方式</p>\n                <p>\n                        <img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/f9e94e087837b17681c87206c9d540dd.png\">\n            \n                            <img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/748ed21a8038cdafa65b3b4ab9a0185a.jpg\">\n                    </p>\n    </div>\n\n    \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112067\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112067votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112067\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/qingfeng6438\">阿慧</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/qingfeng6438\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2017/02/c169e93746e89947e9a2f0fce3f937cc.jpg\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            什么东西没头没尾没中间？        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/qingfeng6438\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/qingfeng6438/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/qingfeng6438/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 14</a> · <a title=\"QQ：1305735677\" target=\"_blank\" href=\"#\"><i class=\"fa fa-qq\"></i></a> <a title=\"个人微信：chenahui1996\" target=\"_blank\" href=\"#\"><i class=\"fa fa-weixin\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "1", "fav_nums": "", "comment_nums": "", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2016/11/68569d6253986872f6d708b3c9fb1426.jpeg"]},{"url_object_id": "47b29ae058a42e8c7d20bb7935eb996f", "create_date": "2017/08/02", "front_image_path": "full/d1090f61ad1b5ed427d81d03e12c8b76397dd93a.jpg", "title": "写给自学者的入门指南", "url": "http://blog.jobbole.com/112052/", "tags": "其他,程序员,编程,自学", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文作者： <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/thoughtworkschina\">ThoughtWorks</a> 。未经作者许可，禁止转载！<br>欢迎加入伯乐在线 <a href=\"http://blog.jobbole.com/99322\" target=\"_blank\">专栏作者</a>。</div><div>\n<p>在 IT 工程师和培训机构多如牛毛的时代，拜师学艺并不难。但自学编程对于毫无基础的同学来说却可能是个问题，相信有过类似经历的朋友都有一把辛酸泪和一肚不吐不快的体会。让我们从一个故事说起…</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/1-story-1024x595.jpg\" alt=\"\" width=\"700\" height=\"407\"></p>\n<h3>故事</h3>\n<p>某君在一个普通大学读着自己不喜欢的专业，以打游戏、刷段子和睡觉度日，突然有一天想学点什么。学编程好像挺酷，而且听说IT行业充满了机会，没准一不小心就和大佬一起“改变世界”了。</p>\n<p>那么第一个问题来了，他该选择什么语言？</p>\n<p>是世界上最好的语言 PHP？还是语言之母的 C？幸好还知道个编程语言排行榜，找到一看、几十种不带重样，这要逼死天秤座的小朋友。选 PHP 吧？上非诚勿扰都要被灭灯，而且就只能做个网页。万般纠结之后我们选 C 吧，听起来既高级又底层，说不准还能考个计算机二级。</p>\n<p>接下来得干正事儿了。在这个便捷的网络时代，自学可选择的方式非常丰富。除了在网络上收集资料、阅读干货外，某君还向一些前辈咨询了自学的方法。</p>\n<p>网络上流传的编程学习方式有：</p>\n<ul>\n<li>看书（这是最容易想到的方法）</li>\n<li>观看视频教程</li>\n<li>阅读官网文档</li>\n<li>读源码</li>\n<li>到大学蹭课或者报名培训（不知道还算不算自学，没交学费都算吧？）</li>\n</ul>\n<p>某君又得纠结一番了，大学蹭课和培训并不一定有合适条件，且不符合自学的气质；观看视频教程，前辈们觉得比较low；阅读官网文档和源码，这不适合初学者。总得来说看书算是比较中肯的方法，至于看什么书呢，前辈推荐了《C Primer Plus》，据说是学习C语言的经典之作。</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/2-C-Primer-Plus-1-1024x572.jpg\" alt=\"\" width=\"700\" height=\"391\"></p>\n<p>好吧，不再纠结，直接啃这本大部头，虽然有人说看原版好一些，但是实在能力有限、还是看中文版吧。一口气花了一周时间读完这本书，果然是经典，变量、语句、条件判断甚至指针都知道怎么回事了。</p>\n<p>某君决定按照书中的说法实践一下了，于是打开了记事本，折腾很久装了GCC，把书上的第一个例子抄了下来，在控制台的小黑窗输出了“Hello World”，成就感满满。决定上手写点高级的的东西一试身手，合上书。咦，为什么会报错？哦，原来少个分号。不禁陷入思考：为什么学了两个月还是只能在这个黑窗口算算秋水仙数？网友还说要看官网文档、要读源码、要看英文原版，我一样都不能做到，我一定是能力不够，编程果然是天才做的事情……</p>\n<h3>正经话</h3>\n<p>上面的故事是我编的，但其中的纠结却是自学者或多或少都经历过的。实际上，IT从业者并不像传说中那样需要天才般的智商，要点在于能否找到合适的入门途径，再加上一点点坚持和思考。比较可惜的情况是一些人没能找到适合自己的学习方法，并在纠结和碰壁后失去信心，然后沮丧的认定自己并不适合干这行。学编程很多时候就是一个趟坑的过程，但不是每一个坑都有必要趟，写这篇文章的目的是希望能够帮助初学者尽量少趟一些坑。</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/3-learning-method-1024x553.jpg\" alt=\"\" width=\"700\" height=\"378\"></p>\n<h3>IT世界的地图</h3>\n<p>初学者遇到的一个典型问题是对IT世界没有一个大的图景。比如大多数的Java书籍，教完你基础语法知识和秋水仙数的求法后就结束了，并没告诉你接下来能干什么。我曾经为此感到非常困惑，学完Java SE后做了一个非常简陋的GUI demo，就失去了后续的Java学习方向，带着对Java的偏见，这成为了我一段令人沮丧的学习经历。关于这个话题一本书可能都不够，简单来说，我尝试从计算机科学知识和技术实践两方面来聊聊成为一名IT工程师需要具备哪些东西。</p>\n<h3>计算机科学基础</h3>\n<p>首先初学者要具备一些非常基础的知识，这些知识在你踏上工作岗位后能被实际的用到，比如计算机运行原理、网络的传输、常用数据结构和算法等。这部分属于计算机科学，也是应该被计算机专业本科课程涵盖的，不要伤心错过了大学本科的相关课程，我会分享一些有用的资源。</p>\n<p>这里我罗列了一些计算机专业的学生一般需要学习的课程，当然每个学校专业设计都不一样，甚至采用的教材名字也不一样，仅供参考。大学计算机科学课程往往包括：《高等数学》、《离线数学》、《电子电路》、《数据结构》、《程序设计》、《计算机组成原理》、《编译原理》、《计算机网络》、《软件工程》、《数据库原理》等。有些学校会有一些额外的课程，例如《通信原理》、《汇编语言》、《线性代数》、《C语言》、《Java 语言》等。</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/4-MOOC.png\" alt=\"\" width=\"761\" height=\"403\"></p>\n<p style=\"text-align: center;\">图片来源于网易计算机专业的课程体系</p>\n<p>尽管IT行业知识更迭非常快，但是基础知识并不容易过时，因此有大量的资料可以选择。可以选择从计算机经典丛书系列开始，比如佛罗赞和莫沙拉夫的《计算机科学导论》，甚至可以阅读一些计算机科普类读物例如《穿越计算机的迷雾》。另一种直观的方式是观看大学精品课和去跟慕课课程，比较推荐的有几个：</p>\n<ul>\n<li>中国大学精品开放课程，高等教育出版社的精品课程项目，有全国大量的名校授课视频和课件</li>\n<li>中国大学MOOC ，这个是中国大学MOOC和网易合作的，提供了上文附图中计算机课程体系中所有课程</li>\n<li>果壳网的MOOC学院，主打翻译全球名校的优秀课程，比如斯坦福的《编译原理》和MIT的《Python》</li>\n</ul>\n<h3>从知识到实践</h3>\n<p>除此之外，还需要了解实际应用于设计软件或者开发网站中的实践类知识，包括某个特定语言以及周边的库、框架和工具等。 我们可以把特定需求中用到的语言、库和框架以及其他的工具称为技术栈，在技术选型上通常也是被这样考虑的，HR常常会根据技术栈来寻找需要的工程师。比如需要学习SSH 三大框架和Java的Java技术栈；为服务器web开发而生的PHP技术栈；在移动开发领域流行的IOS、安卓技术栈等。当然这里面有一些重合和共用的技术也需要学习，比如版本管理器Git、SVN就是每个合格的工程师需要去学习的。</p>\n<p>换句话说，大学课程主要定位在上面说到的计算机科学基础知识，而市面上的培训机构主要是告诉你在怎么在实际工作中运用，所以大学和培训机构都有他们的价值。</p>\n<p>想要更加详细的了解这部分内容，这里有一些开源的技能图谱可以参考:</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/5-skill-map-1024x752.jpeg\" alt=\"\" width=\"700\" height=\"514\"></p>\n<p style=\"text-align: center;\">图片来自： http://skill-map.stuq.org/</p>\n<h3>如何挑选你的兵器？</h3>\n<p>在介绍完计算机领域的大致图景后，就需要选择一门合适的编程语言，一个较为形象的例子是把编程语言比喻成兵器，因为我们深知编程语言对于工程师而言是实实在在的工具，我们不是为了学它而学，学编程不仅仅是学语言特性，一般来说我们也不用知道赋值语句像“茴香豆蔻”的“茴”字有四种写法。</p>\n<p>当然语言之争从来没有停止过，如果把编程语言比喻江湖武器的话十分有趣。</p>\n<blockquote><p>C语言是M1式加兰德步枪，很老但可靠。</p>\n<p>C++是双截棍，挥舞起来很强悍，很吸引人，但需要多年的磨练来掌握，很多人希望改用别的武器。</p>\n<p>Perl语言是燃烧弹，曾经在战场上很有用，但现在很少人使用它。</p>\n<p>Java是M240通用弹夹式自动机枪，有时它的弹夹是圆的，但有时候不是，如果不是，当你开火时，会遇到NullPointerException问题，枪会爆炸，你就会被炸死。</p>\n<p>JavaScript是一把宝剑，但没有剑柄。</p>\n<p>— 来自网络</p></blockquote>\n<p>老实来讲IT行业的最终目的是交付可用的软件，编程语言也是适应市场的。这对于初学者或许有些残酷，在工作中我们发现最好的语言是用来处理工作任务或者构建合适的应用，并不是出于爱好或者某种Geek精神。</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/6-Geek-1024x586.png\" alt=\"\" width=\"700\" height=\"401\"></p>\n<p>对于初学者而言，在选择合适的入门语言时至少需要考虑两点：</p>\n<ul>\n<li>是否能适用于构建你想要的应用。如果你的目标是创建一个运行在IPhone上的APP，那么最好选择 Object C 或者 Swift，学习web开发可以选择PHP 或者JAVA。实际上我们仍然可以用汇编做出网页，但是这样做成本高昂。</li>\n<li>是否容易学习，在满足第一点的条件下请尽量选择容易学习的语言。容易不仅仅指语法简单，包括环境搭建、部署等都需要考虑在内，以及能不能容易找到好的学习资料，因此尽可能的选择主流语言。</li>\n</ul>\n<p>别忘了非常重要的一点，学习编程语言还包括平台提供的API，比如Win 32 之于C++/C#/VB，以及周边的库和框架（这些库、框架和工具能在上面说的技术图谱中找到）。IT历史上甚至出现框架和库引领编程语言走向的情况：JQuery 和Angular 改变了前端开发的思想; Rails 抢走了Ruby的名气；而SSH三大框架一度代表了Java世界。</p>\n<p>最后我为初学者整理了一个流行编程语言和用途的表：</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/7-programming-language-1.png\" alt=\"\" width=\"606\" height=\"555\"></p>\n<p>另外还需要注意的是开发工具，可以选用IDE和有代码提示的编辑器，但尽量不要在这上喋喋不休，这就像用来盛放你锋利兵器的架子，用着顺手就行，也不推荐使用纯文本编辑器，这看起来像赤手空拳。 推荐一些编辑器和IDE</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/8-IDE-1.png\" alt=\"\" width=\"674\" height=\"323\"></p>\n<h3>挑选合适的资料和有效的阅读</h3>\n<p>对初学者而言，我仍然推荐好的视频教程，虽然我已经听到不下5个人声称是靠阅读官方文档或者看源码学会编程的，而且认为观看视频教程见效太慢。但这个思想对初学者很危险，不得不承认阅读文档和源码能更准确找到自己想要的信息，这对深入技术原理非常有用，但视频能比文字传达出更丰富的内容，有更直观的演示和细致的讲解，我想没有比这个更适合初学者了。</p>\n<p>除了上面提到的精品课程和慕课教程，国内有像网易云课堂，国外有lynda.com这种在线学习视频网站，甚至在优酷和土豆都能找到足够的教程资源。</p>\n<p>如果选择了阅读技术类书籍，我们来聊聊怎么有效的阅读一本技术书籍。</p>\n<p>读IT类书籍和读考试类书籍的方式不同，初学者需要选择更接地气、并且能告诉你最终能做出什么案例的书籍。你不需要通读整本书，而是需要搭建好和书中版本一致的环境，然后把书中的每行代码敲入电脑，观察这些代码怎样被运行，在遇到问题时去请教朋友或者到搜索引擎中寻找解决办法，直到示例程序能被正确运行。</p>\n<p>可能一个月才能读完一本书，但慢点并没什么坏处，敲过一遍的代码才能算是你的，否则永远存在于纸上的代码清单中。对于关键的概念和知识点，可以在阅读的同时做一些笔记，去尝试使用思维导图来做你的笔记吧，这让你的笔记跟上你的思考，并形成一个知识网络。</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/9-spring.png\" alt=\"\" width=\"940\" height=\"356\"></p>\n<h3>自我激励</h3>\n<p>自学无疑是寂寞的。编程学习耗时较长，如何保证在这个阶段能坚持下去？</p>\n<p>我们知道很多人都能对游戏产生强烈的兴趣、愿意为之投入时间，这其中的秘密就是游戏的奖励规则。杀死一个怪物就能得到一些金币，通过完成任务获得满足感，通过关卡的设计产生持续吸引力，进而形成正向的反馈。</p>\n<p>其实学习编程也一样，实现一小段程序并运行，足以让人感到成就感和满足，借鉴这个简单的心理学技巧，定期给自己设定一些有实际意义但是不太难的目标和任务。太难会让人失去耐心，太简单又很无聊，最好设定一个跳起来刚好摸得着的任务。每完成一个目标就给予自己奖励，可以是完成任务的成就感，也可以是其他的物质奖励。</p>\n<p>这个时候一个代办记事的清单就可以帮上忙了，可以是一个to do list的软件，或者自己手写一张卡片贴到墙上，关键在于不要忘了在任务达成后给予自己适当的奖励。</p>\n<p><img src=\"http://insights.thoughtworkers.org/wp-content/uploads/2017/07/10-to-do-list.png\" alt=\"\" width=\"940\" height=\"560\"></p>\n<p style=\"text-align: center;\">图片来源：https://appadvice.com</p>\n<p>那如果真的遇到一些麻烦的任务呢，如何顺利解决而不至于丧失信心？笛卡尔在《方法论》一书中告诉了我们研究复杂问题的方法和步骤:</p>\n<ul>\n<li>尽量将其分解为多个比较简单的小问题，一个一个地分开解决</li>\n<li>将小问题从简单到复杂排列，先从容易解决的问题着手</li>\n<li>子问题被解决后，进行联调测试，看是否能协同运行</li>\n</ul>\n<p>在敏捷开发这种工程思想中我们正是这样做的，我们需要把业务需求进行拆分然后评估工作量，不仅可以直观的看到任务进展，手上的工作也不会看起来庞大得难以完成。</p>\n<h3>最后多说几句</h3>\n<p>非科班出身的工程师入门是有一定痛苦的，不像武侠世界里面的名门正派弟子，也没有机缘遇到骨骼精奇的世外高人，如何选择合适自己的学习方式并自我管理是很重要的一方面。没有任何Low的学习方式，只要直接而又高效，而且要能达到我们的目的就好。以我为例，从大专学校毕业并没有机会参加本科课程，曾经也在网上攫取各种视频教程，去别的学校蹭课，甚至带上礼物去一个老师那里登门拜访补课。</p>\n<p>另一方面是如何上桌，吃上编程这碗饭。学习的成果如果无处施展便成为屠龙之技，参加一些开源项目和一些公益活动，谁不喜欢一个热心的人呢。也可以尝试去实现自己的一些idea，当做一个小项目来开发，有了一些项目实践后去找一个公司实习会容易的多。</p>\n<p>我不知道算是有幸还是不幸经历了这一个过程，矫情一点来说是有一些曲折，但是我知道“聪明”从来不是这个行业的门槛。引用流行于知乎的一句老话“以大多人的努力程度，还轮不到拼天赋的程度”，在Thoughtworks有大量优秀的工程师，从他们身上我能看到聪明不是学习编程成功的关键，坚持和勤于思考才是。</p>\n<div></div>\n</div>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112052\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112052votetotal\">2</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112052\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 12 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 1 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/thoughtworkschina\">ThoughtWorks</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/thoughtworkschina\">\r\n\t\t\t<img src=\"http://tp3.sinaimg.cn/1774908135/180/0/1\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            ThoughtWorks是一家全球IT咨询公司，追求卓越软件质量，致力于科技驱动商业变革。擅长构建定制化软件产品，帮助客户快速将概念转化为价值。同时为客户提供用户体验设计、技术战略咨询、组织转型等咨询服务。        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/thoughtworkschina\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/thoughtworkschina/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/thoughtworkschina/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 64</a> · <a title=\"我的网站\" target=\"_blank\" href=\"http://insights.thoughtworkers.org/\"><i class=\"fa fa-link\"></i></a> <a title=\"微博主页\" target=\"_blank\" href=\"http://weibo.com/thoughtworkschina\"><i class=\"fa fa-weibo\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "2", "fav_nums": "12", "comment_nums": "1", "front_image_url": ["http://insights.thoughtworkers.org/wp-content/uploads/2017/07/1-story-1024x595.jpg"]},{"url_object_id": "292ef81058f5bce6e38e7bbd0bae9103", "create_date": "2017/07/31", "front_image_path": "full/35011d6168be00e949624c665041dc724e3ad786.jpg", "title": "MySQL 死锁与日志二三事", "url": "http://blog.jobbole.com/112054/", "tags": "IT技术,MySQL,数据库", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"https://my.oschina.net/leejun2005/blog/1484511\">xrzs</a>   </div><p>最近线上 MySQL 接连发生了几起数据异常，都是在凌晨爆发，由于业务场景属于典型的数据仓库型应用，白天压力较小无法复现。甚至有些异常还比较诡异，最后 root cause 分析颇费周折。那实际业务当中咱们如何能快速的定位线上 MySQL 问题，修复异常呢？下文我会根据两个实际 case，分享下相关的经验与方法。</p>\n<h3>1、Case1：部分数据更新失败</h3>\n<p>某天渠道同学反馈某报表极个别渠道数据为 0，大部分渠道数据正常。这个数据是由一个统计程序每天凌晨例行更新的，按理来说，要么全部正常，要么全部失败，那会是什么原因导致极个别数据异常呢？</p>\n<p>首先我们能想到的自然是根据统计任务日志来看了，但是看了统计程序打印的日志没有发现诸如 SQL update 失败的异常描述，那当时的数据库究竟发生了什么呢？在查看 MySQL-server 日志之前，习惯性的看了下数据库状态：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721826a81a148575953\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nSHOW ENGINE INNODB STATUS\\G</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721826a81a148575953-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721826a81a148575953-1\"><span class=\"crayon-e\">SHOW </span><span class=\"crayon-e\">ENGINE </span><span class=\"crayon-e\">INNODB </span><span class=\"crayon-v\">STATUS</span><span class=\"crayon-sy\">\\</span><span class=\"crayon-v\">G</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0005 seconds] -->\r\n<p>恰好看到了凌晨这个 update 发生了死锁：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721826a823610150630\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n------------------------\r\nLATEST DETECTED DEADLOCK\r\n------------------------\r\n2017-07-17 04:09:01 0x7f6de03c8700\r\n*** (1) TRANSACTION:\r\nTRANSACTION 215208479, ACTIVE 0 sec fetching rows\r\nmysql tables in use 3, locked 3\r\nLOCK WAIT 5 lock struct(s), heap size 1136, 3 row lock(s)\r\nMySQL thread id 27844824, OS thread handle 140092183037696, query id 412503674 10.126.95.84 zeye Searching rows for update\r\nupdate t_channel_final_datas set nr_register=133,nr_add_goods=29,nr_order_normal=11,nr_pay_normal=8,nr_order_special=0,nr_pay_special=0,n_add_user_num=16 where count_date='2017-07-16' and channel_id='16' and channel_type='10' and terminal='26'\r\n*** (1) WAITING FOR THIS LOCK TO BE GRANTED:\r\nRECORD LOCKS space id 464 page no 5459 n bits 392 index index_countdate_type_terminal of table `db_zz_flow`.`t_channel_final_datas` trx id 215208479 lock_mode X locks rec but not gap waiting\r\nRecord lock, heap no 304 PHYSICAL RECORD: n_fields 4; compact format; info bits 0\r\n 0: len 10; hex 323031372d30372d3136; asc 2017-07-16;;\r\n 1: len 1; hex 30; asc 0;;\r\n 2: len 4; hex 80000010; asc     ;;\r\n 3: len 4; hex 8009055e; asc    ^;;\r\n\r\n*** (2) TRANSACTION:\r\nTRANSACTION 215208474, ACTIVE 0 sec fetching rows\r\nmysql tables in use 3, locked 3\r\n6 lock struct(s), heap size 1136, 7 row lock(s)\r\nMySQL thread id 27844825, OS thread handle 140109890225920, query id 412503669 10.135.6.41 zeye Searching rows for update\r\nupdate t_channel_final_datas set nr_register=24,nr_add_goods=32,nr_order_normal=0,nr_pay_normal=0,nr_order_special=0,nr_pay_special=0,n_add_user_num=11 where count_date='2017-07-16' and channel_id='114' and channel_type='10' and terminal='116'\r\n*** (2) HOLDS THE LOCK(S):\r\nRECORD LOCKS space id 464 page no 5459 n bits 392 index index_countdate_type_terminal of table `db_zz_flow`.`t_channel_final_datas` trx id 215208474 lock_mode X locks rec but not gap\r\nRecord lock, heap no 304 PHYSICAL RECORD: n_fields 4; compact format; info bits 0\r\n 0: len 10; hex 323031372d30372d3136; asc 2017-07-16;;\r\n 1: len 1; hex 30; asc 0;;\r\n 2: len 4; hex 80000010; asc     ;;\r\n 3: len 4; hex 8009055e; asc    ^;;\r\n\r\n...\r\n\r\n*** (2) WAITING FOR THIS LOCK TO BE GRANTED:\r\nRECORD LOCKS space id 464 page no 4743 n bits 264 index PRIMARY of table `db_zz_flow`.`t_channel_final_datas` trx id 215208474 lock_mode X locks rec but not gap waiting\r\nRecord lock, heap no 168 PHYSICAL RECORD: n_fields 32; compact format; info bits 0\r\n 0: len 4; hex 80090569; asc    i;;\r\n 1: len 6; hex 00000cd3b9d0; asc       ;;\r\n...\r\n\r\n*** WE ROLL BACK TRANSACTION (1)</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-27\">27</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-28\">28</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-29\">29</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-30\">30</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-31\">31</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-32\">32</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-33\">33</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-34\">34</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-35\">35</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-36\">36</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-37\">37</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-38\">38</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-39\">39</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-40\">40</div><div class=\"crayon-num\" data-line=\"crayon-598721826a823610150630-41\">41</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a823610150630-42\">42</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-1\"><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-2\"><span class=\"crayon-e\">LATEST </span><span class=\"crayon-e\">DETECTED </span><span class=\"crayon-v\">DEADLOCK</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-3\"><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-4\"><span class=\"crayon-cn\">2017</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">07</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">17</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">04</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">09</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">01</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x7f6de03c8700</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-5\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TRANSACTION</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-6\"><span class=\"crayon-i\">TRANSACTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">215208479</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">ACTIVE</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sec </span><span class=\"crayon-e\">fetching </span><span class=\"crayon-e\">rows</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-7\"><span class=\"crayon-e\">mysql </span><span class=\"crayon-e\">tables </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">locked</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-8\"><span class=\"crayon-e\">LOCK </span><span class=\"crayon-i\">WAIT</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">5</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">lock </span><span class=\"crayon-t\">struct</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">heap </span><span class=\"crayon-i\">size</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1136</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">row </span><span class=\"crayon-e\">lock</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-9\"><span class=\"crayon-e\">MySQL </span><span class=\"crayon-e\">thread </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">27844824</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">OS </span><span class=\"crayon-e\">thread </span><span class=\"crayon-i\">handle</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">140092183037696</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">query </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">412503674</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">10.126.95.84</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">zeye </span><span class=\"crayon-e\">Searching </span><span class=\"crayon-e\">rows </span><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">update</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-10\"><span class=\"crayon-e\">update </span><span class=\"crayon-e\">t_channel_final_datas </span><span class=\"crayon-e\">set </span><span class=\"crayon-v\">nr_register</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">133</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">nr_add_goods</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">29</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">nr_order_normal</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">11</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">nr_pay_normal</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">8</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">nr_order_special</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">nr_pay_special</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">n_add_user_num</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">16</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">where </span><span class=\"crayon-v\">count_date</span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">'2017-07-16'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">and</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">channel_id</span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">'16'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">and</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">channel_type</span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">'10'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">and</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">terminal</span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">'26'</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-11\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">WAITING </span><span class=\"crayon-st\">FOR</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">THIS</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">LOCK </span><span class=\"crayon-st\">TO</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">BE </span><span class=\"crayon-v\">GRANTED</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-12\"><span class=\"crayon-e\">RECORD </span><span class=\"crayon-e\">LOCKS </span><span class=\"crayon-e\">space </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">464</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">page </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">5459</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">n</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">392</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">index </span><span class=\"crayon-e\">index_countdate_type_terminal </span><span class=\"crayon-e\">of </span><span class=\"crayon-i\">table</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">db_zz_flow</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">t_channel_final_datas</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">trx </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">215208479</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">lock</span><span class=\"crayon-sy\">_</span>mode<span class=\"crayon-h\"> </span><span class=\"crayon-i\">X</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">locks </span><span class=\"crayon-e\">rec </span><span class=\"crayon-e\">but </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">gap </span><span class=\"crayon-e\">waiting</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-13\"><span class=\"crayon-e\">Record </span><span class=\"crayon-v\">lock</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">heap </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">304</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">PHYSICAL </span><span class=\"crayon-v\">RECORD</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">n</span><span class=\"crayon-sy\">_</span>fields<span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">compact </span><span class=\"crayon-v\">format</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">info </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-14\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">10</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">323031372d30372d3136</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2017</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">07</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">16</span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-15\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">30</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-16\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">80000010</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-17\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">8009055e</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">asc</span><span class=\"crayon-h\">    </span><span class=\"crayon-o\">^</span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-18\"> </div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-19\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">TRANSACTION</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-20\"><span class=\"crayon-i\">TRANSACTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">215208474</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">ACTIVE</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sec </span><span class=\"crayon-e\">fetching </span><span class=\"crayon-e\">rows</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-21\"><span class=\"crayon-e\">mysql </span><span class=\"crayon-e\">tables </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">use</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">locked</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-22\"><span class=\"crayon-cn\">6</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">lock </span><span class=\"crayon-t\">struct</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">heap </span><span class=\"crayon-i\">size</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1136</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">7</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">row </span><span class=\"crayon-e\">lock</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-23\"><span class=\"crayon-e\">MySQL </span><span class=\"crayon-e\">thread </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">27844825</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">OS </span><span class=\"crayon-e\">thread </span><span class=\"crayon-i\">handle</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">140109890225920</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">query </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">412503669</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">10.135.6.41</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">zeye </span><span class=\"crayon-e\">Searching </span><span class=\"crayon-e\">rows </span><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">update</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-24\"><span class=\"crayon-e\">update </span><span class=\"crayon-e\">t_channel_final_datas </span><span class=\"crayon-e\">set </span><span class=\"crayon-v\">nr_register</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">24</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">nr_add_goods</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">32</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">nr_order_normal</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">nr_pay_normal</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">nr_order_special</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">nr_pay_special</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span><span class=\"crayon-v\">n_add_user_num</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">where </span><span class=\"crayon-v\">count_date</span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">'2017-07-16'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">and</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">channel_id</span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">'114'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">and</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">channel_type</span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">'10'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">and</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">terminal</span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">'116'</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-25\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">HOLDS </span><span class=\"crayon-e\">THE </span><span class=\"crayon-e\">LOCK</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">S</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-26\"><span class=\"crayon-e\">RECORD </span><span class=\"crayon-e\">LOCKS </span><span class=\"crayon-e\">space </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">464</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">page </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">5459</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">n</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">392</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">index </span><span class=\"crayon-e\">index_countdate_type_terminal </span><span class=\"crayon-e\">of </span><span class=\"crayon-i\">table</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">db_zz_flow</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">t_channel_final_datas</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">trx </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">215208474</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">lock</span><span class=\"crayon-sy\">_</span>mode<span class=\"crayon-h\"> </span><span class=\"crayon-i\">X</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">locks </span><span class=\"crayon-e\">rec </span><span class=\"crayon-e\">but </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">gap</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-27\"><span class=\"crayon-e\">Record </span><span class=\"crayon-v\">lock</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">heap </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">304</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">PHYSICAL </span><span class=\"crayon-v\">RECORD</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">n</span><span class=\"crayon-sy\">_</span>fields<span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">compact </span><span class=\"crayon-v\">format</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">info </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-28\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">10</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">323031372d30372d3136</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2017</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">07</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">16</span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-29\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">30</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-30\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">80000010</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-31\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">8009055e</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">asc</span><span class=\"crayon-h\">    </span><span class=\"crayon-o\">^</span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-32\"> </div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-33\"><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-34\"> </div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-35\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">WAITING </span><span class=\"crayon-st\">FOR</span><span class=\"crayon-h\"> </span><span class=\"crayon-r\">THIS</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">LOCK </span><span class=\"crayon-st\">TO</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">BE </span><span class=\"crayon-v\">GRANTED</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-36\"><span class=\"crayon-e\">RECORD </span><span class=\"crayon-e\">LOCKS </span><span class=\"crayon-e\">space </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">464</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">page </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4743</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">n</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">264</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">index </span><span class=\"crayon-e\">PRIMARY </span><span class=\"crayon-e\">of </span><span class=\"crayon-i\">table</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">db_zz_flow</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">t_channel_final_datas</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">trx </span><span class=\"crayon-i\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">215208474</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">lock</span><span class=\"crayon-sy\">_</span>mode<span class=\"crayon-h\"> </span><span class=\"crayon-i\">X</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">locks </span><span class=\"crayon-e\">rec </span><span class=\"crayon-e\">but </span><span class=\"crayon-st\">not</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">gap </span><span class=\"crayon-e\">waiting</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-37\"><span class=\"crayon-e\">Record </span><span class=\"crayon-v\">lock</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">heap </span><span class=\"crayon-i\">no</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">168</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">PHYSICAL </span><span class=\"crayon-v\">RECORD</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">n</span><span class=\"crayon-sy\">_</span>fields<span class=\"crayon-h\"> </span><span class=\"crayon-cn\">32</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">compact </span><span class=\"crayon-v\">format</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">info </span><span class=\"crayon-i\">bits</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-38\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">80090569</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\">    </span><span class=\"crayon-v\">i</span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-39\"><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">len</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">6</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">hex</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">00000cd3b9d0</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">asc</span><span class=\"crayon-h\">       </span><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-40\"><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line\" id=\"crayon-598721826a823610150630-41\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a823610150630-42\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">WE </span><span class=\"crayon-e\">ROLL </span><span class=\"crayon-e\">BACK </span><span class=\"crayon-e\">TRANSACTION</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0157 seconds] -->\r\n<p>篇幅所限，上下文我这里省略了很多，从这段日志里可以看到，TRANSACTION 1 和 TRANSACTION 2 分别持有一定数量的行锁，然后又等待对方的锁，最后 MySQL 检测到 deadlock ，然后选择回滚了 TRANSACTION 1：Innodb目前处理死锁的方法是将持有最少行级排他锁的事务进行回滚。</p>\n<p>那这里就有 3 个问题了：</p>\n<h4>（1）innodb 行锁不是只锁一行？</h4>\n<p>因为这张表是 innodb 引擎的，InnoDB 支持行锁和表锁。而InnoDB行锁是通过给索引上的索引项加锁来实现的，这一点MySQL与Oracle不同，后者是通过在数据块中对相应数据行加锁来实现的。InnoDB这种行锁实现特点意味着：只有通过索引条件检索数据，InnoDB才使用行级锁，否则，InnoDB将使用表锁，会把所有扫描过的行都锁定！在实际应用中，要特别注意InnoDB行锁的这一特性，不然的话，可能导致大量的锁冲突，从而影响并发性能。由于MySQL的行锁是针对索引加的锁，不是针对记录加的锁，所以虽然是访问不同行的记录，但是如果是使用相同的索引键，是会出现锁冲突的。当我们用范围条件而不是相等条件检索数据，并请求共享或排他锁时，InnoDB会给符合条件的已有数据记录的索引项加锁；另外间隙锁也会锁多行，InnoDB除了通过范围条件加锁时使用间隙锁外，如果使用相等条件请求给一个不存在的记录加锁，InnoDB也会使用间隙锁！</p>\n<p>话都说到这了，那就看下咱们业务表的索引情况：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721826a82a811226658\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nshow INDEX from `db_zz_flow`.`t_channel_final_datas`;\r\n+-----------------------+--------------+-------------------------------+----------------+-------------+----------+--------+--------------+-----------+-----------------+\r\n| Table | Non_unique | Key_name | Seq_in_index | Column_namt | Packed | Null | Index_type | Comment | Index_comment |\r\n|-----------------------+--------------+-------------------------------+----------------+-------------+----------+--------+--------------+-----------+-----------------|\r\n| t_channel_final_datas | 0 | PRIMARY | 1 | id &gt; | &lt;null&gt; | | BTREE | | |\r\n| t_channel_final_datas | 1 | index_countdate_type_terminal | 1 | count_date&gt; | &lt;null&gt; | YES | BTREE | | |\r\n| t_channel_final_datas | 1 | index_countdate_type_terminal | 2 | channel_ty&gt; | &lt;null&gt; | YES | BTREE | | |\r\n| t_channel_final_datas | 1 | index_countdate_type_terminal | 3 | terminal &gt; | &lt;null&gt; | YES | BTREE | | |\r\n| t_channel_final_datas | 1 | index_countdate_channelid | 1 | count_date&gt; | &lt;null&gt; | YES | BTREE | | |\r\n| t_channel_final_datas | 1 | index_countdate_channelid | 2 | channel_id&gt; | &lt;null&gt; | YES | BTREE | | |\r\n+-----------------------+--------------+-------------------------------+----------------+-------------+----------+--------+--------------+-----------+-----------------+</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721826a82a811226658-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a82a811226658-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-598721826a82a811226658-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a82a811226658-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-598721826a82a811226658-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a82a811226658-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-598721826a82a811226658-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a82a811226658-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-598721826a82a811226658-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a82a811226658-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-598721826a82a811226658-11\">11</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721826a82a811226658-1\"><span class=\"crayon-e\">show </span><span class=\"crayon-e\">INDEX </span><span class=\"crayon-i\">from</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">db_zz_flow</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">t_channel_final_datas</span><span class=\"crayon-sy\">`</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a82a811226658-2\"><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span></div><div class=\"crayon-line\" id=\"crayon-598721826a82a811226658-3\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Table</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Non_unique</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Key_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Seq_in_index</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Column_namt</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Packed</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">Null</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Index_type</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Comment</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Index_comment</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a82a811226658-4\"><span class=\"crayon-o\">|</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line\" id=\"crayon-598721826a82a811226658-5\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t_channel_final_datas</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">PRIMARY</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">id</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">null</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">BTREE</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a82a811226658-6\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t_channel_final_datas</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">index_countdate_type_terminal</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">count_date</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">null</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">YES</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">BTREE</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line\" id=\"crayon-598721826a82a811226658-7\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t_channel_final_datas</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">index_countdate_type_terminal</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">channel_ty</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">null</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">YES</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">BTREE</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a82a811226658-8\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t_channel_final_datas</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">index_countdate_type_terminal</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">terminal</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">null</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">YES</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">BTREE</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line\" id=\"crayon-598721826a82a811226658-9\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t_channel_final_datas</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">index_countdate_channelid</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">count_date</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">null</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">YES</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">BTREE</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a82a811226658-10\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t_channel_final_datas</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">index_countdate_channelid</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">channel_id</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">null</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">YES</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">BTREE</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line\" id=\"crayon-598721826a82a811226658-11\"><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0101 seconds] -->\r\n<p>可以看到这张表的索引极不合理：有3个索引，但是 update 却没有完全的用上索引，导致 update 没有精确的用上索引，需要锁定多行范围数据，从而引发死锁。</p>\n<p>知道原理后，咱们再精心构建一个四字段的组合索引即可让 update 精准的走 innodb 索引，实际上，我们更新索引后，这个死锁问题即得到了解决。<br>\n注：innodb不仅会打印出事务和事务持有和等待的锁，而且还有记录本身，不幸的是，它可能超过innodb为输出结果预留的长度（只能打印1M的内容且只能保留最近一次的死锁信息），如果你无法看到完整的输出，此时可以在任意库下创建innodb_monitor或innodb_lock_monitor表，这样innodb status信息会完整且每15s一次被记录到错误日志中。如：create table innodb_monitor(a int)engine=innodb;，不需要记录到错误日志中时就删掉这个表即可。</p>\n<h4>（2）回滚的话，为什么只有部分 update 语句失败，而不是整个事务里的所有 update 都失败？</h4>\n<p>这是因为咱们的 innodb 默认是自动提交的：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721826a82f739142951\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nshow variables like 'autocommit';\r\n+-----------------+---------+\r\n| Variable_name   | Value   |\r\n|-----------------+---------|\r\n| autocommit      | ON      |\r\n+-----------------+---------+\r\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721826a82f739142951-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a82f739142951-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-598721826a82f739142951-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a82f739142951-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-598721826a82f739142951-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a82f739142951-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-598721826a82f739142951-7\">7</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721826a82f739142951-1\"><span class=\"crayon-e\">show </span><span class=\"crayon-e\">variables </span><span class=\"crayon-i\">like</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'autocommit'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a82f739142951-2\"><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span></div><div class=\"crayon-line\" id=\"crayon-598721826a82f739142951-3\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\">   </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Value</span><span class=\"crayon-h\">   </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a82f739142951-4\"><span class=\"crayon-o\">|</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line\" id=\"crayon-598721826a82f739142951-5\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">autocommit</span><span class=\"crayon-h\">      </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ON</span><span class=\"crayon-h\">      </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a82f739142951-6\"><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span></div><div class=\"crayon-line\" id=\"crayon-598721826a82f739142951-7\"> </div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0017 seconds] -->\r\n<p>在多个 update 或 insert 语句情况下，每执行完一条 SQL，innodb 就立即 commit 一次以持久化变更，同时释放锁，这也正是本例中死锁回滚事务后只有极个别语句失败的原因。</p>\n<p>需要注意的是，通常还有另外一种情况也可能导致部分语句回滚，需要格外留意。在 innodb 里有个参数叫：innodb_rollback_on_timeout</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721826a832929712476\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nshow VARIABLES LIKE 'innodb_rollback_on_timeout'\r\n+----------------------------+---------+\r\n| Variable_name              | Value   |\r\n|----------------------------+---------|\r\n| innodb_rollback_on_timeout | OFF     |\r\n+----------------------------+---------+\r\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721826a832929712476-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a832929712476-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-598721826a832929712476-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a832929712476-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-598721826a832929712476-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a832929712476-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-598721826a832929712476-7\">7</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721826a832929712476-1\"><span class=\"crayon-e\">show </span><span class=\"crayon-e\">VARIABLES </span><span class=\"crayon-i\">LIKE</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'innodb_rollback_on_timeout'</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a832929712476-2\"><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span></div><div class=\"crayon-line\" id=\"crayon-598721826a832929712476-3\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\">              </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Value</span><span class=\"crayon-h\">   </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a832929712476-4\"><span class=\"crayon-o\">|</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line\" id=\"crayon-598721826a832929712476-5\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">innodb_rollback_on_timeout</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OFF</span><span class=\"crayon-h\">     </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a832929712476-6\"><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span></div><div class=\"crayon-line\" id=\"crayon-598721826a832929712476-7\"> </div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0018 seconds] -->\r\n<p>官方手册里这样描述：</p>\n<blockquote><p>In MySQL 5.1, InnoDB rolls back only the last statement on a transaction timeout by default. If –innodb_rollback_on_timeout is specified, a transaction timeout causes InnoDB to abort and roll back the entire transaction (the same behavior as in MySQL 4.1). This variable was added in MySQL 5.1.15.</p></blockquote>\n<p>解释：这个参数关闭或不存在的话遇到超时只回滚事务最后一个Query，打开的话事务遇到超时就回滚整个事务。</p>\n<h3>（3）怎样降低 innodb 死锁几率？</h3>\n<p>死锁在行锁及事务场景下很难完全消除，但可以通过表设计和SQL调整等措施减少锁冲突和死锁，包括：</p>\n<ul>\n<li>尽量使用较低的隔离级别，比如如果发生了间隙锁，你可以把会话或者事务的事务隔离级别更改为 RC(read committed)级别来避免，但此时需要把 binlog_format 设置成 row 或者 mixed 格式</li>\n<li>精心设计索引，并尽量使用索引访问数据，使加锁更精确，从而减少锁冲突的机会；</li>\n<li>选择合理的事务大小，小事务发生锁冲突的几率也更小；</li>\n<li>给记录集显示加锁时，最好一次性请求足够级别的锁。比如要修改数据的话，最好直接申请排他锁，而不是先申请共享锁，修改时再请求排他锁，这样容易产生死锁；</li>\n<li>不同的程序访问一组表时，应尽量约定以相同的顺序访问各表，对一个表而言，尽可能以固定的顺序存取表中的行。这样可以大大减少死锁的机会；</li>\n<li>尽量用相等条件访问数据，这样可以避免间隙锁对并发插入的影响；</li>\n<li>不要申请超过实际需要的锁级别；除非必须，查询时不要显示加锁；</li>\n<li>对于一些特定的事务，可以使用表锁来提高处理速度或减少死锁的可能。</li>\n</ul>\n<h3>2、Case2：诡异的 Lock wait timeout</h3>\n<p>连续几天凌晨6点和早上8点 都分别有一个任务失败，load data local infile 的时候报 Lock wait timeout exceeded try restarting transaction innodb 的 Java SQL 异常，和平台的同学沟通得知，这是我们自己的业务数据库的 Lock 时间太短或者锁冲突的问题。但是回头一想不应该啊？这不一直好好的吗？而且基本都是单表单任务，不存在多人冲突。</p>\n<p>甭管谁的问题，那咱们还是先看自己的数据库有没有问题：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721826a837351642747\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nshow variables like 'innodb_lock_wait_timeout';\r\n+--------------------------+---------+\r\n| Variable_name            |   Value |\r\n|--------------------------+---------|\r\n| innodb_lock_wait_timeout |      50 |\r\n+--------------------------+---------+\r\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721826a837351642747-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a837351642747-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-598721826a837351642747-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a837351642747-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-598721826a837351642747-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a837351642747-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-598721826a837351642747-7\">7</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721826a837351642747-1\"><span class=\"crayon-e\">show </span><span class=\"crayon-e\">variables </span><span class=\"crayon-i\">like</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'innodb_lock_wait_timeout'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a837351642747-2\"><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span></div><div class=\"crayon-line\" id=\"crayon-598721826a837351642747-3\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\">            </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\">   </span><span class=\"crayon-v\">Value</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a837351642747-4\"><span class=\"crayon-o\">|</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line\" id=\"crayon-598721826a837351642747-5\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">innodb_lock_wait_timeout</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\">      </span><span class=\"crayon-cn\">50</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a837351642747-6\"><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span></div><div class=\"crayon-line\" id=\"crayon-598721826a837351642747-7\"> </div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0017 seconds] -->\r\n<p>默认 lock 超时时间 50s，这个时间真心不短了，估计调了也没用，事实上确实死马当活马医的试了下没用。。。</p>\n<p>而且这次 SHOW ENGINE INNODB STATUSG 也没出现任何死锁信息，然后又将目光转向 MySQL-server 日志，希望能从日志里看一看那个时刻前后数据究竟在做什么操作。这里先简单的介绍下MySQL日志文件系统的组成：</p>\n<p>(a) error 日志：记录启动、运行或停止 mysqld 时出现的问题，默认开启。<br>\n(b) general 日志：通用查询日志，记录所有语句和指令，开启数据库会有 5% 左右性能损失。<br>\n(c) binlog 日志：二进制格式，记录所有更改数据的语句，主要用于 slave 复制和数据恢复。<br>\n(d) slow 日志：记录所有执行时间超过 long_query_time 秒的查询或不使用索引的查询，默认关闭。<br>\n(e) Innodb日志：innodb redo log、undo log，用于恢复数据和撤销操作。</p>\n<p>从上面的介绍可以看到，目前这个问题的日志可能在 d 和 b 中，看了下 d 中没有，那就只能开启 b 了，但 b 对数据库的性能有一定损耗，由于是全量日志，量非常巨大，所以开启一定要谨慎：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721826a83b474978288\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n-- general_log 日志默认关闭，开启会影响数据库 5% 左右性能：\r\nshow variables like 'general%';\r\n+------------------+---------------------------------+\r\n| Variable_name    | Value                           |\r\n|------------------+---------------------------------|\r\n| general_log      | OFF                             |\r\n| general_log_file | /opt/data/mysql/tjtx-103-26.log |\r\n+------------------+---------------------------------+\r\n\r\n-- 全局 session 级别开启：\r\nset global general_log=1\r\n\r\n-- 如果需要对当前 session 生效需要：\r\nset general_log=1\r\n\r\n-- set 指令设置的动态参数在 MySQL 重启后失效，如果需要永久生效需要在 /etc/my.cnf 中配置静态变量/参数。\r\n-- 如果不知道 my.cnf 位置，可以根据 mysql -? | grep \".cnf\" 查询\r\n                      order of preference, my.cnf, $MYSQL_TCP_PORT,\r\n/etc/my.cnf /etc/mysql/my.cnf /usr/etc/my.cnf ~/.my.cnf</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721826a83b474978288-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a83b474978288-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-598721826a83b474978288-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a83b474978288-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-598721826a83b474978288-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a83b474978288-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-598721826a83b474978288-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a83b474978288-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-598721826a83b474978288-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a83b474978288-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-598721826a83b474978288-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a83b474978288-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-598721826a83b474978288-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a83b474978288-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-598721826a83b474978288-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a83b474978288-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-598721826a83b474978288-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a83b474978288-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-598721826a83b474978288-19\">19</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721826a83b474978288-1\"><span class=\"crayon-o\">--</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">general</span><span class=\"crayon-sy\">_</span>log<span class=\"crayon-h\"> </span>日志默认关闭，开启会影响数据库<span class=\"crayon-h\"> </span><span class=\"crayon-cn\">5</span><span class=\"crayon-o\">%</span><span class=\"crayon-h\"> </span>左右性能：</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a83b474978288-2\"><span class=\"crayon-e\">show </span><span class=\"crayon-e\">variables </span><span class=\"crayon-i\">like</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'general%'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-598721826a83b474978288-3\"><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a83b474978288-4\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\">    </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Value</span><span class=\"crayon-h\">                           </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line\" id=\"crayon-598721826a83b474978288-5\"><span class=\"crayon-o\">|</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a83b474978288-6\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">general_log</span><span class=\"crayon-h\">      </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OFF</span><span class=\"crayon-h\">                             </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line\" id=\"crayon-598721826a83b474978288-7\"><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">general_log_file</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">opt</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">data</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">mysql</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">tjtx</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">103</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">26.log</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a83b474978288-8\"><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span><span class=\"crayon-o\">+</span></div><div class=\"crayon-line\" id=\"crayon-598721826a83b474978288-9\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a83b474978288-10\"><span class=\"crayon-o\">--</span><span class=\"crayon-h\"> </span>全局<span class=\"crayon-h\"> </span><span class=\"crayon-i\">session</span><span class=\"crayon-h\"> </span>级别开启：</div><div class=\"crayon-line\" id=\"crayon-598721826a83b474978288-11\"><span class=\"crayon-e\">set </span><span class=\"crayon-m\">global</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">general_log</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">1</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a83b474978288-12\"> </div><div class=\"crayon-line\" id=\"crayon-598721826a83b474978288-13\"><span class=\"crayon-o\">--</span><span class=\"crayon-h\"> </span>如果需要对当前<span class=\"crayon-h\"> </span><span class=\"crayon-i\">session</span><span class=\"crayon-h\"> </span>生效需要：</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a83b474978288-14\"><span class=\"crayon-e\">set </span><span class=\"crayon-v\">general_log</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">1</span></div><div class=\"crayon-line\" id=\"crayon-598721826a83b474978288-15\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a83b474978288-16\"><span class=\"crayon-o\">--</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">set</span><span class=\"crayon-h\"> </span>指令设置的动态参数在<span class=\"crayon-h\"> </span><span class=\"crayon-i\">MySQL</span><span class=\"crayon-h\"> </span>重启后失效，如果需要永久生效需要在<span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">etc</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">my</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">cnf</span><span class=\"crayon-h\"> </span>中配置静态变量<span class=\"crayon-o\">/</span>参数。</div><div class=\"crayon-line\" id=\"crayon-598721826a83b474978288-17\"><span class=\"crayon-o\">--</span><span class=\"crayon-h\"> </span>如果不知道<span class=\"crayon-h\"> </span><span class=\"crayon-v\">my</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">cnf</span><span class=\"crayon-h\"> </span>位置，可以根据<span class=\"crayon-h\"> </span><span class=\"crayon-v\">mysql</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">grep</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\".cnf\"</span><span class=\"crayon-h\"> </span>查询</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a83b474978288-18\"><span class=\"crayon-h\">                      </span><span class=\"crayon-e\">order </span><span class=\"crayon-e\">of </span><span class=\"crayon-v\">preference</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">my</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">cnf</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">$</span><span class=\"crayon-v\">MYSQL_TCP_PORT</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-598721826a83b474978288-19\"><span class=\"crayon-o\">/</span><span class=\"crayon-v\">etc</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">my</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">cnf</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">etc</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">mysql</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">my</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">cnf</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">usr</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">etc</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">my</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">cnf</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">~</span><span class=\"crayon-o\">/</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">my</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">cnf</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0052 seconds] -->\r\n<p>我这里只是每天在出问题的前后半小时开启下全量日志，结果没有发现任何 MySQL-client 请求到我们的业务数据库！该日志格式如下，记录了所有的连接与命令：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721826a83f200705333\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n/usr/sbin/mysqld, Version: 5.7.12-log (MySQL Community Server (GPL)). started with:\r\nTcp port: 3306  Unix socket: /opt/data/mysql/mysql.sock\r\nTime                 Id Command    Argument\r\n2017-07-20T21:45:01.880828Z28556028 Quit\r\n2017-07-20T21:45:02.708621Z28401469 Query       SELECT 1\r\n2017-07-20T21:45:02.736734Z28556029 Connect     ooxx@127.0.0.1 on db_zz_system using TCP/IP\r\n2017-07-20T21:45:02.737242Z28556029 Query       /* mysql-connector-java-5.1.6 ( Revision: ${svn.Revision} ) */SHOW VARIABLES WHERE Variable_name ='language' OR Variable_name = 'net_write_timeout' OR Variable_name = 'interactive_timeout' OR Variable_name = 'wait_timeout' OR Variable_name = 'character_set_client' OR Variable_name = 'character_set_connection' OR Variable_name = 'character_set' OR Variable_name = 'character_set_server' OR Variable_name = 'tx_isolation' OR Variable_name = 'transaction_isolation' OR Variable_name = 'character_set_results' OR Variable_name = 'timezone' OR Variable_name = 'time_zone' OR Variable_name = 'system_time_zone' OR Variable_name = 'lower_case_table_names' OR Variable_name = 'max_allowed_packet' OR Variable_name = 'net_buffer_length' OR Variable_name = 'sql_mode' OR Variable_name = 'query_cache_type' OR Variable_name = 'query_cache_size' OR Variable_name = 'init_connect'\r\n2017-07-20T21:45:02.738868Z28556029 Query       SHOW COLLATION\r\n2017-07-20T21:45:02.739941Z28556029 Query       SET character_set_results = NULL\r\n2017-07-20T21:45:02.740275Z28556029 Query       SET autocommit=1</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721826a83f200705333-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a83f200705333-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-598721826a83f200705333-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a83f200705333-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-598721826a83f200705333-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a83f200705333-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-598721826a83f200705333-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a83f200705333-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-598721826a83f200705333-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a83f200705333-10\">10</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721826a83f200705333-1\"><span class=\"crayon-o\">/</span><span class=\"crayon-v\">usr</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">sbin</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">mysqld</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Version</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">5.7.12</span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">log</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">MySQL </span><span class=\"crayon-e\">Community </span><span class=\"crayon-e\">Server</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">GPL</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">started </span><span class=\"crayon-v\">with</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a83f200705333-2\"><span class=\"crayon-e\">Tcp </span><span class=\"crayon-v\">port</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">3306</span><span class=\"crayon-h\">  </span><span class=\"crayon-e\">Unix </span><span class=\"crayon-v\">socket</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">opt</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">data</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">mysql</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">mysql</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">sock</span></div><div class=\"crayon-line\" id=\"crayon-598721826a83f200705333-3\"><span class=\"crayon-e\">Time                 </span><span class=\"crayon-e\">Id </span><span class=\"crayon-e\">Command    </span><span class=\"crayon-i\">Argument</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a83f200705333-4\"><span class=\"crayon-cn\">2017</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">07</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">20T21</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">45</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">01.880828Z28556028</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Quit</span></div><div class=\"crayon-line\" id=\"crayon-598721826a83f200705333-5\"><span class=\"crayon-cn\">2017</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">07</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">20T21</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">45</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">02.708621Z28401469</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Query       </span><span class=\"crayon-i\">SELECT</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a83f200705333-6\"><span class=\"crayon-cn\">2017</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">07</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">20T21</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">45</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">02.736734Z28556029</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Connect     </span><span class=\"crayon-v\">ooxx</span><span class=\"crayon-sy\">@</span><span class=\"crayon-cn\">127.0.0.1</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">on </span><span class=\"crayon-e\">db_zz_system </span><span class=\"crayon-e\">using </span><span class=\"crayon-v\">TCP</span><span class=\"crayon-o\">/</span><span class=\"crayon-i\">IP</span></div><div class=\"crayon-line\" id=\"crayon-598721826a83f200705333-7\"><span class=\"crayon-cn\">2017</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">07</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">20T21</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">45</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">02.737242Z28556029</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Query</span><span class=\"crayon-h\">       </span><span class=\"crayon-c\">/* mysql-connector-java-5.1.6 ( Revision: ${svn.Revision} ) */</span><span class=\"crayon-e\">SHOW </span><span class=\"crayon-e\">VARIABLES </span><span class=\"crayon-e\">WHERE </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-s\">'language'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'net_write_timeout'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'interactive_timeout'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'wait_timeout'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'character_set_client'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'character_set_connection'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'character_set'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'character_set_server'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'tx_isolation'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'transaction_isolation'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'character_set_results'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'timezone'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'time_zone'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'system_time_zone'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'lower_case_table_names'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'max_allowed_packet'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'net_buffer_length'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'sql_mode'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'query_cache_type'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'query_cache_size'</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">OR</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Variable_name</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'init_connect'</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a83f200705333-8\"><span class=\"crayon-cn\">2017</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">07</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">20T21</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">45</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">02.738868Z28556029</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Query       </span><span class=\"crayon-e\">SHOW </span><span class=\"crayon-i\">COLLATION</span></div><div class=\"crayon-line\" id=\"crayon-598721826a83f200705333-9\"><span class=\"crayon-cn\">2017</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">07</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">20T21</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">45</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">02.739941Z28556029</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Query       </span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">character_set_results</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">NULL</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a83f200705333-10\"><span class=\"crayon-cn\">2017</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">07</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">20T21</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">45</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">02.740275Z28556029</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Query       </span><span class=\"crayon-e\">SET </span><span class=\"crayon-v\">autocommit</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">1</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0063 seconds] -->\r\n<p>那问题基本确定了，客户端请求都没到我们这边就抛出了上述的异常，和平台方再三沟通确认下，最后平台方查证是因为在执行插入前他们需要先从 SQL task 表取出 SQL 和更新 task 状态，结果这张表由于在整点存在大量 insert 和 update 并发，导致部分 SQL 等待 lock 超时了。。。</p>\n<p><img class=\"aligncenter\" src=\"http://jbcdn2.b0.upaiyun.com/2017/07/d29579706b846656c946e30891c2c075.jpg\" alt=\"\" width=\"280\" height=\"200\"></p>\n<h3>3、MySQL 日志分析脚本</h3>\n<p>由于凌晨是数据仓库的业务高峰，很多问题都是在这个时候爆发，一些诡异的问题往往是过了这个村就没这个店了，白天无法复现。如何能捕获我们关心的日志，便于快速的定位问题，这个是重中之重，这里我写了个小脚本，crontab 部署，可以选择时间范围开启，每分钟采样一次日志，需要说明的是 general log 没事别轻易开启，否则对数据库性能损耗较大。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721826a844458655831\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n# crontab 部署方式：\r\n# */1 0-10 * * * cd /opt/ooxx/script &amp;&amp; bash mysql_perf.sh &gt;&gt; logs/mysql_perf.log.`date -I` 2&gt;&amp;1\r\n\r\ndate -Iseconds\r\n\r\necho '&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; top -bn1|head'\r\ntop -bn1|head \r\necho\r\n\r\necho '&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; SHOW ENGINE INNODB STATUS\\G '\r\nmysql -uroot -pooxx -h127.0.0.1 -e 'SHOW ENGINE INNODB STATUS\\G'\r\necho\r\n\r\necho '&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; show open tables where in_use&gt;0;'\r\nmysql -uroot -pooxx -h127.0.0.1 -e 'show open tables where in_use&gt;0;'\r\necho\r\n\r\necho '&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; show full processlist;'\r\nmysql -uroot -pooxx -h127.0.0.1 -e 'show full processlist;'\r\necho\r\n\r\necho '&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; SELECT * FROM `information_schema`.`innodb_trx` ORDER BY `trx_started`; '\r\nmysql -uroot -pooxx -h127.0.0.1 -e 'SELECT * FROM `information_schema`.`innodb_trx` ORDER BY `trx_started`;' \r\necho\r\n\r\necho '&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; SELECT * FROM `information_schema`.`innodb_locks`;'\r\nmysql -uroot -pooxx -h127.0.0.1 -e 'SELECT * FROM `information_schema`.`innodb_locks`;'\r\necho\r\n\r\necho \"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; show status like '%lock%';\"\r\nmysql -uroot -pooxx -h127.0.0.1 -e \"show status like '%lock%';\"\r\necho\r\n\r\necho '&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; show global status like \"table_locks%\";'\r\nmysql -uroot -pooxx -h127.0.0.1 -e 'show global status like \"table_locks%\";'\r\necho\r\n\r\necho \"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; too long omit...\"\r\nmysql -uroot -pooxx -h127.0.0.1 -e \"select r.trx_isolation_level, r.trx_id waiting_trx_id, r.trx_mysql_thread_id waiting_trx_thread, r.trx_state waiting_trx_state, lr.lock_mode waiting_trx_lock_mode, lr.lock_type waiting_trx_lock_type, lr.lock_table waiting_trx_lock_table, lr.lock_index waiting_trx_lock_index, r.trx_query waiting_trx_query, b.trx_id blocking_trx_id, b.trx_mysql_thread_id blocking_trx_thread, b.trx_state blocking_trx_state, lb.lock_mode blocking_trx_lock_mode, lb.lock_type blocking_trx_lock_type, lb.lock_table blocking_trx_lock_table, lb.lock_index blocking_trx_lock_index, b.trx_query blocking_query from information_schema.innodb_lock_waits w inner join information_schema.innodb_trx b on b.trx_id=w.blocking_trx_id inner join information_schema.innodb_trx r on r.trx_id=w.requesting_trx_id inner join information_schema.innodb_locks lb on lb.lock_trx_id=w.blocking_trx_id inner join information_schema.innodb_locks lr on lr.lock_trx_id=w.requesting_trx_id\\G\"\r\necho\r\n\r\necho \"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; too long omit...\"\r\nmysql -uroot -pooxx -h127.0.0.1 -e \"SELECT r.trx_id waiting_trx_id, r.trx_mysql_thread_id waiting_thread, r.trx_query waiting_query, b.trx_id blocking_trx_id, b.trx_mysql_thread_id blocking_thread, b.trx_query blocking_query FROM information_schema.innodb_lock_waits w INNER JOIN information_schema.innodb_trx b ON b.trx_id = w.blocking_trx_id INNER JOIN information_schema.innodb_trx r ON r.trx_id = w.requesting_trx_id\\G\"\r\necho\r\n\r\n\r\ndate -Iseconds\r\necho '&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;=================================================================================='\r\necho\r\n\r\nfile_name=mysql_perf.log.`date -I`\r\nif [[ `date +%-H%-M` == 1059 ]]\r\nthen\r\n cd /opt/ooxx/script/logs\r\n chmod 777 /home/work/ooxx/$file_name\r\n find /home/work/ooxx -name 'mysql_perf.log.*' -mtime +7 -delete\r\n \r\n cd /opt/data/mysql\r\n cp tjtx-ooxx-slow.log /home/work/ooxx/tjtx-ooxx-slow.log.`date -I`\r\n chmod 777 /home/work/ooxx/tjtx-ooxx-slow.log.`date -I`\r\n find /home/work/ooxx -name 'tjtx-ooxx-slow.log.*' -mtime +7 -delete\r\n \r\n cp mysqld.log /home/work/ooxx/mysqld.log.`date -I`\r\n chmod 777 /home/work/ooxx/mysqld.log.`date -I`\r\n find /home/work/ooxx -name 'mysqld.log.*' -mtime +7 -delete\r\nfi\r\n\r\n\r\n################\r\n# 开启 general_log 全量明细日志会降低数据库 5% 性能\r\n#if [[ \"`date +%H%M`\" == \"0545\" ]]\r\n#then\r\n# echo \"`date +%H%M` ------- set global general_log=1;\"\r\n# mysql -uroot -pooxx -h127.0.0.1 -e 'set global general_log=1;'\r\n#elif [[ \"`date +%H%M`\" == \"0630\" ]]\r\n#then\r\n# echo \"`date +%H%M` ------- set global general_log=0;\"\r\n# mysql -uroot -pooxx -h127.0.0.1 -e 'set global general_log=0;'\r\n#elif [[ \"`date +%H%M`\" == \"0745\" ]]\r\n#then\r\n# echo \"`date +%H%M` ------- set global general_log=1;\"\r\n# mysql -uroot -pooxx -h127.0.0.1 -e 'set global general_log=1;'\r\n#elif [[ \"`date +%H%M`\" == \"0830\" ]]\r\n#then\r\n# echo \"`date +%H%M` ------- set global general_log=0;\"\r\n# mysql -uroot -pooxx -h127.0.0.1 -e 'set global general_log=0;'\r\n#elif [[ \"`date +%H%M`\" == \"0001\" ]]\r\n#then\r\n# echo \"`date +%H%M` ------- set global general_log=1;\"\r\n# mysql -uroot -pooxx -h127.0.0.1 -e 'set global general_log=1;'\r\n#elif [[ \"`date +%H%M`\" == \"0002\" ]]\r\n#then\r\n# echo \"`date +%H%M` ------- set global general_log=0;\"\r\n# mysql -uroot -pooxx -h127.0.0.1 -e 'set global general_log=0;'\r\n#fi\r\n\r\n\r\n\r\n\r\n\r\n#[[ 10#`date +%H%M` -lt 10#0550 || 10#`date +%H%M` -gt 10#0830 ]] &amp;&amp; echo \"`date +%H%M` ------- set global general_log=0;\" &amp;&amp; mysql -uroot -pooxx -h127.0.0.1 -e 'set global general_log=0;'\r\n\r\n\r\n# mysql -uroot -pooxx -h127.0.0.1 -e 'show open tables where in_use&gt;0;show full processlist;SELECT * FROM `information_schema`.`innodb_trx` ORDER BY `trx_started`;SELECT * FROM `information_schema`.`innodb_locks`;SHOW ENGINE INNODB STATUS\\G'\r\n\r\n# --show variables like '%tx_isolation%';\r\n# --SELECT @@GLOBAL.tx_isolation, @@tx_isolation, @@session.tx_isolation;\r\n# -- SET GLOBAL tx_isolation = 'READ-COMMITTED';\r\n# \r\n# --show variables like '%timeout%';\r\n# --show variables like 'innodb_lock_wait_timeout';\r\n# -- SET GLOBAL innodb_lock_wait_timeout=60\r\n# \r\n# --show variables like 'long_query_time';\r\n# -- SET global long_query_time=3;\r\n\r\n\r\n# -- show variables like 'innodb_rollback_on_timeout';\r\n\r\n# -- show VARIABLES like '%max_allowed_packet%';\r\n# -- set global max_allowed_packet = 100*1024*1024;\r\n\r\n# 自动提交\r\n# -- show variables like 'autocommit';\r\n\r\n# 慢查询\r\n# -- show variables like '%slow_query_log%';\r\n# set global 只对当前数据库生效，如果MySQL重启后则会失效。如果要永久生效，就必须修改配置文件my.cnf（其它系统变量也是如此）。\r\n# set global slow_query_log=1;\r\n# -- show variables like 'long_query_time%';\r\n# set global long_query_time=4;\r\n# show global variables like 'long_query_time'; \r\n# select sleep(5);\r\n# -- show variables like 'log_queries_not_using_indexes';\r\n# set global log_queries_not_using_indexes=1;\r\n# -- show variables like 'log_slow_admin_statements';\r\n# -- show global status like '%Slow_queries%';\r\n# http://www.cnblogs.com/kerrycode/p/5593204.html\r\n\r\n\r\n\r\n# -- show variables like \"%time_zone%\";\r\n#set global time_zone = '+8:00';\r\n\r\n#开启general_log日志\r\n# -- show variables like 'general%';\r\n#可以在my.cnf里添加,1开启（0关闭）,当然了,这样要重启才能生效,有点多余了\r\n#general-log = 1\r\n#log = /log/mysql_query.log路径\r\n#也可以设置变量那样更改,1开启（0关闭）,即时生效,不用重启,首选当然是这样的了\r\n# set global general_log=1\r\n#这个日志对于操作频繁的库,产生的数据量会很快增长,出于对硬盘的保护,可以设置其他存放路径\r\n#set global general_log_file=/tmp/general_log.log\r\n\r\n#mysql记录客户端IP：init_connect，有super权限的用户是不记录的，\r\n# create table t1 ( cur_user varchar(100), n_user varchar(100),in_time timestamp default current_timestamp()) ;\r\n# set global init_connect='insert into test.t1 (cur_user,n_user) values (current_user(),user())'; \r\n# SHOW CREATE TABLE mysql.general_log\\G ，开启general_log日志也行：\r\n# https://dba.stackexchange.com/questions/33654/mysql-logging-activity-from-specific-user-or-ip \r\n#SELECT REVERSE(SUBSTRING_INDEX(REVERSE(USER()),'@',1)) as ip;\r\n#SELECT SUBSTRING(USER(), LOCATE('@', USER())+1) as ip;\r\n#select SUBSTRING_INDEX(host,':',1) as 'ip' from information_schema.processlist WHERE ID=connection_id();</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-26\">26</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-27\">27</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-28\">28</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-29\">29</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-30\">30</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-31\">31</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-32\">32</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-33\">33</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-34\">34</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-35\">35</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-36\">36</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-37\">37</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-38\">38</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-39\">39</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-40\">40</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-41\">41</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-42\">42</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-43\">43</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-44\">44</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-45\">45</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-46\">46</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-47\">47</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-48\">48</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-49\">49</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-50\">50</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-51\">51</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-52\">52</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-53\">53</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-54\">54</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-55\">55</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-56\">56</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-57\">57</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-58\">58</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-59\">59</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-60\">60</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-61\">61</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-62\">62</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-63\">63</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-64\">64</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-65\">65</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-66\">66</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-67\">67</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-68\">68</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-69\">69</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-70\">70</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-71\">71</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-72\">72</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-73\">73</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-74\">74</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-75\">75</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-76\">76</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-77\">77</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-78\">78</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-79\">79</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-80\">80</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-81\">81</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-82\">82</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-83\">83</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-84\">84</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-85\">85</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-86\">86</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-87\">87</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-88\">88</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-89\">89</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-90\">90</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-91\">91</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-92\">92</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-93\">93</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-94\">94</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-95\">95</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-96\">96</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-97\">97</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-98\">98</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-99\">99</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-100\">100</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-101\">101</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-102\">102</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-103\">103</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-104\">104</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-105\">105</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-106\">106</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-107\">107</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-108\">108</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-109\">109</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-110\">110</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-111\">111</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-112\">112</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-113\">113</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-114\">114</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-115\">115</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-116\">116</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-117\">117</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-118\">118</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-119\">119</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-120\">120</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-121\">121</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-122\">122</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-123\">123</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-124\">124</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-125\">125</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-126\">126</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-127\">127</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-128\">128</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-129\">129</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-130\">130</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-131\">131</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-132\">132</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-133\">133</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-134\">134</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-135\">135</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-136\">136</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-137\">137</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-138\">138</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-139\">139</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-140\">140</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-141\">141</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-142\">142</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-143\">143</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-144\">144</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-145\">145</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-146\">146</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-147\">147</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-148\">148</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-149\">149</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-150\">150</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-151\">151</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-152\">152</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-153\">153</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-154\">154</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-155\">155</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-156\">156</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-157\">157</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-158\">158</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-159\">159</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-160\">160</div><div class=\"crayon-num\" data-line=\"crayon-598721826a844458655831-161\">161</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721826a844458655831-162\">162</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-1\"><span class=\"crayon-p\"># crontab 部署方式：</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-2\"><span class=\"crayon-p\"># */1 0-10 * * * cd /opt/ooxx/script &amp;&amp; bash mysql_perf.sh &gt;&gt; logs/mysql_perf.log.`date -I` 2&gt;&amp;1</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-3\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-4\"><span class=\"crayon-v\">date</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">Iseconds</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-5\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-6\"><span class=\"crayon-i\">echo</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; top -bn1|head'</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-7\"><span class=\"crayon-v\">top</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">bn1</span><span class=\"crayon-o\">|</span><span class=\"crayon-e\">head </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-8\"><span class=\"crayon-e\">echo</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-9\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-10\"><span class=\"crayon-i\">echo</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; SHOW ENGINE INNODB STATUS\\G '</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-11\"><span class=\"crayon-v\">mysql</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">uroot</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">pooxx</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">h127</span><span class=\"crayon-sy\">.</span><span class=\"crayon-cn\">0.0.1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">e</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'SHOW ENGINE INNODB STATUS\\G'</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-12\"><span class=\"crayon-e\">echo</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-13\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-14\"><span class=\"crayon-i\">echo</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; show open tables where in_use&gt;0;'</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-15\"><span class=\"crayon-v\">mysql</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">uroot</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">pooxx</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">h127</span><span class=\"crayon-sy\">.</span><span class=\"crayon-cn\">0.0.1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">e</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'show open tables where in_use&gt;0;'</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-16\"><span class=\"crayon-e\">echo</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-17\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-18\"><span class=\"crayon-i\">echo</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; show full processlist;'</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-19\"><span class=\"crayon-v\">mysql</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">uroot</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">pooxx</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">h127</span><span class=\"crayon-sy\">.</span><span class=\"crayon-cn\">0.0.1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">e</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'show full processlist;'</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-20\"><span class=\"crayon-e\">echo</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-21\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-22\"><span class=\"crayon-i\">echo</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; SELECT * FROM `information_schema`.`innodb_trx` ORDER BY `trx_started`; '</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-23\"><span class=\"crayon-v\">mysql</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">uroot</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">pooxx</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">h127</span><span class=\"crayon-sy\">.</span><span class=\"crayon-cn\">0.0.1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">e</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'SELECT * FROM `information_schema`.`innodb_trx` ORDER BY `trx_started`;'</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-24\"><span class=\"crayon-e\">echo</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-25\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-26\"><span class=\"crayon-i\">echo</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; SELECT * FROM `information_schema`.`innodb_locks`;'</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-27\"><span class=\"crayon-v\">mysql</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">uroot</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">pooxx</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">h127</span><span class=\"crayon-sy\">.</span><span class=\"crayon-cn\">0.0.1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">e</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'SELECT * FROM `information_schema`.`innodb_locks`;'</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-28\"><span class=\"crayon-e\">echo</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-29\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-30\"><span class=\"crayon-i\">echo</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; show status like '%lock%';\"</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-31\"><span class=\"crayon-v\">mysql</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">uroot</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">pooxx</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">h127</span><span class=\"crayon-sy\">.</span><span class=\"crayon-cn\">0.0.1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">e</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"show status like '%lock%';\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-32\"><span class=\"crayon-e\">echo</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-33\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-34\"><span class=\"crayon-i\">echo</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; show global status like \"table_locks%\";'</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-35\"><span class=\"crayon-v\">mysql</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">uroot</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">pooxx</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">h127</span><span class=\"crayon-sy\">.</span><span class=\"crayon-cn\">0.0.1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">e</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'show global status like \"table_locks%\";'</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-36\"><span class=\"crayon-e\">echo</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-37\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-38\"><span class=\"crayon-i\">echo</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; too long omit...\"</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-39\"><span class=\"crayon-v\">mysql</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">uroot</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">pooxx</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">h127</span><span class=\"crayon-sy\">.</span><span class=\"crayon-cn\">0.0.1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">e</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"select r.trx_isolation_level, r.trx_id waiting_trx_id, r.trx_mysql_thread_id waiting_trx_thread, r.trx_state waiting_trx_state, lr.lock_mode waiting_trx_lock_mode, lr.lock_type waiting_trx_lock_type, lr.lock_table waiting_trx_lock_table, lr.lock_index waiting_trx_lock_index, r.trx_query waiting_trx_query, b.trx_id blocking_trx_id, b.trx_mysql_thread_id blocking_trx_thread, b.trx_state blocking_trx_state, lb.lock_mode blocking_trx_lock_mode, lb.lock_type blocking_trx_lock_type, lb.lock_table blocking_trx_lock_table, lb.lock_index blocking_trx_lock_index, b.trx_query blocking_query from information_schema.innodb_lock_waits w inner join information_schema.innodb_trx b on b.trx_id=w.blocking_trx_id inner join information_schema.innodb_trx r on r.trx_id=w.requesting_trx_id inner join information_schema.innodb_locks lb on lb.lock_trx_id=w.blocking_trx_id inner join information_schema.innodb_locks lr on lr.lock_trx_id=w.requesting_trx_id\\G\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-40\"><span class=\"crayon-e\">echo</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-41\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-42\"><span class=\"crayon-i\">echo</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; too long omit...\"</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-43\"><span class=\"crayon-v\">mysql</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">uroot</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">pooxx</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">h127</span><span class=\"crayon-sy\">.</span><span class=\"crayon-cn\">0.0.1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">e</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"SELECT r.trx_id waiting_trx_id, r.trx_mysql_thread_id waiting_thread, r.trx_query waiting_query, b.trx_id blocking_trx_id, b.trx_mysql_thread_id blocking_thread, b.trx_query blocking_query FROM information_schema.innodb_lock_waits w INNER JOIN information_schema.innodb_trx b ON b.trx_id = w.blocking_trx_id INNER JOIN information_schema.innodb_trx r ON r.trx_id = w.requesting_trx_id\\G\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-44\"><span class=\"crayon-e\">echo</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-45\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-46\"> </div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-47\"><span class=\"crayon-v\">date</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">Iseconds</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-48\"><span class=\"crayon-i\">echo</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;=================================================================================='</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-49\"><span class=\"crayon-e\">echo</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-50\"> </div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-51\"><span class=\"crayon-v\">file_name</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">mysql_perf</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">log</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">date</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">I</span><span class=\"crayon-sy\">`</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-52\"><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">[</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">date</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-o\">%</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">H</span><span class=\"crayon-o\">%</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">M</span><span class=\"crayon-sy\">`</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1059</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-53\"><span class=\"crayon-st\">then</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-54\"><span class=\"crayon-h\"> </span><span class=\"crayon-v\">cd</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">opt</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">ooxx</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">script</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">logs</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-55\"><span class=\"crayon-e\"> </span><span class=\"crayon-i\">chmod</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">777</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">home</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">work</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">ooxx</span><span class=\"crayon-o\">/</span><span class=\"crayon-sy\">$</span><span class=\"crayon-e\">file_name</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-56\"><span class=\"crayon-e\"> </span><span class=\"crayon-v\">find</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">home</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">work</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">ooxx</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">name</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'mysql_perf.log.*'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">mtime</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-cn\">7</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">delete</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-57\"><span class=\"crayon-e\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-58\"><span class=\"crayon-e\"> </span><span class=\"crayon-v\">cd</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">opt</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">data</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">mysql</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-59\"><span class=\"crayon-e\"> </span><span class=\"crayon-e\">cp </span><span class=\"crayon-v\">tjtx</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">ooxx</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">slow</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">log</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">home</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">work</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">ooxx</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">tjtx</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">ooxx</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">slow</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">log</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">date</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">I</span><span class=\"crayon-sy\">`</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-60\"><span class=\"crayon-h\"> </span><span class=\"crayon-i\">chmod</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">777</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">home</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">work</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">ooxx</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">tjtx</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">ooxx</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">slow</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">log</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">date</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">I</span><span class=\"crayon-sy\">`</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-61\"><span class=\"crayon-h\"> </span><span class=\"crayon-v\">find</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">home</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">work</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">ooxx</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">name</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'tjtx-ooxx-slow.log.*'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">mtime</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-cn\">7</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">delete</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-62\"><span class=\"crayon-e\"> </span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-63\"><span class=\"crayon-e\"> </span><span class=\"crayon-e\">cp </span><span class=\"crayon-v\">mysqld</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">log</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">home</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">work</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">ooxx</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">mysqld</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">log</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">date</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">I</span><span class=\"crayon-sy\">`</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-64\"><span class=\"crayon-h\"> </span><span class=\"crayon-i\">chmod</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">777</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">home</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">work</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">ooxx</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">mysqld</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">log</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">`</span><span class=\"crayon-v\">date</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">I</span><span class=\"crayon-sy\">`</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-65\"><span class=\"crayon-h\"> </span><span class=\"crayon-v\">find</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">home</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">work</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">ooxx</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">name</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'mysqld.log.*'</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">mtime</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-cn\">7</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">delete</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-66\"><span class=\"crayon-v\">fi</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-67\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-68\"> </div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-69\"><span class=\"crayon-p\">################</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-70\"><span class=\"crayon-p\"># 开启 general_log 全量明细日志会降低数据库 5% 性能</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-71\"><span class=\"crayon-p\">#if [[ \"`date +%H%M`\" == \"0545\" ]]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-72\"><span class=\"crayon-p\">#then</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-73\"><span class=\"crayon-p\"># echo \"`date +%H%M` ------- set global general_log=1;\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-74\"><span class=\"crayon-p\"># mysql -uroot -pooxx -h127.0.0.1 -e 'set global general_log=1;'</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-75\"><span class=\"crayon-p\">#elif [[ \"`date +%H%M`\" == \"0630\" ]]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-76\"><span class=\"crayon-p\">#then</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-77\"><span class=\"crayon-p\"># echo \"`date +%H%M` ------- set global general_log=0;\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-78\"><span class=\"crayon-p\"># mysql -uroot -pooxx -h127.0.0.1 -e 'set global general_log=0;'</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-79\"><span class=\"crayon-p\">#elif [[ \"`date +%H%M`\" == \"0745\" ]]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-80\"><span class=\"crayon-p\">#then</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-81\"><span class=\"crayon-p\"># echo \"`date +%H%M` ------- set global general_log=1;\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-82\"><span class=\"crayon-p\"># mysql -uroot -pooxx -h127.0.0.1 -e 'set global general_log=1;'</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-83\"><span class=\"crayon-p\">#elif [[ \"`date +%H%M`\" == \"0830\" ]]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-84\"><span class=\"crayon-p\">#then</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-85\"><span class=\"crayon-p\"># echo \"`date +%H%M` ------- set global general_log=0;\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-86\"><span class=\"crayon-p\"># mysql -uroot -pooxx -h127.0.0.1 -e 'set global general_log=0;'</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-87\"><span class=\"crayon-p\">#elif [[ \"`date +%H%M`\" == \"0001\" ]]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-88\"><span class=\"crayon-p\">#then</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-89\"><span class=\"crayon-p\"># echo \"`date +%H%M` ------- set global general_log=1;\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-90\"><span class=\"crayon-p\"># mysql -uroot -pooxx -h127.0.0.1 -e 'set global general_log=1;'</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-91\"><span class=\"crayon-p\">#elif [[ \"`date +%H%M`\" == \"0002\" ]]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-92\"><span class=\"crayon-p\">#then</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-93\"><span class=\"crayon-p\"># echo \"`date +%H%M` ------- set global general_log=0;\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-94\"><span class=\"crayon-p\"># mysql -uroot -pooxx -h127.0.0.1 -e 'set global general_log=0;'</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-95\"><span class=\"crayon-p\">#fi</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-96\"> </div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-97\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-98\"> </div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-99\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-100\"> </div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-101\"><span class=\"crayon-p\">#[[ 10#`date +%H%M` -lt 10#0550 || 10#`date +%H%M` -gt 10#0830 ]] &amp;&amp; echo \"`date +%H%M` ------- set global general_log=0;\" &amp;&amp; mysql -uroot -pooxx -h127.0.0.1 -e 'set global general_log=0;'</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-102\"> </div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-103\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-104\"><span class=\"crayon-p\"># mysql -uroot -pooxx -h127.0.0.1 -e 'show open tables where in_use&gt;0;show full processlist;SELECT * FROM `information_schema`.`innodb_trx` ORDER BY `trx_started`;SELECT * FROM `information_schema`.`innodb_locks`;SHOW ENGINE INNODB STATUS\\G'</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-105\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-106\"><span class=\"crayon-p\"># --show variables like '%tx_isolation%';</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-107\"><span class=\"crayon-p\"># --SELECT @@GLOBAL.tx_isolation, @@tx_isolation, @@session.tx_isolation;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-108\"><span class=\"crayon-p\"># -- SET GLOBAL tx_isolation = 'READ-COMMITTED';</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-109\"><span class=\"crayon-p\"># </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-110\"><span class=\"crayon-p\"># --show variables like '%timeout%';</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-111\"><span class=\"crayon-p\"># --show variables like 'innodb_lock_wait_timeout';</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-112\"><span class=\"crayon-p\"># -- SET GLOBAL innodb_lock_wait_timeout=60</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-113\"><span class=\"crayon-p\"># </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-114\"><span class=\"crayon-p\"># --show variables like 'long_query_time';</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-115\"><span class=\"crayon-p\"># -- SET global long_query_time=3;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-116\"> </div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-117\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-118\"><span class=\"crayon-p\"># -- show variables like 'innodb_rollback_on_timeout';</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-119\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-120\"><span class=\"crayon-p\"># -- show VARIABLES like '%max_allowed_packet%';</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-121\"><span class=\"crayon-p\"># -- set global max_allowed_packet = 100*1024*1024;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-122\"> </div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-123\"><span class=\"crayon-p\"># 自动提交</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-124\"><span class=\"crayon-p\"># -- show variables like 'autocommit';</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-125\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-126\"><span class=\"crayon-p\"># 慢查询</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-127\"><span class=\"crayon-p\"># -- show variables like '%slow_query_log%';</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-128\"><span class=\"crayon-p\"># set global 只对当前数据库生效，如果MySQL重启后则会失效。如果要永久生效，就必须修改配置文件my.cnf（其它系统变量也是如此）。</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-129\"><span class=\"crayon-p\"># set global slow_query_log=1;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-130\"><span class=\"crayon-p\"># -- show variables like 'long_query_time%';</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-131\"><span class=\"crayon-p\"># set global long_query_time=4;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-132\"><span class=\"crayon-p\"># show global variables like 'long_query_time'; </span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-133\"><span class=\"crayon-p\"># select sleep(5);</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-134\"><span class=\"crayon-p\"># -- show variables like 'log_queries_not_using_indexes';</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-135\"><span class=\"crayon-p\"># set global log_queries_not_using_indexes=1;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-136\"><span class=\"crayon-p\"># -- show variables like 'log_slow_admin_statements';</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-137\"><span class=\"crayon-p\"># -- show global status like '%Slow_queries%';</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-138\"><span class=\"crayon-p\"># http://www.cnblogs.com/kerrycode/p/5593204.html</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-139\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-140\"> </div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-141\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-142\"><span class=\"crayon-p\"># -- show variables like \"%time_zone%\";</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-143\"><span class=\"crayon-p\">#set global time_zone = '+8:00';</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-144\"> </div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-145\"><span class=\"crayon-p\">#开启general_log日志</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-146\"><span class=\"crayon-p\"># -- show variables like 'general%';</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-147\"><span class=\"crayon-p\">#可以在my.cnf里添加,1开启（0关闭）,当然了,这样要重启才能生效,有点多余了</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-148\"><span class=\"crayon-p\">#general-log = 1</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-149\"><span class=\"crayon-p\">#log = /log/mysql_query.log路径</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-150\"><span class=\"crayon-p\">#也可以设置变量那样更改,1开启（0关闭）,即时生效,不用重启,首选当然是这样的了</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-151\"><span class=\"crayon-p\"># set global general_log=1</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-152\"><span class=\"crayon-p\">#这个日志对于操作频繁的库,产生的数据量会很快增长,出于对硬盘的保护,可以设置其他存放路径</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-153\"><span class=\"crayon-p\">#set global general_log_file=/tmp/general_log.log</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-154\"> </div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-155\"><span class=\"crayon-p\">#mysql记录客户端IP：init_connect，有super权限的用户是不记录的，</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-156\"><span class=\"crayon-p\"># create table t1 ( cur_user varchar(100), n_user varchar(100),in_time timestamp default current_timestamp()) ;</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-157\"><span class=\"crayon-p\"># set global init_connect='insert into test.t1 (cur_user,n_user) values (current_user(),user())'; </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-158\"><span class=\"crayon-p\"># SHOW CREATE TABLE mysql.general_log\\G ，开启general_log日志也行：</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-159\"><span class=\"crayon-p\"># https://dba.stackexchange.com/questions/33654/mysql-logging-activity-from-specific-user-or-ip </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-160\"><span class=\"crayon-p\">#SELECT REVERSE(SUBSTRING_INDEX(REVERSE(USER()),'@',1)) as ip;</span></div><div class=\"crayon-line\" id=\"crayon-598721826a844458655831-161\"><span class=\"crayon-p\">#SELECT SUBSTRING(USER(), LOCATE('@', USER())+1) as ip;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721826a844458655831-162\"><span class=\"crayon-p\">#select SUBSTRING_INDEX(host,':',1) as 'ip' from information_schema.processlist WHERE ID=connection_id();</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0138 seconds] -->\r\n<p></p>\n<h3>Refer：</h3>\n<p>[1] MySQL批量SQL插入性能优化</p>\n<p><a href=\"http://database.51cto.com/art/201309/411050.htm\" target=\"_blank\" rel=\"nofollow\">http://database.51cto.com/art/201309/411050.htm</a></p>\n<p>[2] MySQL 四种事务隔离级的说明</p>\n<p><a href=\"http://www.cnblogs.com/zhoujinyi/p/3437475.html\" target=\"_blank\" rel=\"nofollow\">http://www.cnblogs.com/zhoujinyi/p/3437475.html</a></p>\n<p>[3] innodb_rollback_on_timeout参数对锁的影响</p>\n<p><a href=\"http://q.fireflyclub.org/?/article/37\" target=\"_blank\" rel=\"nofollow\">http://q.fireflyclub.org/?/article/37</a></p>\n<p>[4] 日均万条数据丢失，一个隐式骚操作导致的奇葩事故！</p>\n<p><a href=\"https://mp.weixin.qq.com/s/OpPV24ILewVc2lRDrV4vvA\" target=\"_blank\" rel=\"nofollow\">https://mp.weixin.qq.com/s/OpPV24ILewVc2lRDrV4vvA</a></p>\n<p>[5] mysql之show engine innodb status解读（转）</p>\n<p><a href=\"http://www.cnblogs.com/ajianbeyourself/p/6941905.html\" target=\"_blank\" rel=\"nofollow\">http://www.cnblogs.com/ajianbeyourself/p/6941905.html</a></p>\n<p><a href=\"http://www.cnblogs.com/olinux/p/5497176.html\" target=\"_blank\" rel=\"nofollow\">http://www.cnblogs.com/olinux/p/5497176.html</a></p>\n<p>[6] Mysql 锁机制笔记</p>\n<p><a href=\"http://www.jianshu.com/p/fa28035656a9\" target=\"_blank\" rel=\"nofollow\">http://www.jianshu.com/p/fa28035656a9</a></p>\n<p><a href=\"http://www.jianshu.com/p/ec4a343c49f0\" target=\"_blank\" rel=\"nofollow\">http://www.jianshu.com/p/ec4a343c49f0</a></p>\n<p><a href=\"http://hudeyong926.iteye.com/blog/1490687\" target=\"_blank\" rel=\"nofollow\">http://hudeyong926.iteye.com/blog/1490687</a></p>\n<p>[7] MySQL索引原理及慢查询优化</p>\n<p><a href=\"https://tech.meituan.com/mysql-index.html\" target=\"_blank\" rel=\"nofollow\">https://tech.meituan.com/mysql-index.html</a></p>\n<p>[8] [译文]MySQL发生死锁肿么办？</p>\n<p><a href=\"http://www.10tiao.com/html/672/201612/2653929751/1.html\" target=\"_blank\" rel=\"nofollow\">http://www.10tiao.com/html/672/201612/2653929751/1.html</a></p>\n<p>[9] MySQL的timeout那点事</p>\n<p><a href=\"http://www.penglixun.com/tech/database/mysql_timeout.html\" target=\"_blank\" rel=\"nofollow\">http://www.penglixun.com/tech/database/mysql_timeout.html</a></p>\n<p>[10] mysql死锁(deadlock)分析及解决 （索引 间隙锁 sql顺序）</p>\n<p><a href=\"http://www.youyong.top/article/1158d0e3bcf\" target=\"_blank\" rel=\"nofollow\">http://www.youyong.top/article/1158d0e3bcf</a></p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112054\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112054votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112054\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 3 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "1", "fav_nums": "3", "comment_nums": "", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2015/11/e78e36715813f49e9e62fe0c6050075c.png"]},{"url_object_id": "2e20cef128b8ada5093512d12980db03", "create_date": "2017/07/25", "front_image_path": "full/bbd3c66a3badc127bce3c714ce00a0e73265cc91.jpg", "title": "Facebook 这类网站如何处理数十亿请求并保持高可用性的？", "url": "http://blog.jobbole.com/111996/", "tags": "IT技术,Web,负载均衡", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文由 <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/snowhere\">孙腾浩</a> 翻译。未经许可，禁止转载！<br>英文出处：<a target=\"_blank\" href=\"https://blog.vivekpanyam.com/scaling-a-web-service-load-balancing/\">Vivek Panyam</a>。欢迎加入<a target=\"_blank\" href=\"http://group.jobbole.com/category/feedback/trans-team/\">翻译组</a>。</div><p>Facebook 这类网站如何处理数十亿请求并保持高可用性呢，答案是负载均衡，本文将对其一探究竟。</p>\n<h3>什么是负载均衡</h3>\n<p>负载均衡是许多协同工作资源（通常是计算机）的分配策略。它们通常用于提高容量和可靠性。</p>\n<p>为了便于讨论负载均衡，对于服务扩展我假设以下两点：</p>\n<ul>\n<li>我可以运行任意数量实例</li>\n<li>任何请求可以到达任意实例</li>\n</ul>\n<p>第一个假设表明服务是无状态的（或者像 Redis 集群一样可以共享状态）。第二个假设实际中并不是必须的（比如粘性负载均衡），但在这片文章中做这样的假设便于讨论。</p>\n<p>下面是我将要讨论的负载均衡技术：</p>\n<ol>\n<li>应用层（OSI 第七层）负载均衡（HTTP、HTTPS、WS）</li>\n<li>传输层（OSI 第四层）负载均衡（TCP、UDP）</li>\n<li>网络层（OSI 第三层）负载均衡</li>\n<li>DNS 负载均衡</li>\n<li>多个子域手动负载均衡</li>\n<li>任播（Anycast）</li>\n</ol>\n<p>最后还有一些其他知识点：</p>\n<ul>\n<li>延迟和吞吐量</li>\n<li>服务器直接返回</li>\n</ul>\n<p>这些技术大致按照「网站流量增大时需要的操作步骤」排序。比如，应用层的负载均衡是首先要做的事（远远早于任播）。前三条技术提高吞吐量和可用性，但存在单点故障。其余的三条技术在提高吞吐量的同时避免了单点故障。</p>\n<p>为了帮助我们理解负载均衡，我们来看一个简单的服务扩展。</p>\n<p>注意：每种扩展技术都采用了非技术的比喻（在商店购物）。这些比喻仅仅是描述技术背后的思想，并不完全准确。</p>\n<h3>服务</h3>\n<p>我们假设我们正在构建大规模的服务。就像下图所示：</p>\n<p><img class=\"aligncenter\" src=\"https://blog.vivekpanyam.com/content/images/2016/02/Service-1.png\" alt=\"\"></p>\n<p>这个系统并不能处理大量通信，并且如果它宕机，整个应用就停了。</p>\n<h4>比喻：</h4>\n<ul>\n<li>你走向商店唯一一条结账的队伍。</li>\n<li>你购买你的商品，如果那里没有收银员，你无法完成购买。</li>\n</ul>\n<h3>应用层（OSI 第七层）负载均衡</h3>\n<p>为了承载更大的通信量，首先用到的就是应用层负载均衡。应用层是 OSI 第七层。它包括 HTTP、HTTPS 和 WebSockets。一款非常流行又久经考验的应用层负载均衡器就是 Nginx。让我们看看它如何帮助我们扩展服务：</p>\n<p><img src=\"https://blog.vivekpanyam.com/content/images/2016/02/L7LB.png\" alt=\"\"></p>\n<p>请注意，通过这种技术，我们能负载均衡数十或上百服务器实例。上面图片只展示两个作为例子。</p>\n<h4>比喻</h4>\n<ul>\n<li>商店员工引领你到一个特别的（有收银员的）结账队伍</li>\n<li>你购买你的商品</li>\n</ul>\n<h4>工具：</h4>\n<ul>\n<li>Nginx</li>\n<li>HAProxy</li>\n</ul>\n<h4>注意：</h4>\n<ul>\n<li>我们要在这里停止使用 SSL（分发时不用 SSL)</li>\n</ul>\n<h3>传输层（OSI 第四层）负载均衡（TCP、UDP）</h3>\n<p>上一条技术帮助我们承载大量通信，但如果我们需要承载更大的通信量，传输层负载均衡非常有用。传输层是 OSI 第四层，包括 TCP 和 UDP。流行的传输层负载均衡器有 HAProxy（这个也用于应用层负载均衡）和 IPVS。让我们看看它们如何帮助我们扩展服务：</p>\n<p><img src=\"https://blog.vivekpanyam.com/content/images/2016/02/L4LB.png\" alt=\"\"></p>\n<p>应用层负载均衡+传输层负载均衡能处理大多数情况下的通信量。然而我们我们仍要担心可用性。单点故障有可能出现在传输层的负载均衡器。我们在下面一节的 DNS 负载均衡解决这个问题。</p>\n<h4>比喻：</h4>\n<ul>\n<li>根据客户会员卡卡号有不同结账区域。举个例子，如果你的会员卡卡号是偶数，去电器区附近的结账台，否则就去食品区附近的结账台。</li>\n<li>一旦你到达正确的结账区域，商店员工引领你到一个特别的结账队伍</li>\n<li>你购买你的商品</li>\n</ul>\n<h4>工具：</h4>\n<ul>\n<li>HAProxy</li>\n<li>IPVS</li>\n</ul>\n<h3>网络层（OSI 第三层）负载均衡</h3>\n<p>如果我们要继续扩展，我们需要增加网络层负载均衡。这比上面两条技术更复杂。网络层是 OSI 第三层，包括 IPv4 和 IPv6。下面是网络层负载均衡：</p>\n<p><img src=\"https://blog.vivekpanyam.com/content/images/2016/02/L3LB.png\" alt=\"\"></p>\n<p>为了搞清楚它如何工作，我们需要一点等价路由的知识（ECMP）。当有多条等价链路到达相同地址时，我们使用等价路由。简单来说，它允许路由器或交换机通过不同链接发送数据包（支持高吞吐量），最终到达同一地址。</p>\n<p>我们可以利用这一点来实现网络层负载均衡，因为在我们看来，每个传输层负载均衡器是相同的。这意味着我们可以把从网络层负载均衡器到传输层负载均衡器的链接看做相同目的地的链路。如果我们把所有负载均衡器绑定到相同 IP 地址，我们可以使用等价路由在传输层负载均衡器之间分配通信。</p>\n<h4>比喻：</h4>\n<ul>\n<li>街对面有两家彼此分开却又一模一样的商店，你去哪一家完全取决于你的习惯。</li>\n<li>一旦你到达了商店，根据客户会员卡卡号有不同结账区域。举个例子，如果你的会员卡卡号是偶数，去电器区附近的结账台，否则就去食品区附近的结账台。</li>\n<li>一旦你到达正确的结账区域，商店员工引领你到一个特别的结账队伍</li>\n<li>你购买你的商品</li>\n</ul>\n<h4>工具：</h4>\n<ul>\n<li>通常在机柜里交换机内部的硬件中处理。</li>\n</ul>\n<h4>太长不阅：</h4>\n<ul>\n<li>除非你的服务规模相当大或有自己的硬件，否则你不需要它。</li>\n</ul>\n<h3>DNS 负载均衡</h3>\n<p>DNS 是将名称转换为 IP 地址的系统。举个例子，它可以把 example.com 转换为 93.184.216.34 。它当然也可以返回多个 IP 地址，像下面这样：</p>\n<p><img class=\"aligncenter\" src=\"https://blog.vivekpanyam.com/content/images/2016/02/Screen-Shot-2016-02-04-at-3-25-32-AM.png\" alt=\"\"></p>\n<p>如果返回了多个 IP，客户端通常会使用第一个可用的地址（然而一些应用只看第一个返回的 IP）。</p>\n<p>目前有很多 DNS 负载均衡技术，比如 GeoDNS 和轮询调度（round-robin）。GeoDNS 基于不同请求者而返回不同响应。这让我们可以将客户端路由到其最近的服务器或数据中心。轮询调度会循环所有可用的 IP 地址，对于每个响应会返回不同的 IP。如果多个 IP 可用，这两种技术仅仅改变响应里的 IP 顺序。</p>\n<p>下图展示 DNS 负载均衡如何工作：</p>\n<p><img src=\"https://blog.vivekpanyam.com/content/images/2016/02/DNS.png\" alt=\"\"></p>\n<p>在这个例子中，不同的用户被路由到不同的服务集群（随机或基于地理位置）。</p>\n<p>现在这里不再有单点故障的可能性（假设有多台 DNS 服务器）。为了进一步提高可靠性，我们可以在不同数据中心运行多个服务集群。</p>\n<h4>比喻：</h4>\n<ul>\n<li>你在网上查询购物中心，返回的列表把最近的购物中心放在第一个。你查看通往每个购物中心的路，然后选择列表中第一个营业的购物中心。</li>\n<li>街对面有两家彼此分开却又一模一样的商店，你去哪一家完全取决于你的习惯。</li>\n<li>一旦你到达了商店，根据客户会员卡卡号有不同结账区域。举个例子，如果你的会员卡卡号是偶数，去电器区附近的结账台，否则就去食品区附近的结账台。</li>\n<li>一旦你到达正确的结账区域，商店员工引领你到一个特别的结账队伍</li>\n<li>你购买你的商品</li>\n</ul>\n<h3>手动负载均衡和路由</h3>\n<p>如果你的内容在许多数据中心或服务间共享，而我们需要路由到其中特定的一个，那么这条技术就很有用了。比如 <code>cat.jpg</code> 储存在伦敦的集群中，但其他集群中没有。相似的，<code>dog.jpg</code> 储存在纽约的集群中，其他数据中心或集群中没有。举个例子，这很可能发生在内容刚刚上传，还未在数据中心之间复制的时候。</p>\n<p>然而，用户获取内容时不应该等待复制完成。这意味着我们的应用需要临时把所有 <code>cat.jpg</code> 请求发送到伦敦，所有 <code>dog.jpg</code> 请求发送到纽约。所以我们需要用 <code>https://lon-1e.static.example.net/cat.jpg</code> 代替 <code>https://cdn.example.net/cat.jpg</code>。对 <code>dog.jpg</code> 来说也一样。</p>\n<p>为了实现这一点，我们需要为每个数据中心设置子域（最好细分到每个集群每台机器）。除了上面的 DNS 负载均衡，这一点也很有必要。</p>\n<p>注意：我们的应用需要保持追踪内容的位置，以便重写请求。</p>\n<h4>比喻：</h4>\n<ul>\n<li>你拨打公司电话询问哪个购物中心提供猫粮。</li>\n<li>你查看列表上的购物中心路线，然后选择第一个营业的。</li>\n<li>街对面有两家彼此分开却又一模一样的商店，你去哪一家完全取决于你的习惯。</li>\n<li>一旦你到达了商店，根据客户会员卡卡号有不同结账区域。举个例子，如果你的会员卡卡号是偶数，去电器区附近的结账台，否则就去食品区附近的结账台。</li>\n<li>一旦你到达正确的结账区域，商店员工引领你到一个特别的结账队伍</li>\n<li>你购买你的商品</li>\n</ul>\n<h3>任播（Anycast）</h3>\n<p>这篇文章讨论的最后一种技术就是任播。首先来看一点背景知识：</p>\n<p>大多数网路使用单播。这本质上意味着每台计算机拥有独一无二的 IP 地址。有另一种称为任播的理论。通过任播，一些机器可以使用相同的 IP 地址和路由，并把请求发送到最近的一台机器。我们可以把这种技术和上面所讲的技术结合起来，构建出高可靠性和可用性，能承载巨大通信量的系统。</p>\n<p>任播根本上来说是允许互联网为我们处理部分负载均衡。</p>\n<h4>比喻：</h4>\n<ul>\n<li>你告诉别人你打算去商店，他们把你带到最近的位置。</li>\n<li>街对面有两家彼此分开却又一模一样的商店，你去哪一家完全取决于你的习惯。</li>\n<li>一旦你到达了商店，根据客户会员卡卡号有不同结账区域。举个例子，如果你的会员卡卡号是偶数，去电器区附近的结账台，否则就去食品区附近的结账台。</li>\n<li>一旦你到达正确的结账区域，商店员工引领你到一个特别的结账队伍</li>\n<li>你购买你的商品</li>\n</ul>\n<h3>杂项</h3>\n<h4>延迟和吞吐量</h4>\n<p>顺便一提的是，这些技术也可以提升低延迟服务的吞吐量。增加服务数量而不是让每个服务处理更多的通信。这样我们就可以得到低延迟、高吞吐量的系统。</p>\n<h4>服务器直接返回</h4>\n<p>在传统负载均衡系统中，请求穿过负载均衡的所有层级，响应也同样穿过它们。降低负载均衡通信量的一个优化点就是服务器直接返回。这意味着服务端的响应不通过负载均衡。如果服务端的响应十分巨大，这点尤其有用。</p>\n\r\n        \r\n            <blockquote class=\"rewards\">\n        <p><strong>打赏支持我翻译更多好文章，谢谢！</strong></p>\n        <a href=\"#rewardbox\" id=\"rewards-button\" class=\"fancybox\"><span class=\"btn-bluet-blue href-style\"><i class=\"fa fa-jpy\"></i> 打赏译者</span></a>\n    </blockquote>\n\n    <div id=\"rewardbox\">\n        <h4>打赏支持我翻译更多好文章，谢谢！</h4>\n                <p>任选一种支付方式</p>\n                <p>\n                        <img src=\"http://jbcdn2.b0.upaiyun.com/2017/01/5085cce1bd4e144b7d148079a34b20c1.jpg\">\n            \n                            <img src=\"http://jbcdn2.b0.upaiyun.com/2017/01/02b09a29fdb3ab5fe03d4bd1afe95664.jpg\">\n                    </p>\n    </div>\n\n    \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"111996\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"111996votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"111996\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 6 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 1 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/snowhere\">孙腾浩</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/snowhere\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2017/06/47765e50cfb7c4e598e72d893ab4f62f.jpg\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            毕业于郑州大学软件工程专业，身为 Java 程序猿却同样热爱着 JavaScript 。为了兴趣而写代码，做自己喜欢做的事。Keep coding ... Stay Cool ...        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/snowhere\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/snowhere/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/snowhere/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 17</a> · <a title=\"我的网站\" target=\"_blank\" href=\"http://snowhere.me/\"><i class=\"fa fa-link\"></i></a> <a title=\"GitHub主页\" target=\"_blank\" href=\"https://github.com/Snowhere/\"><i class=\"fa fa-github\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "1", "fav_nums": "6", "comment_nums": "1", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2015/03/912be8d20ca700194c3aced111cc833d1.jpg"]},{"url_object_id": "8e038afd8794ddc5ae01ab185cacbf44", "create_date": "2017/08/02", "front_image_path": "full/d3d1a5ad957de059084690efae6fdfaa3527e1c3.jpg", "title": "使用 Kdump 检查 Linux 内核崩溃", "url": "http://blog.jobbole.com/112099/", "tags": "IT技术,dump,Linux", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"https://opensource.com/article/17/6/kdump-usage-and-internals\">opensource</a>   译文出处：<a target=\"_blank\" href=\"https://linux.cn/article-8737-1.html\">Linux中国/firmianay</a>   </div><div>\n<blockquote><p>让我们先看一下 kdump 的基本使用方法，和 kdump/kexec 在内核中是如何实现。</p></blockquote>\n<p><a href=\"https://www.kernel.org/doc/Documentation/kdump/kdump.txt\">kdump</a> 是获取崩溃的 Linux 内核转储的一种方法，但是想找到解释其使用和内部结构的文档可能有点困难。在本文中，我将研究 kdump 的基本使用方法，和 kdump/kexec 在内核中是如何实现。</p>\n<p><a href=\"https://linux.die.net/man/8/kexec\">kexec</a> 是一个 Linux 内核到内核的引导加载程序，可以帮助从第一个内核的上下文引导到第二个内核。kexec 会关闭第一个内核，绕过 BIOS 或固件阶段，并跳转到第二个内核。因此，在没有 BIOS 阶段的情况下，重新启动变得更快。</p>\n<p>kdump 可以与 kexec 应用程序一起使用 —— 例如，当第一个内核崩溃时第二个内核启动，第二个内核用于复制第一个内核的内存转储，可以使用 <span style=\"color: #ff6600;\"><code>gdb</code></span> 和 <span style=\"color: #ff6600;\"><code>crash</code></span> 等工具分析崩溃的原因。（在本文中，我将使用术语“第一内核”作为当前运行的内核，“第二内核” 作为使用 kexec 运行的内核，“捕获内核” 表示在当前内核崩溃时运行的内核。）</p>\n<p>kexec 机制在内核以及用户空间中都有组件。内核提供了几个用于 kexec 重启功能的系统调用。名为 kexec-tools 的用户空间工具使用这些调用，并提供可执行文件来加载和引导“第二内核”。有的发行版还会在 kexec-tools 上添加封装器，这有助于捕获并保存各种转储目标配置的转储。在本文中，我将使用名为 distro-kexec-tools 的工具来避免上游 kexec 工具和特定于发行版的 kexec-tools 代码之间的混淆。我的例子将使用 Fedora Linux 发行版。</p>\n<h3 id=\"toc_1\">Fedora kexec-tools 工具</h3>\n<p>使用 <span style=\"color: #ff6600;\"><code>dnf install kexec-tools</code></span> 命令在 Fedora 机器上安装 fedora-kexec-tools。在安装 fedora-kexec-tools 后可以执行 <span style=\"color: #ff6600;\"><code>systemctl start kdump</code></span> 命令来启动 kdump 服务。当此服务启动时，它将创建一个根文件系统（initramfs），其中包含了要挂载到目标位置的资源，以保存 vmcore，以及用来复制和转储 vmcore 到目标位置的命令。然后，该服务将内核和 initramfs 加载到崩溃内核区域内的合适位置，以便在内核崩溃时可以执行它们。</p>\n<p>Fedora 封装器提供了两个用户配置文件：</p>\n<ol>\n<li><span style=\"color: #ff6600;\"><code>/etc/kdump.conf</code></span> 指定修改后需要重建 initramfs 的配置参数。例如，如果将转储目标从本地磁盘更改为 NFS 挂载的磁盘，则需要由“捕获内核”所加载的 NFS 相关的内核模块。</li>\n<li><span style=\"color: #ff6600;\"><code>/etc/sysconfig/kdump</code></span> 指定修改后不需要重新构建 initramfs 的配置参数。例如，如果只需修改传递给“捕获内核”的命令行参数，则不需要重新构建 initramfs。</li>\n</ol>\n<p>如果内核在 kdump 服务启动之后出现故障，那么“捕获内核”就会执行，其将进一步执行 initramfs 中的 vmcore 保存过程，然后重新启动到稳定的内核。</p>\n<h3 id=\"toc_2\">kexec-tools 工具</h3>\n<p>编译 kexec-tools 的源代码得到了一个名为 <span style=\"color: #ff6600;\"><code>kexec</code></span> 的可执行文件。这个同名的可执行文件可用于加载和执行“第二内核”，或加载“捕获内核”，它可以在内核崩溃时执行。</p>\n<p>加载“第二内核”的命令：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5986c58425717106903745\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n# kexec -l kernel.img --initrd=initramfs-image.img –reuse-cmdline</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5986c58425717106903745-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5986c58425717106903745-1\"><span class=\"crayon-p\"># kexec -l kernel.img --initrd=initramfs-image.img –reuse-cmdline</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p><span style=\"color: #ff6600;\"><code>--reuse-command</code></span> 参数表示使用与“第一内核”相同的命令行。使用 <span style=\"color: #ff6600;\"><code>--initrd</code></span> 传递 initramfs。 <span style=\"color: #ff6600;\"><code>-l</code></span> 表明你正在加载“第二内核”，其可以由 <span style=\"color: #ff6600;\"><code>kexec</code></span> 应用程序本身执行（<span style=\"color: #ff6600;\"><code>kexec -e</code></span>）。使用 <span style=\"color: #ff6600;\"><code>-l</code></span> 加载的内核不能在内核崩溃时执行。为了加载可以在内核崩溃时执行的“捕获内核”，必须传递参数 <span style=\"color: #ff6600;\"><code>-p</code></span> 取代 <span style=\"color: #ff6600;\"><code>-l</code></span>。</p>\n<p>加载捕获内核的命令：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5986c58425721253962722\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n# kexec -p kernel.img --initrd=initramfs-image.img –reuse-cmdline</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5986c58425721253962722-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5986c58425721253962722-1\"><span class=\"crayon-p\"># kexec -p kernel.img --initrd=initramfs-image.img –reuse-cmdline</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p><span style=\"color: #ff6600;\"><code>echo c &gt; /pros/sysrq-trigger</code></span> 可用于使内核崩溃以进行测试。有关 kexec-tools 提供的选项的详细信息，请参阅 <span style=\"color: #ff6600;\"><code>man kexec</code></span>。在转到下一个部分之前，请看这个 kexec_dump 的演示：</p>\n<p style=\"text-align: center;\"><a href=\"https://v.qq.com/x/page/k0531jsbps7.html\" target=\"_blank\">https://v.qq.com/x/page/k0531jsbps7.html</a></p>\n<h3 id=\"toc_3\">kdump: 端到端流</h3>\n<p>下图展示了流程图。必须在引导“第一内核”期间为捕获内核保留 crashkernel 的内存。您可以在内核命令行中传递 <span style=\"color: #ff6600;\"><code>crashkernel=Y@X</code></span>，其中 <span style=\"color: #ff6600;\"><code>@X</code></span> 是可选的。<span style=\"color: #ff6600;\"><code>crashkernel=256M</code></span> 适用于大多数 x86_64 系统；然而，为崩溃内核选择适当的内存取决于许多因素，如内核大小和 initramfs，以及 initramfs 中包含的模块和应用程序运行时的内存需求。有关传递崩溃内核参数的更多方法，请参阅 <a href=\"https://github.com/torvalds/linux/blob/master/Documentation/admin-guide/kernel-parameters.txt\">kernel-parameters 文档</a>。</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/08/673c86f0c1d5d2c8ade8526b1370a25f.png\" alt=\"pratyush_f1.png\"></p>\n<p>您可以将内核和 initramfs 镜像传递给 <span style=\"color: #ff6600;\"><code>kexec</code></span> 可执行文件，如（<span style=\"color: #ff6600;\"><code>kexec-tools</code></span>）部分的命令所示。“捕获内核”可以与“第一内核”相同，也可以不同。通常，一样即可。Initramfs 是可选的；例如，当内核使用 <span style=\"color: #ff6600;\"><code>CONFIG_INITRAMFS_SOURCE</code></span> 编译时，您不需要它。通常，从第一个 initramfs 中保存一个不一样的捕获 initramfs，因为在捕获 initramfs 中自动执行 vmcore 的副本能获得更好的效果。当执行 <span style=\"color: #ff6600;\"><code>kexec</code></span> 时，它还加载了 <span style=\"color: #ff6600;\"><code>elfcorehdr</code></span> 数据和 purgatory 可执行文件（LCTT 译注：purgatory 就是一个引导加载程序，是为 kdump 定作的。它被赋予了“炼狱”这样一个古怪的名字应该只是一种调侃）。 <span style=\"color: #ff6600;\"><code>elfcorehdr</code></span> 具有关于系统内存组织的信息，而 purgatory 可以在“捕获内核”执行之前执行并验证第二阶段的二进制或数据是否具有正确的 SHA。purgatory 也是可选的。</p>\n<p>当“第一内核”崩溃时，它执行必要的退出过程并切换到 purgatory（如果存在）。purgatory 验证加载二进制文件的 SHA256，如果是正确的，则将控制权传递给“捕获内核”。“捕获内核”根据从 <span style=\"color: #ff6600;\"><code>elfcorehdr</code></span> 接收到的系统内存信息创建 vmcore。因此，“捕获内核”启动后，您将看到 <span style=\"color: #ff6600;\"><code>/proc/vmcore</code></span> 中“第一内核”的转储。根据您使用的 initramfs，您现在可以分析转储，将其复制到任何磁盘，也可以是自动复制的，然后重新启动到稳定的内核。</p>\n<h3 id=\"toc_4\">内核系统调用</h3>\n<p>内核提供了两个系统调用：<span style=\"color: #ff6600;\"><code>kexec_load()</code></span> 和 <span style=\"color: #ff6600;\"><code>kexec_file_load()</code></span>，可以用于在执行 <span style=\"color: #ff6600;\"><code>kexec -l</code></span> 时加载“第二内核”。它还为 <span style=\"color: #ff6600;\"><code>reboot()</code></span> 系统调用提供了一个额外的标志，可用于使用 <span style=\"color: #ff6600;\"><code>kexec -e</code></span> 引导到“第二内核”。</p>\n<p><span style=\"color: #ff6600;\"><code>kexec_load()</code></span>：<span style=\"color: #ff6600;\"><code>kexec_load()</code></span> 系统调用加载一个可以在之后通过 <span style=\"color: #ff6600;\"><code>reboot()</code></span> 执行的新的内核。其原型定义如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5986c58425727079325752\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nlong kexec_load(unsigned long entry, unsigned long nr_segments,\r\nstruct kexec_segment *segments, unsigned long flags);</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5986c58425727079325752-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5986c58425727079325752-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5986c58425727079325752-1\"><span class=\"crayon-t\">long</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">kexec_load</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">unsigned</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">long</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">entry</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">unsigned</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">long</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">nr_segments</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5986c58425727079325752-2\"><span class=\"crayon-t\">struct</span><span class=\"crayon-h\"> </span><span class=\"crayon-e \">kexec_segment *</span><span class=\"crayon-v\">segments</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">unsigned</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">long</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">flags</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0009 seconds] -->\r\n<p>用户空间需要为不同的组件传递不同的段，如内核，initramfs 等。因此，<span style=\"color: #ff6600;\"><code>kexec</code></span> 可执行文件有助于准备这些段。<span style=\"color: #ff6600;\"><code>kexec_segment</code></span> 的结构如下所示：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5986c5842572b624157079\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nstruct kexec_segment {\r\n    void *buf;\r\n    /* 用户空间缓冲区 */\r\n    size_t bufsz;\r\n    /* 用户空间中的缓冲区长度 */\r\n    void *mem;\r\n    /* 内核的物理地址 */\r\n    size_t memsz;\r\n    /* 物理地址长度 */\r\n};</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5986c5842572b624157079-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5986c5842572b624157079-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5986c5842572b624157079-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5986c5842572b624157079-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5986c5842572b624157079-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5986c5842572b624157079-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5986c5842572b624157079-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5986c5842572b624157079-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5986c5842572b624157079-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5986c5842572b624157079-10\">10</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5986c5842572b624157079-1\"><span class=\"crayon-t\">struct</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">kexec_segment</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5986c5842572b624157079-2\"><span class=\"crayon-h\">    </span><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-v\">buf</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5986c5842572b624157079-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-c\">/* 用户空间缓冲区 */</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5986c5842572b624157079-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">size_t </span><span class=\"crayon-v\">bufsz</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5986c5842572b624157079-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-c\">/* 用户空间中的缓冲区长度 */</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5986c5842572b624157079-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-v\">mem</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5986c5842572b624157079-7\"><span class=\"crayon-h\">    </span><span class=\"crayon-c\">/* 内核的物理地址 */</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5986c5842572b624157079-8\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">size_t </span><span class=\"crayon-v\">memsz</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5986c5842572b624157079-9\"><span class=\"crayon-h\">    </span><span class=\"crayon-c\">/* 物理地址长度 */</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5986c5842572b624157079-10\"><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0010 seconds] -->\r\n<p>当使用 <span style=\"color: #ff6600;\"><code>LINUX_REBOOT_CMD_KEXEC</code></span> 调用 <span style=\"color: #ff6600;\"><code>reboot()</code></span> 时，它会引导进入由 <span style=\"color: #ff6600;\"><code>kexec_load</code></span> 加载的内核。如果标志 <span style=\"color: #ff6600;\"><code>KEXEC_ON_CRASH</code></span> 被传递给 <span style=\"color: #ff6600;\"><code>kexec_load()</code></span>，则加载的内核将不会使用 <span style=\"color: #ff6600;\"><code>reboot(LINUX_REBOOT_CMD_KEXEC)</code></span> 来启动；相反，这将在内核崩溃中执行。必须定义 <span style=\"color: #ff6600;\"><code>CONFIG_KEXEC</code></span> 才能使用 <span style=\"color: #ff6600;\"><code>kexec</code></span>，并且为 <span style=\"color: #ff6600;\"><code>kdump</code></span> 定义 <span style=\"color: #ff6600;\"><code>CONFIG_CRASH_DUMP</code></span>。</p>\n<p><span style=\"color: #ff6600;\"><code>kexec_file_load()</code></span>：作为用户，你只需传递两个参数（即 <span style=\"color: #ff6600;\"><code>kernel</code></span> 和 <span style=\"color: #ff6600;\"><code>initramfs</code></span>）到 <span style=\"color: #ff6600;\"><code>kexec</code></span> 可执行文件。然后，<span style=\"color: #ff6600;\"><code>kexec</code></span> 从 sysfs 或其他内核信息源中读取数据，并创建所有段。所以使用 <span style=\"color: #ff6600;\"><code>kexec_file_load()</code></span> 可以简化用户空间，只传递内核和 initramfs 的文件描述符。其余部分由内核本身完成。使用此系统调用时应该启用 <span style=\"color: #ff6600;\"><code>CONFIG_KEXEC_FILE</code></span>。它的原型如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5986c5842572f314767549\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nlong kexec_file_load(int kernel_fd, int initrd_fd, unsigned long\r\ncmdline_len, const char __user * cmdline_ptr, unsigned long\r\nflags);</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5986c5842572f314767549-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5986c5842572f314767549-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5986c5842572f314767549-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5986c5842572f314767549-1\"><span class=\"crayon-t\">long</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">kexec_file_load</span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">kernel_fd</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">initrd_fd</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">unsigned</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">long</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5986c5842572f314767549-2\"><span class=\"crayon-v\">cmdline_len</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">char</span><span class=\"crayon-h\"> </span><span class=\"crayon-e \">__user *</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">cmdline_ptr</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">unsigned</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">long</span></div><div class=\"crayon-line\" id=\"crayon-5986c5842572f314767549-3\"><span class=\"crayon-v\">flags</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0011 seconds] -->\r\n<p>请注意，<span style=\"color: #ff6600;\"><code>kexec_file_load</code></span> 也可以接受命令行，而 <span style=\"color: #ff6600;\"><code>kexec_load()</code></span> 不行。内核根据不同的系统架构来接受和执行命令行。因此，在 <span style=\"color: #ff6600;\"><code>kexec_load()</code></span> 的情况下，<span style=\"color: #ff6600;\"><code>kexec-tools</code></span> 将通过其中一个段（如在 dtb 或 ELF 引导注释等）中传递命令行。</p>\n<p>目前，<span style=\"color: #ff6600;\"><code>kexec_file_load()</code></span> 仅支持 x86 和 PowerPC。</p>\n<h4 id=\"toc_5\">当内核崩溃时会发生什么</h4>\n<p>当第一个内核崩溃时，在控制权传递给 purgatory 或“捕获内核”之前，会执行以下操作：</p>\n<ul>\n<li>准备 CPU 寄存器（参见内核代码中的 <span style=\"color: #ff6600;\"><code>crash_setup_regs()</code></span>）;</li>\n<li>更新 vmcoreinfo 备注（请参阅 <span style=\"color: #ff6600;\"><code>crash_save_vmcoreinfo()</code></span>）;</li>\n<li>关闭非崩溃的 CPU 并保存准备好的寄存器（请参阅 <span style=\"color: #ff6600;\"><code>machine_crash_shutdown()</code></span> 和 <span style=\"color: #ff6600;\"><code>crash_save_cpu()</code></span>）;</li>\n<li>您可能需要在此处禁用中断控制器；</li>\n<li>最后，它执行 kexec 重新启动（请参阅 <span style=\"color: #ff6600;\"><code>machine_kexec()</code></span>），它将加载或刷新 kexec 段到内存，并将控制权传递给进入段的执行文件。输入段可以是下一个内核的 purgatory 或开始地址。</li>\n</ul>\n<h4 id=\"toc_6\">ELF 程序头</h4>\n<p>kdump 中涉及的大多数转储核心都是 ELF 格式。因此，理解 ELF 程序头部很重要，特别是当您想要找到 vmcore 准备的问题。每个 ELF 文件都有一个程序头：</p>\n<ul>\n<li>由系统加载器读取，</li>\n<li>描述如何将程序加载到内存中，</li>\n<li>可以使用 <span style=\"color: #ff6600;\"><code>Objdump -p elf_file</code></span> 来查看程序头。</li>\n</ul>\n<p>vmcore 的 ELF 程序头的示例如下：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5986c58425734993621602\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n# objdump -p vmcore\r\nvmcore:\r\nfile format elf64-littleaarch64\r\nProgram Header:\r\nNOTE off 0x0000000000010000 vaddr 0x0000000000000000 paddr 0x0000000000000000 align 2**0 filesz\r\n0x00000000000013e8 memsz 0x00000000000013e8 flags ---\r\nLOAD off 0x0000000000020000 vaddr 0xffff000008080000 paddr 0x0000004000280000 align 2**0 filesz\r\n0x0000000001460000 memsz 0x0000000001460000 flags rwx\r\nLOAD off 0x0000000001480000 vaddr 0xffff800000200000 paddr 0x0000004000200000 align 2**0 filesz\r\n0x000000007fc00000 memsz 0x000000007fc00000 flags rwx\r\nLOAD off 0x0000000081080000 vaddr 0xffff8000ffe00000 paddr 0x00000040ffe00000 align 2**0 filesz\r\n0x00000002fa7a0000 memsz 0x00000002fa7a0000 flags rwx\r\nLOAD off 0x000000037b820000 vaddr 0xffff8003fa9e0000 paddr 0x00000043fa9e0000 align 2**0 filesz\r\n0x0000000004fc0000 memsz 0x0000000004fc0000 flags rwx\r\nLOAD off 0x00000003807e0000 vaddr 0xffff8003ff9b0000 paddr 0x00000043ff9b0000 align 2**0 filesz\r\n0x0000000000010000 memsz 0x0000000000010000 flags rwx\r\nLOAD off 0x00000003807f0000 vaddr 0xffff8003ff9f0000 paddr 0x00000043ff9f0000 align 2**0 filesz\r\n0x0000000000610000 memsz 0x0000000000610000 flags rwx</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5986c58425734993621602-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5986c58425734993621602-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5986c58425734993621602-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5986c58425734993621602-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5986c58425734993621602-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5986c58425734993621602-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5986c58425734993621602-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5986c58425734993621602-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5986c58425734993621602-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5986c58425734993621602-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5986c58425734993621602-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5986c58425734993621602-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5986c58425734993621602-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5986c58425734993621602-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5986c58425734993621602-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5986c58425734993621602-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5986c58425734993621602-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5986c58425734993621602-18\">18</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5986c58425734993621602-1\"><span class=\"crayon-p\"># objdump -p vmcore</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5986c58425734993621602-2\"><span class=\"crayon-v\">vmcore</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-5986c58425734993621602-3\"><span class=\"crayon-e\">file </span><span class=\"crayon-e\">format </span><span class=\"crayon-v\">elf64</span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">littleaarch64</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5986c58425734993621602-4\"><span class=\"crayon-e\">Program </span><span class=\"crayon-v\">Header</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-5986c58425734993621602-5\"><span class=\"crayon-e\">NOTE </span><span class=\"crayon-i\">off</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000000010000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">vaddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000000000000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">paddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000000000000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">align</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">filesz</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5986c58425734993621602-6\"><span class=\"crayon-cn\">0x00000000000013e8</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">memsz</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x00000000000013e8</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">flags</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-o\">-</span></div><div class=\"crayon-line\" id=\"crayon-5986c58425734993621602-7\"><span class=\"crayon-e\">LOAD </span><span class=\"crayon-i\">off</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000000020000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">vaddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0xffff000008080000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">paddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000004000280000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">align</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">filesz</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5986c58425734993621602-8\"><span class=\"crayon-cn\">0x0000000001460000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">memsz</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000001460000</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">flags </span><span class=\"crayon-e\">rwx</span></div><div class=\"crayon-line\" id=\"crayon-5986c58425734993621602-9\"><span class=\"crayon-e\">LOAD </span><span class=\"crayon-i\">off</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000001480000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">vaddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0xffff800000200000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">paddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000004000200000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">align</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">filesz</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5986c58425734993621602-10\"><span class=\"crayon-cn\">0x000000007fc00000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">memsz</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x000000007fc00000</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">flags </span><span class=\"crayon-e\">rwx</span></div><div class=\"crayon-line\" id=\"crayon-5986c58425734993621602-11\"><span class=\"crayon-e\">LOAD </span><span class=\"crayon-i\">off</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000081080000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">vaddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0xffff8000ffe00000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">paddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x00000040ffe00000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">align</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">filesz</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5986c58425734993621602-12\"><span class=\"crayon-cn\">0x00000002fa7a0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">memsz</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x00000002fa7a0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">flags </span><span class=\"crayon-e\">rwx</span></div><div class=\"crayon-line\" id=\"crayon-5986c58425734993621602-13\"><span class=\"crayon-e\">LOAD </span><span class=\"crayon-i\">off</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x000000037b820000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">vaddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0xffff8003fa9e0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">paddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x00000043fa9e0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">align</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">filesz</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5986c58425734993621602-14\"><span class=\"crayon-cn\">0x0000000004fc0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">memsz</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000004fc0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">flags </span><span class=\"crayon-e\">rwx</span></div><div class=\"crayon-line\" id=\"crayon-5986c58425734993621602-15\"><span class=\"crayon-e\">LOAD </span><span class=\"crayon-i\">off</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x00000003807e0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">vaddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0xffff8003ff9b0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">paddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x00000043ff9b0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">align</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">filesz</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5986c58425734993621602-16\"><span class=\"crayon-cn\">0x0000000000010000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">memsz</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000000010000</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">flags </span><span class=\"crayon-e\">rwx</span></div><div class=\"crayon-line\" id=\"crayon-5986c58425734993621602-17\"><span class=\"crayon-e\">LOAD </span><span class=\"crayon-i\">off</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x00000003807f0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">vaddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0xffff8003ff9f0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">paddr</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x00000043ff9f0000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">align</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">2</span><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">filesz</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5986c58425734993621602-18\"><span class=\"crayon-cn\">0x0000000000610000</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">memsz</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0x0000000000610000</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">flags </span><span class=\"crayon-v\">rwx</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0051 seconds] -->\r\n<p>在这个例子中，有一个 note 段，其余的是 load 段。note 段提供了有关 CPU 信息，load 段提供了关于复制的系统内存组件的信息。</p>\n<p>vmcore 从 <span style=\"color: #ff6600;\"><code>elfcorehdr</code></span> 开始，它具有与 ELF 程序头相同的结构。参见下图中 <span style=\"color: #ff6600;\"><code>elfcorehdr</code></span> 的表示：</p>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/08/85d3f4c654785d18b750564db21ded7b.png\" alt=\"pratyush_f2.png\"></p>\n<p><span style=\"color: #ff6600;\"><code>kexec-tools</code></span> 读取 <span style=\"color: #ff6600;\"><code>/sys/devices/system/cpu/cpu%d/crash_notes</code></span> 并准备 <span style=\"color: #ff6600;\"><code>CPU PT_NOTE</code></span> 的标头。同样，它读取 <span style=\"color: #ff6600;\"><code>/sys/kernel/vmcoreinfo</code></span> 并准备 <span style=\"color: #ff6600;\"><code>vmcoreinfo PT_NOTE</code></span> 的标头，从 <span style=\"color: #ff6600;\"><code>/proc/iomem</code></span> 读取系统内存并准备存储器 <span style=\"color: #ff6600;\"><code>PT_LOAD</code></span> 标头。当“捕获内核”接收到 <span style=\"color: #ff6600;\"><code>elfcorehdr</code></span> 时，它从标头中提到的地址中读取数据，并准备 vmcore。</p>\n<h4 id=\"toc_7\">Crash note</h4>\n<p>Crash notes 是每个 CPU 中用于在系统崩溃的情况下存储 CPU 状态的区域；它有关于当前 PID 和 CPU 寄存器的信息。</p>\n<h4 id=\"toc_8\">vmcoreinfo</h4>\n<p>该 note 段具有各种内核调试信息，如结构体大小、符号值、页面大小等。这些值由捕获内核解析并嵌入到 <span style=\"color: #ff6600;\"><code>/proc/vmcore</code></span> 中。 <span style=\"color: #ff6600;\"><code>vmcoreinfo</code></span> 主要由 <span style=\"color: #ff6600;\"><code>makedumpfile</code></span> 应用程序使用。在 Linux 内核，<span style=\"color: #ff6600;\"><code>include/linux/kexec.h</code></span> 宏定义了一个新的 <span style=\"color: #ff6600;\"><code>vmcoreinfo</code></span>。 一些示例宏如下所示：</p>\n<ul>\n<li><span style=\"color: #ff6600;\"><code>VMCOREINFO_PAGESIZE()</code></span></li>\n<li><span style=\"color: #ff6600;\"><code>VMCOREINFO_SYMBOL()</code></span></li>\n<li><span style=\"color: #ff6600;\"><code>VMCOREINFO_SIZE()</code></span></li>\n<li><span style=\"color: #ff6600;\"><code>VMCOREINFO_STRUCT_SIZE()</code></span></li>\n</ul>\n<h4 id=\"toc_9\">makedumpfile</h4>\n<p>vmcore 中的许多信息（如可用页面）都没有用处。<span style=\"color: #ff6600;\"><code>makedumpfile</code></span> 是一个用于排除不必要的页面的应用程序，如：</p>\n<ul>\n<li>填满零的页面；</li>\n<li>没有私有标志的缓存页面（非专用缓存）;</li>\n<li>具有私有标志的缓存页面（专用缓存）;</li>\n<li>用户进程数据页；</li>\n<li>可用页面。</li>\n</ul>\n<p>此外，<span style=\"color: #ff6600;\"><code>makedumpfile</code></span> 在复制时压缩 <span style=\"color: #ff6600;\"><code>/proc/vmcore</code></span> 的数据。它也可以从转储中删除敏感的符号信息； 然而，为了做到这一点，它首先需要内核的调试信息。该调试信息来自 <span style=\"color: #ff6600;\"><code>VMLINUX</code></span> 或 <span style=\"color: #ff6600;\"><code>vmcoreinfo</code></span>，其输出可以是 ELF 格式或 kdump 压缩格式。</p>\n<p>典型用法：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5986c5842573a632333654\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n# makedumpfile -l --message-level 1 -d 31 /proc/vmcore makedumpfilecore</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5986c5842573a632333654-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5986c5842573a632333654-1\"><span class=\"crayon-p\"># makedumpfile -l --message-level 1 -d 31 /proc/vmcore makedumpfilecore</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p>详细信息请参阅 <span style=\"color: #ff6600;\"><code>man makedumpfile</code></span>。</p>\n<h3 id=\"toc_10\">kdump 调试</h3>\n<p>新手在使用 kdump 时可能会遇到的问题：</p>\n<h4 id=\"toc_11\"><span style=\"color: #ff6600;\"><code>kexec -p kernel_image</code></span>  没有成功</h4>\n<ul>\n<li>检查是否分配了崩溃内存。</li>\n<li><span style=\"color: #ff6600;\"><code>cat /sys/kernel/kexec_crash_size</code></span> 不应该有零值。</li>\n<li><span style=\"color: #ff6600;\"><code>cat /proc/iomem | grep \"Crash kernel\"</code></span> 应该有一个分配的范围。</li>\n<li>如果未分配，则在命令行中传递正确的 <span style=\"color: #ff6600;\"><code>crashkernel=</code></span> 参数。</li>\n<li>如果没有显示，则在 <span style=\"color: #ff6600;\"><code>kexec</code></span> 命令中传递参数 <span style=\"color: #ff6600;\"><code>-d</code></span>，并将输出信息发送到 kexec-tools 邮件列表。</li>\n</ul>\n<h4 id=\"toc_12\">在“第一内核”的最后一个消息之后，在控制台上看不到任何东西（比如“bye”）</h4>\n<ul>\n<li>检查 <span style=\"color: #ff6600;\"><code>kexec -e</code></span> 之后的 <span style=\"color: #ff6600;\"><code>kexec -l kernel_image</code></span> 命令是否工作。</li>\n<li>可能缺少支持的体系结构或特定机器的选项。</li>\n<li>可能是 purgatory 的 SHA 验证失败。如果您的体系结构不支持 purgatory 中的控制台，则很难进行调试。</li>\n<li>可能是“第二内核”早已崩溃。</li>\n<li>将您的系统的 <span style=\"color: #ff6600;\"><code>earlycon</code></span> 或 <span style=\"color: #ff6600;\"><code>earlyprintk</code></span> 选项传递给“第二内核”的命令行。</li>\n<li>使用 kexec-tools 邮件列表共享第一个内核和捕获内核的 <span style=\"color: #ff6600;\"><code>dmesg</code></span> 日志。</li>\n</ul>\n<h3 id=\"toc_13\">资源</h3>\n<h4 id=\"toc_14\">fedora-kexec-tools</h4>\n<ul>\n<li>GitHub 仓库：<span style=\"color: #ff6600;\"><code>git://pkgs.fedoraproject.org/kexec-tools</code></span></li>\n<li>邮件列表：<a href=\"mailto:kexec@lists.fedoraproject.org\">kexec@lists.fedoraproject.org</a></li>\n<li>说明：Specs 文件和脚本提供了用户友好的命令和服务，以便 <span style=\"color: #ff6600;\"><code>kexec-tools</code></span> 可以在不同的用户场景下实现自动化。</li>\n</ul>\n<h4 id=\"toc_15\">kexec-tools</h4>\n<ul>\n<li>GitHub 仓库：git://git.kernel.org/pub/scm/utils/kernel/kexec/kexec-tools.git</li>\n<li>邮件列表：<a href=\"mailto:kexec@lists.infradead.org\">kexec@lists.infradead.org</a></li>\n<li>说明：使用内核系统调用并提供用户命令 <span style=\"color: #ff6600;\"><code>kexec</code></span>。</li>\n</ul>\n<h4 id=\"toc_16\">Linux kernel</h4>\n<ul>\n<li>GitHub 仓库： <span style=\"color: #ff6600;\"><code>git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git</code></span></li>\n<li>邮件列表：<a href=\"mailto:kexec@lists.infradead.org\">kexec@lists.infradead.org</a></li>\n<li>说明：实现了 <span style=\"color: #ff6600;\"><code>kexec_load()</code></span>、<span style=\"color: #ff6600;\"><code>kexec_file_load()</code></span>、<span style=\"color: #ff6600;\"><code>reboot()</code></span> 系统调用和特定体系结构的代码，例如 <span style=\"color: #ff6600;\"><code>machine_kexec()</code></span> 和 <span style=\"color: #ff6600;\"><code>machine_crash_shutdown()</code></span>。</li>\n</ul>\n<h4 id=\"toc_17\">Makedumpfile</h4>\n<ul>\n<li>GitHub 仓库： <span style=\"color: #ff6600;\"><code>git://git.code.sf.net/p/makedumpfile/code</code></span></li>\n<li>邮件列表：<a href=\"mailto:kexec@lists.infradead.org\">kexec@lists.infradead.org</a></li>\n<li>说明：从转储文件中压缩和过滤不必要的组件。</li>\n</ul>\n<p>（题图：<a href=\"https://pixabay.com/en/penguins-emperor-antarctic-life-429136/\">Penguin</a>、 <a href=\"https://pixabay.com/en/shoe-boots-home-boots-house-1519804/\">Boot</a>，修改：Opensource.com. <a href=\"https://creativecommons.org/licenses/by-sa/4.0/\">CC BY-SA 4.0</a>）</p>\n<hr>\n<p>作者简介：</p>\n<p>Pratyush Anand – Pratyush 正在以以为 Linux 内核专家的身份与 Red Hat 合作。他主要负责 Red Hat 产品和上游所面临的几个 kexec/kdump 问题。他还处理 Red Hat 支持的 ARM64 平台周围的其他内核调试、跟踪和性能问题。除了 Linux 内核，他还在上游的 kexec-tools 和 makedumpfile 项目中做出了贡献。他是一名开源爱好者，并在教育机构举办志愿者讲座，促进了 FOSS。</p>\n</div>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112099\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112099votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112099\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "1", "fav_nums": "", "comment_nums": "", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2016/11/59d49abe8909a122bc2c9aa43b71e3bb.png"]},{"url_object_id": "b028ca4da8b8f6fe667bdfe6cff6be5d", "create_date": "2017/08/03", "front_image_path": "full/9a6b1eab17892544dfe9124f1a91b9757cf15bc5.jpg", "title": "C++17 中那些值得关注的特性", "url": "http://blog.jobbole.com/112106/", "tags": "C/C++,C++", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"http://www.iteye.com/news/32574\">祁宇（首发《程序员》杂志）</a>   </div><div id=\"news_content\">\n<h1><strong>引用</strong></h1>\n<p>C++17标准在2017上半年已经讨论确定，正在形成ISO标准文档，今年晚些时候会正式发布。本文将介绍最新标准中值得开发者关注的新特新和基本用法。</p>\n<p>总的来说C++17相比C++11的新特性来说新特性不算多，做了一些小幅改进。C++17增加了数十项新特性，值得关注的特性大概有下面这些：</p>\n<ul>\n<li>constexpr if</li>\n<li>constexpr lambda</li>\n<li>fold expression</li>\n<li>void_t</li>\n<li>structured binding</li>\n<li>std::apply, std::invoke</li>\n<li>string_view</li>\n<li>parallel STL</li>\n<li>inline variable</li>\n</ul>\n<p>剩下的有一些来自于boost库，比如variant,any、optional和filesystem等特性，string_view其实在boost里也有。还有一些是语法糖，比如if init、deduction guide、guaranteed copy Elision、template、nested namespace、single param static_assert等特性。我接下来会介绍C++17主要的一些特性，介绍它们的基本用法和作用，让读者对C++17的新特性有一个基本的了解。</p>\n<h1><strong>fold expression</strong></h1>\n<p>C++11增加了一个新特性可变模版参数（variadic template）,它可以接受任意个模版参数在参数包中，参数包是三个点…，它不能直接展开，需要通过一些特殊的方法才能展开，导致在使用的时候有点难度。现在C++17解决了这个问题，让参数包的展开变得容易了，Fold expression就是方便展开参数包的。</p>\n<p><strong>fold expression的语义</strong></p>\n<p>fold expression有4种语义：</p>\n<ul>\n<li>unary right fold (pack op …)</li>\n<li>unary left fold (… op pack)</li>\n<li>binary right fold (pack op … op init)</li>\n<li>binary left fold (init op … op pack)</li>\n</ul>\n<p>其中pack代表变参，比如args，op代表操作符，fold expression支持32种操作符：</p>\n<p><strong>引用</strong></p>\n</div>\n<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc0880893152667\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n+ - * / % ^ &amp; | = &gt; += -= *= /= %= ^= &amp;= |= &gt;= == != = &amp;&amp; || , .* -&gt;*</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc0880893152667-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc0880893152667-1\"><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">%</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">^</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">*=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">%=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">^=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&gt;=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">!=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">||</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-&gt;</span><span class=\"crayon-o\">*</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0012 seconds] -->\r\n<p></p>\n<h1><strong>unary right fold的含义</strong></h1>\n<p>fold (E op …) 意味着 E1 op (… op (EN-1 op EN)).</p>\n<p>顾名思义，从右边开始fold，看它是left fold还是right fold我们可以根据参数包…所在的位置来判断，当参数包…在操作符右边的时候就是right fold，在左边的时候就是left fold。我们来看一个具体的例子：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc088a185413833\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename... Args&gt;\r\nauto add_val(Args&amp;&amp;... args) {\r\n    return (args +  ...);\r\n}\r\n\r\nauto t = add_val(1,2,3,4); //10</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc088a185413833-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc088a185413833-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc088a185413833-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc088a185413833-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc088a185413833-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc088a185413833-6\">6</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc088a185413833-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc088a185413833-2\"><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">add_val</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc088a185413833-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">args</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\">  </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc088a185413833-4\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc088a185413833-5\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc088a185413833-6\"><span class=\"crayon-i\">auto</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">add_val</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">//10</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p>right fold的过程是这样的：(1+(2+(3+4)))，从右边开始fold。</p>\n<h1><strong>unary left fold的含义</strong></h1>\n<p>fold (… op E) 意味着 ((E1 op E2) op …) op EN。</p>\n<p>对于+这种满足交换律的操作符来说left fold和right fold是一样的，比如上面的例子你也可以写成left fold。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc088f373342885\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename... Args&gt;\r\nauto add_val(Args&amp;&amp;... args) {\r\n    return (... + args);\r\n}\r\n\r\nauto t = add_val(1,2,3,4); //10</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc088f373342885-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc088f373342885-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc088f373342885-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc088f373342885-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc088f373342885-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc088f373342885-6\">6</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc088f373342885-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc088f373342885-2\"><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">add_val</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc088f373342885-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc088f373342885-4\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc088f373342885-5\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc088f373342885-6\"><span class=\"crayon-i\">auto</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">add_val</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">//10</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p>对于不满足交换律的操作符来说就要注意了，比如减法。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc0894246006927\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename... Args&gt;\r\nauto sub_val_right(Args&amp;&amp;... args) {\r\n    return (args - ...);\r\n}\r\n\r\n\r\ntemplate&lt;typename... Args&gt;\r\nauto sub_val_left(Args&amp;&amp;... args) {\r\n    return (... - args);\r\n}\r\n\r\nauto t = sub_val_right(2,3,4); //(2-(3-4)) = 3\r\nauto t1 = sub_val_left(2,3,4); //((2-3)-4) = -5</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc0894246006927-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc0894246006927-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc0894246006927-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc0894246006927-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc0894246006927-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc0894246006927-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc0894246006927-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc0894246006927-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc0894246006927-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc0894246006927-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc0894246006927-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc0894246006927-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc0894246006927-13\">13</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc0894246006927-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc0894246006927-2\"><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">sub_val_right</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc0894246006927-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">args</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc0894246006927-4\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc0894246006927-5\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc0894246006927-6\"> </div><div class=\"crayon-line\" id=\"crayon-5987217fc0894246006927-7\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc0894246006927-8\"><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">sub_val_left</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc0894246006927-9\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc0894246006927-10\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc0894246006927-11\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc0894246006927-12\"><span class=\"crayon-i\">auto</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sub_val_right</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">//(2-(3-4)) = 3</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc0894246006927-13\"><span class=\"crayon-e\">auto </span><span class=\"crayon-v\">t1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sub_val_left</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">,</span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">//((2-3)-4) = -5</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0022 seconds] -->\r\n<p>这次right fold和left fold的结果就不一样。</p>\n<h1><strong>binary fold的含义</strong></h1>\n<p>Binary right fold (E op … op I) 意味着 E1 op (… op (EN-1 op (EN op I)))。</p>\n<p>Binary left fold (I op … op E) 意味着 (((I op E1) op E2) op …) op E2。</p>\n<p>其中E代表变参，比如args，op代表操作符，I代表一个初始变量。</p>\n<p>二元fold的语义和一元fold的语义是相同的，看一个二元操作符的例子：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc0898353377591\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename... Args&gt;\r\nauto sub_one_left(Args&amp;&amp;... args) {\r\n    return (1 - ... - args);\r\n}\r\n\r\ntemplate&lt;typename... Args&gt;\r\nauto sub_one_right(Args&amp;&amp;... args) {\r\n    return (args - ... - 1);\r\n}\r\n\r\nauto t = sub_one_left（2，3，4);// (((1-2)-3)-4) = -8\r\nauto t1 = sub_one_right（2，3，4);//(2-(3-(4-1))) = 2</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc0898353377591-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc0898353377591-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc0898353377591-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc0898353377591-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc0898353377591-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc0898353377591-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc0898353377591-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc0898353377591-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc0898353377591-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc0898353377591-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc0898353377591-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc0898353377591-12\">12</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc0898353377591-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc0898353377591-2\"><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">sub_one_left</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc0898353377591-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc0898353377591-4\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc0898353377591-5\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc0898353377591-6\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc0898353377591-7\"><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">sub_one_right</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc0898353377591-8\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">args</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc0898353377591-9\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc0898353377591-10\"> </div><div class=\"crayon-line\" id=\"crayon-5987217fc0898353377591-11\"><span class=\"crayon-i\">auto</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">sub_one</span><span class=\"crayon-sy\">_</span>left（<span class=\"crayon-cn\">2</span>，<span class=\"crayon-cn\">3</span>，<span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-c\">// (((1-2)-3)-4) = -8</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc0898353377591-12\"><span class=\"crayon-e\">auto </span><span class=\"crayon-v\">t1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">sub_one</span><span class=\"crayon-sy\">_</span>right（<span class=\"crayon-cn\">2</span>，<span class=\"crayon-cn\">3</span>，<span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span><span class=\"crayon-c\">//(2-(3-(4-1))) = 2</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0025 seconds] -->\r\n<p>相信通过这个例子大家应该对C++17的fold expression有了基本的了解。</p>\n<h1><strong>comma fold</strong></h1>\n<p>在C++17之前，我们经常使用逗号表达式和std::initializer_list来将变参一个个传入一个函数。比如像下面这个例子：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc089c092502563\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename T&gt;\r\nvoid print_arg(T t)\r\n{\r\n    std::cout &lt;&lt; t &lt;&lt; std::endl;\r\n}\r\n\r\ntemplate&lt;typename... Args&gt;\r\nvoid print2(Args... args)\r\n{\r\n    //int a[] = { (printarg(args), 0)... };\r\n    std::initializer_list&lt;int&gt;{(print_arg(args), 0)...};\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc089c092502563-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc089c092502563-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc089c092502563-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc089c092502563-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc089c092502563-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc089c092502563-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc089c092502563-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc089c092502563-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc089c092502563-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc089c092502563-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc089c092502563-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc089c092502563-12\">12</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc089c092502563-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc089c092502563-2\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">print_arg</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc089c092502563-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc089c092502563-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">cout</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">endl</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc089c092502563-5\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc089c092502563-6\"> </div><div class=\"crayon-line\" id=\"crayon-5987217fc089c092502563-7\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc089c092502563-8\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">print2</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc089c092502563-9\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc089c092502563-10\"><span class=\"crayon-h\">    </span><span class=\"crayon-c\">//int a[] = { (printarg(args), 0)... };</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc089c092502563-11\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">initializer_list</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">int</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">{</span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">print_arg</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc089c092502563-12\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0018 seconds] -->\r\n<p>这种写法比较繁琐，用fold expression就会变得很简单了。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc089f864214729\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename... Args&gt;\r\nvoid print3(Args... args)\r\n{\r\n    (print_arg(args), ...);\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc089f864214729-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc089f864214729-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc089f864214729-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc089f864214729-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc089f864214729-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc089f864214729-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc089f864214729-2\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">print3</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc089f864214729-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc089f864214729-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">print_arg</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc089f864214729-5\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0009 seconds] -->\r\n<p>这是right fold，你也可以写成left fold，对于comma来说两种写法是一样的，参数都是从左至右传入print_arg函数。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08a2454396779\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename... Args&gt;\r\nvoid print3(Args... args)\r\n{\r\n    (..., print_arg(args));\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08a2454396779-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08a2454396779-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08a2454396779-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08a2454396779-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08a2454396779-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08a2454396779-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08a2454396779-2\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">print3</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08a2454396779-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08a2454396779-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">print_arg</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08a2454396779-5\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0009 seconds] -->\r\n<p>你也可以通过binary fold这样写：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08a6839858305\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename ...Args&gt;\r\nvoid printer(Args&amp;&amp;... args) {\r\n    (std::cout &lt;&lt; ... &lt;&lt; args) &lt;&lt; '\\n';\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08a6839858305-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08a6839858305-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08a6839858305-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08a6839858305-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08a6839858305-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08a6839858305-2\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">printer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08a6839858305-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">cout</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'\\n'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08a6839858305-4\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0012 seconds] -->\r\n<p>也许你会觉得能写成这样：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08a9867380645\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename ...Args&gt;\r\nvoid printer(Args&amp;&amp;... args) {\r\n    (std::cout &lt;&lt; args &lt;&lt; ...) &lt;&lt; '\\n';\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08a9867380645-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08a9867380645-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08a9867380645-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08a9867380645-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08a9867380645-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08a9867380645-2\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">printer</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08a9867380645-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">cout</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'\\n'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08a9867380645-4\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0011 seconds] -->\r\n<p>但这样写是不合法的，根据binary fold的语法，参数包…必须在操作符中间，因此上面的这种写法不符合语法要求。</p>\n<p>借助comma fold我们可以简化代码，假如我们希望实现tuple的for_each算法，像这样：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08ac339127627\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nfor_each(std::make_tuple(2.5, 10, 'a'),[](auto e) { std::cout &lt;&lt; e&lt;&lt; '\\n'; });</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08ac339127627-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08ac339127627-1\"><span class=\"crayon-e\">for_each</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">make_tuple</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2.5</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">10</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'a'</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-sy\">[</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">auto</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">e</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">cout</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">e</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">'\\n'</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0010 seconds] -->\r\n<p>这个for_each将会遍历tuple的元素并打印出来。在C++17之前我们如果要实现这个算法的话，需要借助逗号表达式和std::initializer_list来实现，类似于这样：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08af601053727\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate &lt;typename... Args, typename Func, std::size_t... Idx&gt;\r\nvoid for_each(const std::tuple&amp; t, Func&amp;&amp; f, std::index_sequence&lt;Idx...&gt;) {\r\n    (void)std::initializer_list&lt;int&gt; { (f(std::get&lt;Idx&gt;(t)), void(), 0)...};\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08af601053727-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08af601053727-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08af601053727-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08af601053727-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08af601053727-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">typename </span><span class=\"crayon-v\">Func</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">size_t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Idx</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08af601053727-2\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">for_each</span><span class=\"crayon-sy\">(</span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">tuple</span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Func</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">f</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">index_sequence</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Idx</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08af601053727-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">void</span><span class=\"crayon-sy\">)</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">initializer_list</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">int</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">f</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">get</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Idx</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">void</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08af601053727-4\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0021 seconds] -->\r\n<p>这样写比较繁琐不直观，现在借助fold expression我们可以简化代码了。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08b3244283883\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate &lt;typename... Args, typename Func, std::size_t... Idx&gt;\r\nvoid for_each(const std::tuple&lt;Args...&gt;&amp; t, Func&amp;&amp; f, std::index_sequence&lt;Idx...&gt;) {\r\n    (f(std::get&lt;Idx&gt;(t)), ...);\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08b3244283883-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08b3244283883-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08b3244283883-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08b3244283883-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08b3244283883-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">typename</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Args</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">typename </span><span class=\"crayon-v\">Func</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">size_t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Idx</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08b3244283883-2\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">for_each</span><span class=\"crayon-sy\">(</span><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">tuple</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Args</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-o\">&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Func</span><span class=\"crayon-o\">&amp;&amp;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">f</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">index_sequence</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Idx</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08b3244283883-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">f</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">get</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Idx</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08b3244283883-4\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0019 seconds] -->\r\n<p>借助coma fold我们可以写很简洁的代码了。</p>\n<h1><strong>constexpr if</strong></h1>\n<p>constexpr标记一个表达式或一个函数的返回结果是编译期常量，它保证函数会在编译期执行。相比模版来说，实现编译期循环或递归，C++17中的constexpr if会让代码变得更简洁易懂。比如实现一个编译期整数加法：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08b8818476703\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;int N&gt;\r\nconstexpr int sum()\r\n{\r\n    return N;\r\n}\r\n\r\ntemplate &lt;int N, int N2, int... Ns&gt;\r\nconstexpr int sum()\r\n{\r\n    return N + sum&lt;N2, Ns...&gt;();\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08b8818476703-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08b8818476703-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08b8818476703-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08b8818476703-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08b8818476703-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08b8818476703-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08b8818476703-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08b8818476703-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08b8818476703-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08b8818476703-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08b8818476703-11\">11</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08b8818476703-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">N</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08b8818476703-2\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sum</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08b8818476703-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08b8818476703-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">N</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08b8818476703-5\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08b8818476703-6\"> </div><div class=\"crayon-line\" id=\"crayon-5987217fc08b8818476703-7\"><span class=\"crayon-v\">template</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">N</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">N2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Ns</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08b8818476703-8\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sum</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08b8818476703-9\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08b8818476703-10\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">N</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">sum</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">N2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Ns</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08b8818476703-11\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0017 seconds] -->\r\n<p>C++17之前你可能需要像上面这样写，但是现在你可以写更简洁的代码了。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08bb977925271\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate &lt;int N, int... Ns&gt;\r\nconstexpr auto sum17()\r\n{\r\n    if constexpr (sizeof...(Ns) == 0)\r\n        return N;\r\n    else\r\n        return N + sum17&lt;Ns...&gt;();\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08bb977925271-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08bb977925271-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08bb977925271-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08bb977925271-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08bb977925271-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08bb977925271-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08bb977925271-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08bb977925271-8\">8</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08bb977925271-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">N</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">int</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Ns</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08bb977925271-2\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">sum17</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08bb977925271-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08bb977925271-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">constexpr</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">sizeof</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Ns</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08bb977925271-5\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">N</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08bb977925271-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">else</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08bb977925271-7\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">N</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">sum17</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">Ns</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08bb977925271-8\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0016 seconds] -->\r\n<p>当然，你也可以用C++17的fold expression：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08bf658887078\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename ...Args&gt;\r\nconstexpr int sum(Args... args) {\r\n    return (0 + ... + args);\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08bf658887078-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08bf658887078-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08bf658887078-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08bf658887078-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08bf658887078-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">Args</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08bf658887078-2\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sum</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">Args</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08bf658887078-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">args</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08bf658887078-4\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0011 seconds] -->\r\n<p>constexpr还可以用来消除enable_if了，对于讨厌写一长串enable_if的人来说会非常开心。比如我需要根据类型来选择函数的时候：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08c2272589503\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename T&gt;\r\nstd::enable_if_t&lt;std::is_integral&lt;T&gt;::value, std::string&gt; to_str(T t)\r\n{\r\n    return std::to_string(t);\r\n}\r\n\r\ntemplate&lt;typename T&gt;\r\nstd::enable_if_t&lt;!std::is_integral&lt;T&gt;::value, std::string&gt; to_str(T t)\r\n{\r\n    return t;\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08c2272589503-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08c2272589503-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08c2272589503-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08c2272589503-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08c2272589503-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08c2272589503-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08c2272589503-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08c2272589503-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08c2272589503-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08c2272589503-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08c2272589503-11\">11</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08c2272589503-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08c2272589503-2\"><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">enable_if_t</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">is_integral</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">value</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-t\">string</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">to_str</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08c2272589503-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08c2272589503-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">to_string</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08c2272589503-5\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08c2272589503-6\"> </div><div class=\"crayon-line\" id=\"crayon-5987217fc08c2272589503-7\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08c2272589503-8\"><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">enable_if_t</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-o\">!</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">is_integral</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">value</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-t\">string</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">to_str</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08c2272589503-9\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08c2272589503-10\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08c2272589503-11\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0021 seconds] -->\r\n<p>经常不得不分开几个函数来写，还需要写长长的enable_if，比较繁琐，通过if constexpr可以消除enable_if了。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08c5346116578\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename T&gt;\r\nauto to_str17(T t)\r\n{\r\n    if constexpr(std::is_integral&lt;T&gt;::value)\r\n        return std::to_string(t);\r\n    else\r\n        return t;\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08c5346116578-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08c5346116578-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08c5346116578-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08c5346116578-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08c5346116578-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08c5346116578-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08c5346116578-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08c5346116578-8\">8</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08c5346116578-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08c5346116578-2\"><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">to_str17</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08c5346116578-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08c5346116578-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">constexpr</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">is_integral</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">value</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08c5346116578-5\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">to_string</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08c5346116578-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">else</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08c5346116578-7\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08c5346116578-8\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p>constexpr if让C++的模版具备if-else if-else功能了，是不是很酷，C++程序员的好日子来了。</p>\n<p>不过需要注意的是下面这种写法是有问题的。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08c8268047294\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate&lt;typename T&gt;\r\nauto to_str17(T t)\r\n{\r\n    if constexpr(std::is_integral&lt;T&gt;::value)\r\n        return std::to_string(t);\r\n\r\n        return t;\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08c8268047294-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08c8268047294-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08c8268047294-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08c8268047294-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08c8268047294-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08c8268047294-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08c8268047294-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08c8268047294-8\">8</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08c8268047294-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08c8268047294-2\"><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">to_str17</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">T</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08c8268047294-3\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08c8268047294-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">constexpr</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">is_integral</span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-v\">T</span><span class=\"crayon-o\">&gt;</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">value</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08c8268047294-5\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">to_string</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08c8268047294-6\"> </div><div class=\"crayon-line\" id=\"crayon-5987217fc08c8268047294-7\"><span class=\"crayon-h\">        </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08c8268047294-8\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0012 seconds] -->\r\n<p>这个代码把else去掉了，当输入如果是非数字类型时代码可以编译过，以为if constexpr在模版实例化的时候会丢弃不满足条件的部分，因此函数体中的前两行代码将失效，只有最后一句有效。当输入的为数字的时候就会产生编译错误了，因为if constexpr满足条件了，这时候就会有两个return了，就会导致编译错误。</p>\n<p>constexpr if还可以用来替换#ifdef宏，看下面的例子:</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08cc599626777\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nenum class OS { Linux, Mac, Windows };\r\n\r\n//Translate the macros to C++ at a single point in the application\r\n#ifdef __linux__\r\nconstexpr OS the_os = OS::Linux;\r\n#elif __APPLE__\r\nconstexpr OS the_os = OS::Mac;\r\n#elif __WIN32\r\nconstexpr OS the_os = OS::Windows;\r\n#endif\r\n\r\nvoid do_something() {\r\n     //do something general\r\n\r\n     if constexpr (the_os == OS::Linux) {\r\n         //do something Linuxy\r\n     }\r\n     else if constexpr (the_os == OS::Mac) {\r\n         //do something Appley\r\n     }\r\n     else if constexpr (the_os == OS::Windows) {\r\n         //do something Windowsy\r\n     }\r\n\r\n     //do something general\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08cc599626777-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08cc599626777-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08cc599626777-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08cc599626777-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08cc599626777-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08cc599626777-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08cc599626777-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08cc599626777-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08cc599626777-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08cc599626777-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08cc599626777-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08cc599626777-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08cc599626777-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08cc599626777-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08cc599626777-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08cc599626777-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08cc599626777-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08cc599626777-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08cc599626777-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08cc599626777-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08cc599626777-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08cc599626777-22\">22</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08cc599626777-23\">23</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08cc599626777-24\">24</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08cc599626777-25\">25</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08cc599626777-26\">26</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08cc599626777-1\"><span class=\"crayon-t\">enum</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">class</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">OS</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Linux</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">Mac</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Windows</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08cc599626777-2\"> </div><div class=\"crayon-line\" id=\"crayon-5987217fc08cc599626777-3\"><span class=\"crayon-c\">//Translate the macros to C++ at a single point in the application</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08cc599626777-4\"><span class=\"crayon-p\">#ifdef __linux__</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08cc599626777-5\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-e\">OS </span><span class=\"crayon-v\">the_os</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OS</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">Linux</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08cc599626777-6\"><span class=\"crayon-p\">#elif __APPLE__</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08cc599626777-7\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-e\">OS </span><span class=\"crayon-v\">the_os</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OS</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">Mac</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08cc599626777-8\"><span class=\"crayon-p\">#elif __WIN32</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08cc599626777-9\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-e\">OS </span><span class=\"crayon-v\">the_os</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OS</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">Windows</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08cc599626777-10\"><span class=\"crayon-p\">#endif</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08cc599626777-11\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08cc599626777-12\"><span class=\"crayon-t\">void</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">do_something</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08cc599626777-13\"><span class=\"crayon-h\">     </span><span class=\"crayon-c\">//do something general</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08cc599626777-14\"> </div><div class=\"crayon-line\" id=\"crayon-5987217fc08cc599626777-15\"><span class=\"crayon-h\">     </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">constexpr</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">the_os</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OS</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">Linux</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08cc599626777-16\"><span class=\"crayon-h\">         </span><span class=\"crayon-c\">//do something Linuxy</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08cc599626777-17\"><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08cc599626777-18\"><span class=\"crayon-h\">     </span><span class=\"crayon-st\">else</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">constexpr</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">the_os</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OS</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">Mac</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08cc599626777-19\"><span class=\"crayon-h\">         </span><span class=\"crayon-c\">//do something Appley</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08cc599626777-20\"><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08cc599626777-21\"><span class=\"crayon-h\">     </span><span class=\"crayon-st\">else</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">if</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">constexpr</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">the_os</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">==</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OS</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">Windows</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08cc599626777-22\"><span class=\"crayon-h\">         </span><span class=\"crayon-c\">//do something Windowsy</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08cc599626777-23\"><span class=\"crayon-h\">     </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08cc599626777-24\"> </div><div class=\"crayon-line\" id=\"crayon-5987217fc08cc599626777-25\"><span class=\"crayon-h\">     </span><span class=\"crayon-c\">//do something general</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08cc599626777-26\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0029 seconds] -->\r\n<p>代码变得更清爽了，再也不需要像以前一样写#ifdef那样难看的代码块了。</p>\n<h1><strong>constexpr lambda</strong></h1>\n<p>constexpr lambda其实很简单，它的意思就是可以在constexpr 函数中用lambda表达式了，这在C++17之前是不允许的。这样使用constexpr函数和普通函数没多大区别了，使用起来非常舒服。下面是constexpr lambda的例子：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08cf686501508\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntemplate &lt;typename I&gt;\r\nconstexpr auto func(I i) {\r\n  //use a lambda in constexpr context\r\n  return [i](auto j){ return i + j; }; \r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08cf686501508-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08cf686501508-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08cf686501508-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08cf686501508-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08cf686501508-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08cf686501508-1\"><span class=\"crayon-v\">template</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-i\">typename</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">I</span><span class=\"crayon-o\">&gt;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08cf686501508-2\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-e\">auto </span><span class=\"crayon-e\">func</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">I</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">i</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08cf686501508-3\"><span class=\"crayon-h\">  </span><span class=\"crayon-c\">//use a lambda in constexpr context</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08cf686501508-4\"><span class=\"crayon-h\">  </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">i</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">(</span><span class=\"crayon-i\">auto</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">j</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">{</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">return</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">j</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08cf686501508-5\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0012 seconds] -->\r\n<p>constexpr if和constexpr lambda是C++17提供的非常棒的特性，enjoy it.</p>\n<h1><strong>string_view</strong></h1>\n<p><strong>string_view的基本用法</strong></p>\n<p>C++17中的string_view是一个char数据的视图或者说引用，它并不拥有该数据，是为了避免拷贝，因此使用string_view可以用来做性能优化。你应该用string_view来代替const char和const string了。string_view的方法和string类似，用法很简单：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08d5859602677\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nconst char* data = \"test\";\r\nstd::string_view str1(data, 4);\r\nstd::cout&lt;&lt;str1.length()&lt;&lt;'\\n'; //4\r\nif(data==str1)\r\n    std::cout&lt;&lt;\"ok\"&lt;&lt;'\\n';\r\n\r\nconst std::string str2 = \"test\";\r\nstd::string_view str3(str2, str2.size());</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08d5859602677-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08d5859602677-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08d5859602677-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08d5859602677-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08d5859602677-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08d5859602677-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08d5859602677-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08d5859602677-8\">8</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08d5859602677-1\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-t\">char</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">data</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"test\"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08d5859602677-2\"><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">string_view </span><span class=\"crayon-e\">str1</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">data</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08d5859602677-3\"><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">cout</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-v\">str1</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">length</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-s\">'\\n'</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-c\">//4</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08d5859602677-4\"><span class=\"crayon-st\">if</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">data</span><span class=\"crayon-o\">==</span><span class=\"crayon-v\">str1</span><span class=\"crayon-sy\">)</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08d5859602677-5\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">cout</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-s\">\"ok\"</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-s\">'\\n'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08d5859602677-6\"> </div><div class=\"crayon-line\" id=\"crayon-5987217fc08d5859602677-7\"><span class=\"crayon-m\">const</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-t\">string</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">str2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"test\"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08d5859602677-8\"><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">string_view </span><span class=\"crayon-e\">str3</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">str2</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">str2</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">size</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0018 seconds] -->\r\n<p>构造string_view的时候用char*和长度来构造，这个长度可以自由确定，它表示string_view希望引用的字符串的长度。因为它只是引用其他字符串，所以它不会分配内存，不会像string那样容易产生临时变量。我们通过一个测试程序来看看string_view如何来帮我们优化性能的。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08d9744107541\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nusing namespace std::literals;\r\n\r\nconstexpr auto s = \"it is a test\"sv;\r\nauto str = \"it is a test\"s;\r\n\r\nconstexpr int LEN = 1000000;\r\nboost::timer t;\r\nfor (int i = 0; i &lt; LEN; ++i) {\r\n    constexpr auto s1 = s.substr(3);\r\n}\r\nstd::cout&lt;&lt;t.elapsed()&lt;&lt;'\\n';\r\nt.restart();\r\nfor (int i = 0; i &lt; LEN; ++i) {\r\n    auto s2 = str.substr(3);\r\n}\r\nstd::cout&lt;&lt;t.elapsed()&lt;&lt;'\\n';\r\n\r\n//output\r\n0.004197\r\n0.231505</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08d9744107541-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08d9744107541-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08d9744107541-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08d9744107541-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08d9744107541-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08d9744107541-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08d9744107541-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08d9744107541-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08d9744107541-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08d9744107541-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08d9744107541-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08d9744107541-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08d9744107541-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08d9744107541-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08d9744107541-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08d9744107541-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08d9744107541-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08d9744107541-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08d9744107541-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08d9744107541-20\">20</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08d9744107541-1\"><span class=\"crayon-e\">using </span><span class=\"crayon-t\">namespace</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">literals</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08d9744107541-2\"> </div><div class=\"crayon-line\" id=\"crayon-5987217fc08d9744107541-3\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-i\">auto</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">s</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"it is a test\"</span><span class=\"crayon-v\">sv</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08d9744107541-4\"><span class=\"crayon-e\">auto </span><span class=\"crayon-v\">str</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"it is a test\"</span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08d9744107541-5\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08d9744107541-6\"><span class=\"crayon-e\">constexpr </span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">LEN</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1000000</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08d9744107541-7\"><span class=\"crayon-v\">boost</span><span class=\"crayon-o\">::</span><span class=\"crayon-i\">timer</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08d9744107541-8\"><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">LEN</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">++</span><span class=\"crayon-v\">i</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08d9744107541-9\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">constexpr </span><span class=\"crayon-e\">auto </span><span class=\"crayon-v\">s1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">s</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">substr</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08d9744107541-10\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08d9744107541-11\"><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">cout</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">elapsed</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-s\">'\\n'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08d9744107541-12\"><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">restart</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08d9744107541-13\"><span class=\"crayon-st\">for</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-t\">int</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">LEN</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">++</span><span class=\"crayon-v\">i</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08d9744107541-14\"><span class=\"crayon-h\">    </span><span class=\"crayon-e\">auto </span><span class=\"crayon-v\">s2</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">str</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">substr</span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">3</span><span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08d9744107541-15\"><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08d9744107541-16\"><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-v\">cout</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-v\">t</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">elapsed</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-s\">'\\n'</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08d9744107541-17\"> </div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08d9744107541-18\"><span class=\"crayon-c\">//output</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08d9744107541-19\"><span class=\"crayon-cn\">0.004197</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08d9744107541-20\"><span class=\"crayon-cn\">0.231505</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0032 seconds] -->\r\n<p>我们可以通过字面量””sv来初始化string_view。string_view的substr和string的substr相比，快了50多倍，根本原因是它不会分配内存。</p>\n<p><strong>string_view的生命周期</strong></p>\n<p>由于string_vew并不拥有锁引用的字符串，所以它也不会去关注被引用字符串的生命周期，用户在使用的时候需要注意，不要将一个临时变量给一个string_view，那样会导致string_view引用的内容也失效。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987217fc08dc187427866\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" touchscreen minimize scroll-mouseover\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nstd::string_view str_v;\r\n{\r\n    std::string temp = \"test\";\r\n    str_v = {temp};\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987217fc08dc187427866-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08dc187427866-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08dc187427866-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987217fc08dc187427866-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987217fc08dc187427866-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987217fc08dc187427866-1\"><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-e\">string_view </span><span class=\"crayon-v\">str_v</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08dc187427866-2\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08dc187427866-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">std</span><span class=\"crayon-o\">::</span><span class=\"crayon-t\">string</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">temp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"test\"</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987217fc08dc187427866-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-v\">str_v</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">=</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span><span class=\"crayon-v\">temp</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-5987217fc08dc187427866-5\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0008 seconds] -->\r\n<p>这样的代码是有问题的，因为出了作用域之后，string_view引用的内容已经失效了。</p>\n<h1><strong>总结</strong></h1>\n<p>本文介绍了C++17的fold expression、constexpr if、constexpr lambda和string_view。fold expression为了简化可变模板参数的展开，让可以模板参数的使用变得更简单直观；constexpr if让模板具备if-else功能，非常强大。它也避免了写冗长的enable_if代码，让代码变得简洁易懂了；string_view则是用来做性能优化的，应该用它来代替const char*和const string。 这些特性对之前的C++14和C++11做了改进和增强，非常酷。</p>\n<p><strong>作者</strong>：祁宇，《深入应用C++11》作者，C++开源社区purecpp.org创始人，致力于C++11/14的应用、研究和推广。乐于研究和分享技术，爱好C++，爱好开源。</p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112106\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112106votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112106\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i>  收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "1", "fav_nums": "", "comment_nums": "", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2012/08/C-+-+-pit-really-more1l.jpg"]},{"url_object_id": "5bfa4b1834ca384be1a3a4a0e7c0811c", "create_date": "2017/07/26", "front_image_path": "full/c766feed221138f7946130756cddfc7e86e388b4.jpg", "title": "Redis 核心概念", "url": "http://blog.jobbole.com/112024/", "tags": "IT技术,Redis,数据库", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"http://www.jianshu.com/p/2a4a57c5e313\">高广超</a>   </div><h3>概述</h3>\n<p>Redis 与其他 key – value 缓存产品有以下三个特点：</p>\n<ol>\n<li>Redis支持数据的持久化，可以将内存中的数据保持在磁盘中，重启的时候可以再次加载进行使用。</li>\n<li>Redis不仅仅支持简单的key-value类型的数据，同时还提供list，set，zset，hash等数据结构的存储。</li>\n<li>Redis支持数据的备份，即master-slave模式的数据备份。</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>概念</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Redis 优势</td>\n<td>1. 性能极高 – Redis能读的速度是110000次/s,写的速度是81000次/s 。\n<p>2. 丰富的数据类型 – Redis支持二进制案例的 Strings, Lists, Hashes, Sets 及 Ordered Sets 数据类型操作。</p>\n<p>3. 原子 – Redis的所有操作都是原子性的，同时Redis还支持对几个操作全并后的原子性执行。</p>\n<p>4. 丰富的特性 – Redis还支持 publish/subscribe, 通知, key 过期等等特性。</p></td>\n</tr>\n<tr>\n<td>Redis与其他key-value存储有什么不同？</td>\n<td>1. Redis有着更为复杂的数据结构并且提供对他们的原子性操作，这是一个不同于其他数据库的进化路径。Redis的数据类型都是基于基本数据结构的同时对程序员透明，无需进行额外的抽象。\n<p>2. Redis运行在内存中但是可以持久化到磁盘，所以在对不同数据集进行高速读写时需要权衡内存，应为数据量不能大于硬件内存。在内存数据库方面的另一个优点是， 相比在磁盘上相同的复杂的数据结构，在内存中操作起来非常简单，这样Redis可以做很多内部复杂性很强的事情。 同时，在磁盘格式方面他们是紧凑的以追加的方式产生的，因为他们并不需要进行随机访问。</p></td>\n</tr>\n</tbody>\n</table>\n<h4>数据类型</h4>\n<table>\n<thead>\n<tr>\n<th>概念</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>String（字符串）</td>\n<td>string是redis最基本的类型，你可以理解成与Memcached一模一样的类型，一个key对应一个value。\n<p>string类型是二进制安全的。意思是redis的string可以包含任何数据。比如jpg图片或者序列化的对象 。</p>\n<p>string类型是Redis最基本的数据类型，一个键最大能存储512MB。</p></td>\n</tr>\n<tr>\n<td>Hash（哈希）</td>\n<td>Redis hash 是一个键值对集合。\n<p>Redis hash是一个string类型的field和value的映射表，hash特别适合用于存储对象。</p>\n<p>每个 hash 可以存储 2 *32 – 1键值对（40多亿）。</p></td>\n</tr>\n<tr>\n<td>List（列表）</td>\n<td>Redis 列表是简单的字符串列表，按照插入顺序排序。你可以添加一个元素导列表的头部（左边）或者尾部（右边）。\n<p>列表最多可存储 2*32 – 1元素 (4294967295, 每个列表可存储40多亿)。</p></td>\n</tr>\n<tr>\n<td>Set（集合）</td>\n<td>Redis的Set是string类型的无序集合。\n<p>集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)。</p>\n<p>集合中最大的成员数为 2<em> 32 – 1(4294967295, 每个集合可存储40多亿个成员)。<br>\n<strong>* </strong></em></p></td>\n</tr>\n<tr>\n<td>zset(sorted set：有序集合)</td>\n<td>Redis zset 和 set 一样也是string类型元素的集合,且不允许重复的成员。\n<p>不同的是每个元素都会关联一个double类型的分数。redis正是通过分数来为集合中的成员进行从小到大的排序。</p>\n<p>zset的成员是唯一的,但分数(score)却可以重复。</p></td>\n</tr>\n</tbody>\n</table>\n<h4>基本概念</h4>\n<table>\n<thead>\n<tr>\n<th>概念</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>HyperLogLog</td>\n<td>Redis 在 2.8.9 版本添加了 HyperLogLog 结构。\n<p>Redis HyperLogLog 是用来做基数统计的算法，HyperLogLog 的优点是，在输入元素的数量或者体积非常非常大时，计算基数所需的空间总是固定 的、并且是很小的。</p>\n<p>在 Redis 里面，每个 HyperLogLog 键只需要花费 12 KB 内存，就可以计算接近 2^64 个不同元素的基 数。这和计算基数时，元素越多耗费内存就越多的集合形成鲜明对比。</p>\n<p>但是，因为 HyperLogLog 只会根据输入元素来计算基数，而不会储存输入元素本身，所以 HyperLogLog 不能像集合那样，返回输入的各个元素。</p>\n<p>什么是基数?</p>\n<p>比如数据集 {1, 3, 5, 7, 5, 7, 8}， 那么这个数据集的基数集为 {1, 3, 5 ,7, 8}, 基数(不重复元素)为5。 基数估计就是在误差可接受的范围内，快速计算基数。</p></td>\n</tr>\n<tr>\n<td>发布订阅</td>\n<td>Redis 发布订阅(pub/sub)是一种消息通信模式：发送者(pub)发送消息，订阅者(sub)接收消息。\n<p>Redis 客户端可以订阅任意数量的频道。</p>\n<p>下图展示了频道 channel1 ， 以及订阅这个频道的三个客户端 —— client2 、 client5 和 client1 之间的关系：</p>\n<div>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/07/ab86674b7a9021d28c5d48f0dd02577f.png\"></p>\n<div>pubsub1</div>\n</div>\n<p>当有新消息通过 PUBLISH 命令发送给频道 channel1 时， 这个消息就会被发送给订阅它的三个客户端：</p>\n<div>\n<p><img src=\"http://jbcdn2.b0.upaiyun.com/2017/07/3d22f3afc11b262baf8ae1db4f7ab4f3.png\"></p>\n<div>pubsub2</div>\n</div>\n</td>\n</tr>\n<tr>\n<td>Redis 事务</td>\n<td>Redis 事务可以一次执行多个命令， 并且带有以下两个重要的保证：\n<p>1. 事务是一个单独的隔离操作：事务中的所有命令都会序列化、按顺序地执行。事务在执行的过程中，不会被其他客户端发送来的命令请求所打断。</p>\n<p>2. 事务是一个原子操作：事务中的命令要么全部被执行，要么全部都不执行。</p>\n<p>一个事务从开始到执行会经历以下三个阶段：</p>\n<p>a. 开始事务。</p>\n<p>b. 命令入队。</p>\n<p>c. 执行事务。</p></td>\n</tr>\n</tbody>\n</table>\n<h4>复制（Replication）</h4>\n<p>Redis 支持简单且易用的主从复制（master-slave replication）功能， 该功能可以让从服务器(slave server)成为主服务器(master server)的精确复制品。</p>\n<p><strong> 以下是关于 Redis 复制功能的几个重要方面：</strong></p>\n<ol>\n<li>Redis 使用异步复制。 从 Redis 2.8 开始， 从服务器会以每秒一次的频率向主服务器报告复制流（replication stream）的处理进度。</li>\n<li>一个主服务器可以有多个从服务器。</li>\n<li>不仅主服务器可以有从服务器， 从服务器也可以有自己的从服务器， 多个从服务器之间可以构成一个图状结构。</li>\n<li>复制功能不会阻塞主服务器： 即使有一个或多个从服务器正在进行初次同步， 主服务器也可以继续处理命令请求。</li>\n<li>复制功能也不会阻塞从服务器： 只要在 redis.conf 文件中进行了相应的设置， 即使从服务器正在进行初次同步， 服务器也可以使用旧版本的数据集来处理命令查询。不过， 在从服务器删除旧版本数据集并载入新版本数据集的那段时间内， 连接请求会被阻塞。<br>\n你还可以配置从服务器， 让它在与主服务器之间的连接断开时， 向客户端发送一个错误。</li>\n<li>复制功能可以单纯地用于数据冗余（data redundancy）， 也可以通过让多个从服务器处理只读命令请求来提升扩展性（scalability）： 比如说， 繁重的 <a href=\"http://doc.redisfans.com/key/sort.html#sort\" target=\"_blank\">SORT</a> 命令可以交给附属节点去运行。</li>\n<li>可以通过复制功能来让主服务器免于执行持久化操作： 只要关闭主服务器的持久化功能， 然后由从服务器去执行持久化操作即可。</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>概念</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>复制功能的运作原理</td>\n<td>无论是初次连接还是重新连接， 当建立一个从服务器时， 从服务器都将向主服务器发送一个 <a href=\"http://doc.redisfans.com/server/sync.html#sync\" target=\"_blank\">SYNC</a> 命令。\n<p>接到 <a href=\"http://doc.redisfans.com/server/sync.html#sync\" target=\"_blank\">SYNC</a> 命令的主服务器将开始执行 <a href=\"http://doc.redisfans.com/server/bgsave.html#bgsave\" target=\"_blank\">BGSAVE</a> ， 并在保存操作执行期间， 将所有新执行的写入命令都保存到一个缓冲区里面。</p>\n<p>当 <a href=\"http://doc.redisfans.com/server/bgsave.html#bgsave\" target=\"_blank\">BGSAVE</a> 执行完毕后， 主服务器将执行保存操作所得的 .rdb 文件发送给从服务器， 从服务器接收这个 .rdb 文件， 并将文件中的数据载入到内存中。</p>\n<p>之后主服务器会以 Redis 命令协议的格式， 将写命令缓冲区中积累的所有内容都发送给从服务器。</p>\n<p>你可以通过 telnet 命令来亲自验证这个同步过程： 首先连上一个正在处理命令请求的 Redis 服务器， 然后向它发送 <a href=\"http://doc.redisfans.com/server/sync.html#sync\" target=\"_blank\">SYNC</a> 命令， 过一阵子， 你将看到 telnet 会话（session）接收到服务器发来的大段数据（.rdb 文件）， 之后还会看到， 所有在服务器执行过的写命令， 都会重新发送到 telnet 会话来。</p>\n<p>即使有多个从服务器同时向主服务器发送 <a href=\"http://doc.redisfans.com/server/sync.html#sync\" target=\"_blank\">SYNC</a> ， 主服务器也只需执行一次 <a href=\"http://doc.redisfans.com/server/bgsave.html#bgsave\" target=\"_blank\">BGSAVE</a> 命令， 就可以处理所有这些从服务器的同步请求。</p>\n<p>从服务器可以在主从服务器之间的连接断开时进行自动重连， 在 Redis 2.8 版本之前， 断线之后重连的从服务器总要执行一次完整重同步（full resynchronization）操作， 但是从 Redis 2.8 版本开始， 从服务器可以根据主服务器的情况来选择执行完整重同步还是部分重同步（partial resynchronization）。</p></td>\n</tr>\n<tr>\n<td>部分重同步</td>\n<td>从 Redis 2.8 开始， 在网络连接短暂性失效之后， 主从服务器可以尝试继续执行原有的复制进程（process）， 而不一定要执行完整重同步操作。\n<p>这个特性需要主服务器为被发送的复制流创建一个内存缓冲区（in-memory backlog）， 并且主服务器和所有从服务器之间都记录一个复制偏移量（replication offset）和一个主服务器 ID （master run id）， 当出现网络连接断开时， 从服务器会重新连接， 并且向主服务器请求继续执行原来的复制进程：</p>\n<p>1. 如果从服务器记录的主服务器 ID 和当前要连接的主服务器的 ID 相同， 并且从服务器记录的偏移量所指定的数据仍然保存在主服务器的复制流缓冲区里面， 那么主服务器会向从服务器发送断线时缺失的那部分数据， 然后复制工作可以继续执行。</p>\n<p>2. 否则的话， 从服务器就要执行完整重同步操作。</p>\n<p>Redis 2.8 的这个部分重同步特性会用到一个新增的 <a href=\"http://doc.redisfans.com/server/psync.html#psync\" target=\"_blank\">PSYNC</a> 内部命令， 而 Redis 2.8 以前的旧版本只有 <a href=\"http://doc.redisfans.com/server/sync.html#sync\" target=\"_blank\">SYNC</a> 命令， 不过， 只要从服务器是 Redis 2.8 或以上的版本， 它就会根据主服务器的版本来决定到底是使用 <a href=\"http://doc.redisfans.com/server/psync.html#psync\" target=\"_blank\">PSYNC</a> 还是 <a href=\"http://doc.redisfans.com/server/sync.html#sync\" target=\"_blank\">SYNC</a> ：</p>\n<p>1. 如果主服务器是 Redis 2.8 或以上版本，那么从服务器使用 <a href=\"http://doc.redisfans.com/server/psync.html#psync\" target=\"_blank\">PSYNC</a> 命令来进行同步。</p>\n<p>2. 如果主服务器是 Redis 2.8 之前的版本，那么从服务器使用 <a href=\"http://doc.redisfans.com/server/sync.html#sync\" target=\"_blank\">SYNC</a> 命令来进行同步。</p></td>\n</tr>\n<tr>\n<td>只读从服务器</td>\n<td>从 Redis 2.6 开始， 从服务器支持只读模式， 并且该模式为从服务器的默认模式。\n<p>只读模式由 redis.conf 文件中的 slave-read-only 选项控制， 也可以通过 <a href=\"http://doc.redisfans.com/server/config_set.html#config-set\" target=\"_blank\">CONFIG SET</a> 命令来开启或关闭这个模式。</p>\n<p>只读从服务器会拒绝执行任何写命令， 所以不会出现因为操作失误而将数据不小心写入到了从服务器的情况。</p>\n<p>即使从服务器是只读的， DEBUG 和 CONFIG 等管理式命令仍然是可以使用的， 所以我们还是不应该将服务器暴露给互联网或者任何不可信网络。 不过， 使用 redis.conf 中的命令改名选项， 我们可以通过禁止执行某些命令来提升只读从服务器的安全性。</p>\n<p>你可能会感到好奇， 既然从服务器上的写数据会被重同步数据覆盖， 也可能在从服务器重启时丢失， 那么为什么要让一个从服务器变得可写呢？</p>\n<p>原因是， 一些不重要的临时数据， 仍然是可以保存在从服务器上面的。 比如说， 客户端可以在从服务器上保存主服务器的可达性（reachability）信息， 从而实现故障转移（failover）策略。</p></td>\n</tr>\n<tr>\n<td>主服务器只在有至少 N 个从服务器的情况下，才执行写操作</td>\n<td>从 Redis 2.8 开始， 为了保证数据的安全性， 可以通过配置， 让主服务器只在有至少 N 个当前已连接从服务器的情况下， 才执行写命令。\n<p>不过， 因为 Redis 使用异步复制， 所以主服务器发送的写数据并不一定会被从服务器接收到， 因此， 数据丢失的可能性仍然是存在的。</p>\n<p>以下是这个特性的运作原理：</p>\n<p>1 从服务器以每秒一次的频率 PING 主服务器一次， 并报告复制流的处理情况。</p>\n<p>2 主服务器会记录各个从服务器最后一次向它发送 PING 的时间。</p>\n<p>3 用户可以通过配置， 指定网络延迟的最大值 ， 以及执行写操作所需的至少从服务器数量如果至少有 min-slaves-to-write 个从服务器， 并且这些服务器的延迟值都少于 min-slaves-max-lag 秒， 那么主服务器就会执行客户端请求的写操作。</p>\n<p>你可以将这个特性看作 CAP 理论中的 C 的条件放宽版本： 尽管不能保证写操作的持久性， 但起码丢失数据的窗口会被严格限制在指定的秒数中。</p>\n<p>另一方面， 如果条件达不到min-slaves-to-write 和 min-slaves-max-lag 所指定的条件， 那么写操作就不会被执行， 主服务器会向请求执行写操作的客户端返回一个错误。</p>\n<p>以下是这个特性的两个选项和它们所需的参数：</p>\n<p>1 min-slaves-to-write</p>\n<p>2 min-slaves-max-lag</p>\n<p>详细的信息可以参考 Redis 源码中附带的 redis.conf 示例文件。</p></td>\n</tr>\n</tbody>\n</table>\n<h4>事务（transaction）</h4>\n<p><a href=\"http://doc.redisfans.com/transaction/multi.html#multi\" target=\"_blank\">MULTI</a> 、 <a href=\"http://doc.redisfans.com/transaction/exec.html#exec\" target=\"_blank\">EXEC</a> 、 <a href=\"http://doc.redisfans.com/transaction/discard.html#discard\" target=\"_blank\">DISCARD</a> 和 <a href=\"http://doc.redisfans.com/transaction/watch.html#watch\" target=\"_blank\">WATCH</a> 是 Redis 事务的基础。<br>\n事务可以一次执行多个命令， 并且带有以下两个重要的保证：</p>\n<ol>\n<li>事务是一个单独的隔离操作：事务中的所有命令都会序列化、按顺序地执行。事务在执行的过程中，不会被其他客户端发送来的命令请求所打断。</li>\n<li>事务是一个原子操作：事务中的命令要么全部被执行，要么全部都不执行。<br>\n<a href=\"http://doc.redisfans.com/transaction/exec.html#exec\" target=\"_blank\">EXEC</a> 命令负责触发并执行事务中的所有命令：\n<ul>\n<li>如果客户端在使用 <a href=\"http://doc.redisfans.com/transaction/multi.html#multi\" target=\"_blank\">MULTI</a> 开启了一个事务之后，却因为断线而没有成功执行 <a href=\"http://doc.redisfans.com/transaction/exec.html#exec\" target=\"_blank\">EXEC</a> ，那么事务中的所有命令都不会被执行。</li>\n<li>另一方面，如果客户端成功在开启事务之后执行 <a href=\"http://doc.redisfans.com/transaction/exec.html#exec\" target=\"_blank\">EXEC</a> ，那么事务中的所有命令都会被执行。<br>\n当使用 AOF 方式做持久化的时候， Redis 会使用单个 write(2) 命令将事务写入到磁盘中。</li>\n</ul>\n</li>\n</ol>\n<p>然而，如果 Redis 服务器因为某些原因被管理员杀死，或者遇上某种硬件故障，那么可能只有部分事务命令会被成功写入到磁盘中。<br>\n如果 Redis 在重新启动时发现 AOF 文件出了这样的问题，那么它会退出，并汇报一个错误。<br>\n使用 redis-check-aof 程序可以修复这一问题：它会移除 AOF 文件中不完整事务的信息，确保服务器可以顺利启动。<br>\n从 2.2 版本开始，Redis 还可以通过乐观锁（optimistic lock）实现 CAS （check-and-set）操作，具体信息请参考文档的后半部分。</p>\n<table>\n<thead>\n<tr>\n<th>概念</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>事务中的错误</td>\n<td>使用事务时可能会遇上以下两种错误：\n<p>1. 事务在执行 <a href=\"http://doc.redisfans.com/transaction/exec.html#exec\" target=\"_blank\">EXEC</a> 之前，入队的命令可能会出错。比如说，命令可能会产生语法错误（参数数量错误，参数名错误，等等），或者其他更严重的错误，比如内存不足（如果服务器使用 maxmemory 设置了最大内存限制的话）。</p>\n<p>2. 命令可能在 <a href=\"http://doc.redisfans.com/transaction/exec.html#exec\" target=\"_blank\">EXEC</a> 调用之后失败。举个例子，事务中的命令可能处理了错误类型的键，比如将列表命令用在了字符串键上面，诸如此类。</p>\n<p>对于发生在 <a href=\"http://doc.redisfans.com/transaction/exec.html#exec\" target=\"_blank\">EXEC</a> 执行之前的错误，客户端以前的做法是检查命令入队所得的返回值：如果命令入队时返回 QUEUED ，那么入队成功；否则，就是入队失败。如果有命令在入队时失败，那么大部分客户端都会停止并取消这个事务。</p>\n<p>不过，从 Redis 2.6.5 开始，服务器会对命令入队失败的情况进行记录，并在客户端调用 <a href=\"http://doc.redisfans.com/transaction/exec.html#exec\" target=\"_blank\">EXEC</a> 命令时，拒绝执行并自动放弃这个事务。</p>\n<p>在 Redis 2.6.5 以前， Redis 只执行事务中那些入队成功的命令，而忽略那些入队失败的命令。 而新的处理方式则使得在流水线（pipeline）中包含事务变得简单，因为发送事务和读取事务的回复都只需要和服务器进行一次通讯。</p>\n<p>至于那些在 <a href=\"http://doc.redisfans.com/transaction/exec.html#exec\" target=\"_blank\">EXEC</a> 命令执行之后所产生的错误， 并没有对它们进行特别处理： 即使事务中有某个/某些命令在执行时产生了错误， 事务中的其他命令仍然会继续执行。</p>\n<p>最重要的是记住这样一条， 即使事务中有某条/某些命令执行失败了， 事务队列中的其他命令仍然会继续执行 —— Redis 不会停止执行事务中的命令。</p></td>\n</tr>\n<tr>\n<td>Redis 不支持回滚</td>\n<td>如果你有使用关系式数据库的经验， 那么 “Redis 在事务失败时不进行回滚，而是继续执行余下的命令”这种做法可能会让你觉得有点奇怪。\n<p>以下是这种做法的优点：</p>\n<p>1. Redis 命令只会因为错误的语法而失败（并且这些问题不能在入队时发现），或是命令用在了错误类型的键上面：这也就是说，从实用性的角度来说，失败的命令是由编程错误造成的，而这些错误应该在开发的过程中被发现，而不应该出现在生产环境中。</p>\n<p>2. 因为不需要对回滚进行支持，所以 Redis 的内部可以保持简单且快速。</p>\n<p>有种观点认为 Redis 处理事务的做法会产生 bug ， 然而需要注意的是， 在通常情况下， 回滚并不能解决编程错误带来的问题。 举个例子， 如果你本来想通过 <a href=\"http://doc.redisfans.com/string/incr.html#incr\" target=\"_blank\">INCR</a> 命令将键的值加上 1 ， 却不小心加上了 2 ， 又或者对错误类型的键执行了 <a href=\"http://doc.redisfans.com/string/incr.html#incr\" target=\"_blank\">INCR</a> ， 回滚是没有办法处理这些情况的。</p>\n<p>鉴于没有任何机制能避免程序员自己造成的错误， 并且这类错误通常不会在生产环境中出现， 所以 Redis 选择了更简单、更快速的无回滚方式来处理事务。</p></td>\n</tr>\n<tr>\n<td>乐观锁</td>\n<td><a href=\"http://doc.redisfans.com/transaction/watch.html#watch\" target=\"_blank\">WATCH</a> 命令可以为 Redis 事务提供 check-and-set （CAS）行为。\n<p>被 <a href=\"http://doc.redisfans.com/transaction/watch.html#watch\" target=\"_blank\">WATCH</a> 的键会被监视，并会发觉这些键是否被改动过了。 如果有至少一个被监视的键在 <a href=\"http://doc.redisfans.com/transaction/exec.html#exec\" target=\"_blank\">EXEC</a> 执行之前被修改了， 那么整个事务都会被取消， <a href=\"http://doc.redisfans.com/transaction/exec.html#exec\" target=\"_blank\">EXEC</a> 返回空多条批量回复（null multi-bulk reply）来表示事务已经失败。</p>\n<p>举个例子， 假设我们需要原子性地为某个值进行增 1 操作（假设 <a href=\"http://doc.redisfans.com/string/incr.html#incr\" target=\"_blank\">INCR</a> 不存在）。</p>\n<p>首先我们可能会这样做：</p>\n<p>val = GETmykey</p>\n<p>val = val + 1</p>\n<p>SET mykey $val</p>\n<p>上面的这个实现在只有一个客户端的时候可以执行得很好。 但是， 当多个客户端同时对同一个键进行这样的操作时， 就会产生竞争条件。</p>\n<p>举个例子， 如果客户端 A 和 B 都读取了键原来的值， 比如 10 ， 那么两个客户端都会将键的值设为 11 ， 但正确的结果应该是 12 才对。</p>\n<p>有了 <a href=\"http://doc.redisfans.com/transaction/watch.html#watch\" target=\"_blank\">WATCH</a> ， 我们就可以轻松地解决这类问题了：</p>\n<p>WATCH mykey</p>\n<p>val = GET mykey</p>\n<p>val = val + 1</p>\n<p>MULTI</p>\n<p>SET mykey $val</p>\n<p>EXEC</p>\n<p>使用上面的代码， 如果在 <a href=\"http://doc.redisfans.com/transaction/watch.html#watch\" target=\"_blank\">WATCH</a> 执行之后， <a href=\"http://doc.redisfans.com/transaction/exec.html#exec\" target=\"_blank\">EXEC</a> 执行之前， 有其他客户端修改了 mykey 的值， 那么当前客户端的事务就会失败。 程序需要做的， 就是不断重试这个操作， 直到没有发生碰撞为止。</p>\n<p>这种形式的锁被称作乐观锁， 它是一种非常强大的锁机制。 并且因为大多数情况下， 不同的客户端会访问不同的键， 碰撞的情况一般都很少， 所以通常并不需要进行重试。</p></td>\n</tr>\n<tr>\n<td>WATCH</td>\n<td><a href=\"http://doc.redisfans.com/transaction/watch.html#watch\" target=\"_blank\">WATCH</a> 使得 <a href=\"http://doc.redisfans.com/transaction/exec.html#exec\" target=\"_blank\">EXEC</a> 命令需要有条件地执行： 事务只能在所有被监视键都没有被修改的前提下执行， 如果这个前提不能满足的话，事务就不会被执行。\n<p>如果你使用 <a href=\"http://doc.redisfans.com/transaction/watch.html#watch\" target=\"_blank\">WATCH</a> 监视了一个带过期时间的键， 那么即使这个键过期了， 事务仍然可以正常执行， 关于这方面的详细情况，请看这个帖子： <a href=\"http://code.google.com/p/redis/issues/detail?id=270\" target=\"_blank\">http://code.google.com/p/redis/issues/detail?id=270</a></p>\n<p><a href=\"http://doc.redisfans.com/transaction/watch.html#watch\" target=\"_blank\">WATCH</a> 命令可以被调用多次。 对键的监视从 <a href=\"http://doc.redisfans.com/transaction/watch.html#watch\" target=\"_blank\">WATCH</a> 执行之后开始生效， 直到调用 <a href=\"http://doc.redisfans.com/transaction/exec.html#exec\" target=\"_blank\">EXEC</a> 为止。</p>\n<p>用户还可以在单个 <a href=\"http://doc.redisfans.com/transaction/watch.html#watch\" target=\"_blank\">WATCH</a> 命令中监视任意多个键， 就像这样：</p>\n<p>redis&gt; WATCH key1 key2 key3</p>\n<p>OK</p>\n<p>当 <a href=\"http://doc.redisfans.com/transaction/exec.html#exec\" target=\"_blank\">EXEC</a> 被调用时， 不管事务是否成功执行， 对所有键的监视都会被取消。</p>\n<p>另外， 当客户端断开连接时， 该客户端对键的监视也会被取消。</p>\n<p>使用无参数的 <a href=\"http://doc.redisfans.com/transaction/unwatch.html#unwatch\" target=\"_blank\">UNWATCH</a> 命令可以手动取消对所有键的监视。 对于一些需要改动多个键的事务， 有时候程序需要同时对多个键进行加锁， 然后检查这些键的当前值是否符合程序的要求。 当值达不到要求时， 就可以使用 <a href=\"http://doc.redisfans.com/transaction/unwatch.html#unwatch\" target=\"_blank\">UNWATCH</a> 命令来取消目前对键的监视， 中途放弃这个事务， 并等待事务的下次尝试。</p>\n<p><a href=\"http://doc.redisfans.com/transaction/watch.html#watch\" target=\"_blank\">WATCH</a> 可以用于创建 Redis 没有内置的原子操作。</p></td>\n</tr>\n<tr>\n<td>Redis 脚本和事务</td>\n<td>从定义上来说， Redis 中的脚本本身就是一种事务， 所以任何在事务里可以完成的事， 在脚本里面也能完成。 并且一般来说， 使用脚本要来得更简单，并且速度更快。\n<p>因为脚本功能是 Redis 2.6 才引入的， 而事务功能则更早之前就存在了， 所以 Redis 才会同时存在两种处理事务的方法。</p>\n<p>不过我们并不打算在短时间内就移除事务功能， 因为事务提供了一种即使不使用脚本， 也可以避免竞争条件的方法， 而且事务本身的实现并不复杂。</p>\n<p>不过在不远的将来， 可能所有用户都会只使用脚本来实现事务也说不定。 如果真的发生这种情况的话， 那么我们将废弃并最终移除事务功能。</p></td>\n</tr>\n</tbody>\n</table>\n<h4>Sentinel</h4>\n<p>Redis 的 Sentinel 系统用于管理多个 Redis 服务器（instance）， 该系统执行以下三个任务：</p>\n<ol>\n<li><strong>监控（Monitoring）</strong>： Sentinel 会不断地检查你的主服务器和从服务器是否运作正常。</li>\n<li><strong>提醒（Notification）</strong>： 当被监控的某个 Redis 服务器出现问题时， Sentinel 可以通过 API 向管理员或者其他应用程序发送通知。</li>\n<li><strong>自动故障迁移（Automatic failover）</strong>： 当一个主服务器不能正常工作时， Sentinel 会开始一次自动故障迁移操作， 它会将失效主服务器的其中一个从服务器升级为新的主服务器， 并让失效主服务器的其他从服务器改为复制新的主服务器； 当客户端试图连接失效的主服务器时， 集群也会向客户端返回新主服务器的地址， 使得集群可以使用新主服务器代替失效服务器。</li>\n</ol>\n<p>Redis Sentinel 是一个分布式系统， 你可以在一个架构中运行多个 Sentinel 进程（progress）， 这些进程使用流言协议（gossip protocols)来接收关于主服务器是否下线的信息， 并使用投票协议（agreement protocols）来决定是否执行自动故障迁移， 以及选择哪个从服务器作为新的主服务器。<br>\n虽然 Redis Sentinel 释出为一个单独的可执行文件 redis-sentinel ， 但实际上它只是一个运行在特殊模式下的 Redis 服务器， 你可以在启动一个普通 Redis 服务器时通过给定 –sentinel 选项来启动 Redis Sentinel 。<br>\nRedis Sentinel 目前仍在开发中， 这个文档的内容可能随着 Sentinel 实现的修改而变更。<br>\nRedis Sentinel 兼容 Redis 2.4.16 或以上版本， 推荐使用 Redis 2.8.0 或以上的版本。</p>\n<table>\n<thead>\n<tr>\n<th>概念</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>主观下线和客观下线</td>\n<td>Redis 的 Sentinel 中关于下线（down）有两个不同的概念：\n<p>1. 主观下线（Subjectively Down， 简称 SDOWN）指的是单个 Sentinel 实例对服务器做出的下线判断。</p>\n<p>2. 客观下线（Objectively Down， 简称 ODOWN）指的是多个 Sentinel 实例在对同一个服务器做出 SDOWN 判断， 并且通过 SENTINEL is-master-down-by-addr 命令互相交流之后， 得出的服务器下线判断。 （一个 Sentinel 可以通过向另一个 Sentinel 发送 SENTINEL is-master-down-by-addr 命令来询问对方是否认为给定的服务器已下线。）</p>\n<p>如果一个服务器没有在 master-down-after-milliseconds 选项所指定的时间内， 对向它发送 <a href=\"http://doc.redisfans.com/connection/ping.html#ping\" target=\"_blank\">PING</a> 命令的 Sentinel 返回一个有效回复（valid reply）， 那么 Sentinel 就会将这个服务器标记为主观下线。</p>\n<p>服务器对 <a href=\"http://doc.redisfans.com/connection/ping.html#ping\" target=\"_blank\">PING</a> 命令的有效回复可以是以下三种回复的其中一种：</p>\n<p>1. 返回 +PONG 。</p>\n<p>2. 返回 -LOADING 错误。</p>\n<p>3. 返回 -MASTERDOWN 错误。</p>\n<p>如果服务器返回除以上三种回复之外的其他回复， 又或者在指定时间内没有回复 <a href=\"http://doc.redisfans.com/connection/ping.html#ping\" target=\"_blank\">PING</a> 命令， 那么 Sentinel 认为服务器返回的回复无效（non-valid）。</p>\n<p>注意， 一个服务器必须在 master-down-after-milliseconds 毫秒内， 一直返回无效回复才会被 Sentinel 标记为主观下线。</p>\n<p>举个例子， 如果 master-down-after-milliseconds 选项的值为 30000 毫秒（30 秒）， 那么只要服务器能在每 29 秒之内返回至少一次有效回复， 这个服务器就仍然会被认为是处于正常状态的。</p>\n<p>从主观下线状态切换到客观下线状态并没有使用严格的法定人数算法（strong quorum algorithm）， 而是使用了流言协议： 如果 Sentinel 在给定的时间范围内， 从其他 Sentinel 那里接收到了足够数量的主服务器下线报告， 那么 Sentinel 就会将主服务器的状态从主观下线改变为客观下线。 如果之后其他 Sentinel 不再报告主服务器已下线， 那么客观下线状态就会被移除。</p>\n<p>客观下线条件<strong>只适用于主服务器</strong>： 对于任何其他类型的 Redis 实例， Sentinel 在将它们判断为下线前不需要进行协商， 所以从服务器或者其他 Sentinel 永远不会达到客观下线条件。</p>\n<p>只要一个 Sentinel 发现某个主服务器进入了客观下线状态， 这个 Sentinel 就可能会被其他 Sentinel 推选出， 并对失效的主服务器执行自动故障迁移操作。</p></td>\n</tr>\n<tr>\n<td>每个 Sentinel 都需要定期执行的任务</td>\n<td>1. 每个 Sentinel 以每秒钟一次的频率向它所知的主服务器、从服务器以及其他 Sentinel 实例发送一个 <a href=\"http://doc.redisfans.com/connection/ping.html#ping\" target=\"_blank\">PING</a> 命令。\n<p>2. 如果一个实例（instance）距离最后一次有效回复 <a href=\"http://doc.redisfans.com/connection/ping.html#ping\" target=\"_blank\">PING</a> 命令的时间超过 down-after-milliseconds 选项所指定的值， 那么这个实例会被 Sentinel 标记为主观下线。 一个有效回复可以是： +PONG 、 -LOADING 或者 -MASTERDOWN 。</p>\n<p>3. 如果一个主服务器被标记为主观下线， 那么正在监视这个主服务器的所有 Sentinel 要以每秒一次的频率确认主服务器的确进入了主观下线状态。</p>\n<p>4. 如果一个主服务器被标记为主观下线， 并且有足够数量的 Sentinel （至少要达到配置文件指定的数量）在指定的时间范围内同意这一判断， 那么这个主服务器被标记为客观下线。</p>\n<p>5. 在一般情况下， 每个 Sentinel 会以每 10 秒一次的频率向它已知的所有主服务器和从服务器发送 <a href=\"http://doc.redisfans.com/server/info.html#info\" target=\"_blank\">INFO</a> 命令。 当一个主服务器被 Sentinel 标记为客观下线时， Sentinel 向下线主服务器的所有从服务器发送 <a href=\"http://doc.redisfans.com/server/info.html#info\" target=\"_blank\">INFO</a> 命令的频率会从 10 秒一次改为每秒一次。</p>\n<p>6. 当没有足够数量的 Sentinel 同意主服务器已经下线， 主服务器的客观下线状态就会被移除。 当主服务器重新向 Sentinel 的 <a href=\"http://doc.redisfans.com/connection/ping.html#ping\" target=\"_blank\">PING</a>命令返回有效回复时， 主服务器的主管下线状态就会被移除。</p></td>\n</tr>\n<tr>\n<td>自动发现 Sentinel 和从服务器</td>\n<td>一个 Sentinel 可以与其他多个 Sentinel 进行连接， 各个 Sentinel 之间可以互相检查对方的可用性， 并进行信息交换。\n<p>你无须为运行的每个 Sentinel 分别设置其他 Sentinel 的地址， 因为 Sentinel 可以通过发布与订阅功能来自动发现正在监视相同主服务器的其他 Sentinel ， 这一功能是通过向频道 <strong>sentinel</strong>:hello 发送信息来实现的。</p>\n<p>与此类似， 你也不必手动列出主服务器属下的所有从服务器， 因为 Sentinel 可以通过询问主服务器来获得所有从服务器的信息。</p>\n<p>1. 每个 Sentinel 会以每两秒一次的频率， 通过发布与订阅功能， 向被它监视的所有主服务器和从服务器的 <strong>sentinel</strong>:hello 频道发送一条信息， 信息中包含了 Sentinel 的 IP 地址、端口号和运行 ID （runid）。</p>\n<p>2. 每个 Sentinel 都订阅了被它监视的所有主服务器和从服务器的 <strong>sentinel</strong>:hello 频道， 查找之前未出现过的 sentinel （looking for unknown sentinels）。 当一个 Sentinel 发现一个新的 Sentinel 时， 它会将新的 Sentinel 添加到一个列表中， 这个列表保存了 Sentinel 已知的， 监视同一个主服务器的所有其他 Sentinel 。</p>\n<p>3. Sentinel 发送的信息中还包括完整的主服务器当前配置（configuration）。 如果一个 Sentinel 包含的主服务器配置比另一个 Sentinel 发送的配置要旧， 那么这个 Sentinel 会立即升级到新配置上。</p>\n<p>4. 在将一个新 Sentinel 添加到监视主服务器的列表上面之前， Sentinel 会先检查列表中是否已经包含了和要添加的 Sentinel 拥有相同运行 ID 或者相同地址（包括 IP 地址和端口号）的 Sentinel ， 如果是的话， Sentinel 会先移除列表中已有的那些拥有相同运行 ID 或者相同地址的 Sentinel ， 然后再添加新 Sentinel 。</p></td>\n</tr>\n<tr>\n<td>故障转移</td>\n<td>一次故障转移操作由以下步骤组成：\n<p>1. 发现主服务器已经进入客观下线状态。</p>\n<p>2. 对我们的当前纪元进行自增（详情请参考 <a href=\"https://www.google.com.hk/search?q=Raft+leader+election&amp;client=ubuntu&amp;channel=cs&amp;oq=Raft+leader+election&amp;aqs=chrome..69i57&amp;sourceid=chrome&amp;ie=UTF-8\" target=\"_blank\">Raft leader election</a> ）， 并尝试在这个纪元中当选。</p>\n<p>3. 如果当选失败， 那么在设定的故障迁移超时时间的两倍之后， 重新尝试当选。 如果当选成功， 那么执行以下步骤。</p>\n<p>4. 选出一个从服务器，并将它升级为主服务器。</p>\n<p>5. 向被选中的从服务器发送 SLAVEOF NO ONE 命令，让它转变为主服务器。</p>\n<p>6. 通过发布与订阅功能， 将更新后的配置传播给所有其他 Sentinel ， 其他 Sentinel 对它们自己的配置进行更新。</p>\n<p>7. 向已下线主服务器的从服务器发送 <a href=\"http://doc.redisfans.com/server/slaveof.html#slaveof\" target=\"_blank\">SLAVEOF</a> 命令， 让它们去复制新的主服务器。</p>\n<p>8. 当所有从服务器都已经开始复制新的主服务器时， 领头 Sentinel 终止这次故障迁移操作。</p>\n<p>每当一个 Redis 实例被重新配置（reconfigured） —— 无论是被设置成主服务器、从服务器、又或者被设置成其他主服务器的从服务器 —— Sentinel 都会向被重新配置的实例发送一个 CONFIG REWRITE 命令， 从而确保这些配置会持久化在硬盘里。</p>\n<p>Sentinel 使用以下规则来选择新的主服务器：</p>\n<p>1. 在失效主服务器属下的从服务器当中， 那些被标记为主观下线、已断线、或者最后一次回复 <a href=\"http://doc.redisfans.com/connection/ping.html#ping\" target=\"_blank\">PING</a> 命令的时间大于五秒钟的从服务器都会被淘汰。</p>\n<p>2. 在失效主服务器属下的从服务器当中， 那些与失效主服务器连接断开的时长超过 down-after 选项指定的时长十倍的从服务器都会被淘汰。</p>\n<p>3. 在经历了以上两轮淘汰之后剩下来的从服务器中， 我们选出复制偏移量（replication offset）最大的那个从服务器作为新的主服务器； 如果复制偏移量不可用， 或者从服务器的复制偏移量相同， 那么带有最小运行 ID 的那个从服务器成为新的主服务器。</p>\n<p><strong> Sentinel 自动故障迁移的一致性特质</strong></p>\n<p>Sentinel 自动故障迁移使用 Raft 算法来选举领头（leader） Sentinel ， 从而确保在一个给定的纪元（epoch）里， 只有一个领头产生。</p>\n<p>这表示在同一个纪元中， 不会有两个 Sentinel 同时被选中为领头， 并且各个 Sentinel 在同一个纪元中只会对一个领头进行投票。</p>\n<p>更高的配置纪元总是优于较低的纪元， 因此每个 Sentinel 都会主动使用更新的纪元来代替自己的配置。</p>\n<p>简单来说， 我们可以将 Sentinel 配置看作是一个带有版本号的状态。 一个状态会以最后写入者胜出（last-write-wins）的方式（也即是，最新的配置总是胜出）传播至所有其他 Sentinel 。</p>\n<p>举个例子， 当出现网络分割（<a href=\"http://en.wikipedia.org/wiki/Network_partition\" target=\"_blank\">network partitions</a>）时， 一个 Sentinel 可能会包含了较旧的配置， 而当这个 Sentinel 接到其他 Sentinel 发来的版本更新的配置时， Sentinel 就会对自己的配置进行更新。</p>\n<p>如果要在网络分割出现的情况下仍然保持一致性， 那么应该使用 min-slaves-to-write 选项， 让主服务器在连接的从实例少于给定数量时停止执行写操作， 与此同时， 应该在每个运行 Redis 主服务器或从服务器的机器上运行 Redis Sentinel 进程。</p>\n<p><strong> Sentinel 状态的持久化 </strong></p>\n<p>Sentinel 的状态会被持久化在 Sentinel 配置文件里面。</p>\n<p>每当 Sentinel 接收到一个新的配置， 或者当领头 Sentinel 为主服务器创建一个新的配置时， 这个配置会与配置纪元一起被保存到磁盘里面。</p>\n<p>这意味着停止和重启 Sentinel 进程都是安全的。</p>\n<p><strong> Sentinel 在非故障迁移的情况下对实例进行重新配置</strong></p>\n<p>即使没有自动故障迁移操作在进行， Sentinel 总会尝试将当前的配置设置到被监视的实例上面。 特别是：</p>\n<p>1. 根据当前的配置， 如果一个从服务器被宣告为主服务器， 那么它会代替原有的主服务器， 成为新的主服务器， 并且成为原有主服务器的所有从服务器的复制对象。</p>\n<p>2. 那些连接了错误主服务器的从服务器会被重新配置， 使得这些从服务器会去复制正确的主服务器。</p>\n<p>不过， 在以上这些条件满足之后， Sentinel 在对实例进行重新配置之前仍然会等待一段足够长的时间， 确保可以接收到其他 Sentinel 发来的配置更新， 从而避免自身因为保存了过期的配置而对实例进行了不必要的重新配置。</p></td>\n</tr>\n<tr>\n<td>TILT 模式</td>\n<td>Redis Sentinel 严重依赖计算机的时间功能： 比如说， 为了判断一个实例是否可用， Sentinel 会记录这个实例最后一次相应 <a href=\"http://doc.redisfans.com/connection/ping.html#ping\" target=\"_blank\">PING</a> 命令的时间， 并将这个时间和当前时间进行对比， 从而知道这个实例有多长时间没有和 Sentinel 进行任何成功通讯。\n<p>不过， 一旦计算机的时间功能出现故障， 或者计算机非常忙碌， 又或者进程因为某些原因而被阻塞时， Sentinel 可能也会跟着出现故障。</p>\n<p>TILT 模式是一种特殊的保护模式： 当 Sentinel 发现系统有些不对劲时， Sentinel 就会进入 TILT 模式。</p>\n<p>因为 Sentinel 的时间中断器默认每秒执行 10 次， 所以我们预期时间中断器的两次执行之间的间隔为 100 毫秒左右。 Sentinel 的做法是， 记录上一次时间中断器执行时的时间， 并将它和这一次时间中断器执行的时间进行对比：</p>\n<p>1. 如果两次调用时间之间的差距为负值， 或者非常大（超过 2 秒钟）， 那么 Sentinel 进入 TILT 模式。</p>\n<p>2. 如果 Sentinel 已经进入 TILT 模式， 那么 Sentinel 延迟退出 TILT 模式的时间。</p>\n<p>当 Sentinel 进入 TILT 模式时， 它仍然会继续监视所有目标， 但是：</p>\n<p>1. 它不再执行任何操作，比如故障转移。</p>\n<p>2. 当有实例向这个 Sentinel 发送 SENTINEL is-master-down-by-addr 命令时， Sentinel 返回负值： 因为这个 Sentinel 所进行的下线判断已经不再准确。</p>\n<p>如果 TILT 可以正常维持 30 秒钟， 那么 Sentinel 退出 TILT 模式。</p></td>\n</tr>\n</tbody>\n</table>\n<h3>其他</h3>\n<p><a href=\"http://doc.redisfans.com/topic/cluster-tutorial.html\" target=\"_blank\">集群教程</a><br>\n<a href=\"http://doc.redisfans.com/topic/cluster-spec.html\" target=\"_blank\">Redis 集群规范</a></p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112024\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112024votetotal\">2</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112024\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 12 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "2", "fav_nums": "12", "comment_nums": "", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2016/04/49961db8952e63d98b519b76a2daa5e2.png"]},{"url_object_id": "c7e0ae15f1eab36a802669e93f9b1844", "create_date": "2017/08/02", "front_image_path": "full/0ef7e28a091392634bf93187b140a9a9a1296cf7.jpg", "title": "系统管理员应该知道的 20 条 Linux 命令", "url": "http://blog.jobbole.com/112085/", "tags": "IT技术,Linux,命令,系统管理员", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"https://opensource.com\">OpenSource</a>   译文出处：<a target=\"_blank\" href=\"https://my.oschina.net/editorial-story/blog/1499026\">开源中国/局长</a>   </div><p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/7599b213c6d67d39e4bb2391c276fbb5.png\"><img class=\"aligncenter wp-image-112080 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/7599b213c6d67d39e4bb2391c276fbb5.png\" alt=\"203755_92u8_2918182\" width=\"520\" height=\"292\"></a></p>\n<p>在这个全新的工具和多样化的开发环境井喷的大环境下，任何开发者和工程师都有必要学习一些基本的系统管理命令。特定的命令和工具包可帮助开发者组织、排查故障并优化他们的应用程序，而且当出现错误时，也可以为运维人员和系统管理员提供有价值的分类信息。</p>\n<p>无论你是新手开发者还是希望管理自己的应用程序，下面 20 条基本的系统管理命令都可以帮助您更好地了解您的应用程序。它们还可以帮助解决为什么应用程序可在本地正常工作但不能在远程主机上工作这类的系统故障。这些命令适用于 Linux 开发环境、容器和虚拟机。</p>\n<h1>1. curl</h1>\n<p>curl 用于传输一个 URL。可以使用这条命令用于测试应用程序的端点或与上游服务端点的连接。curl 还可用于检查你的应用程序是否能连接到其他服务，例如数据库，或检查您的服务是否处于健康的状态。</p>\n<p>举个例子，假如你的应用程序抛出一个 HTTP 500 错误，表示无法访问 MongoDB 数据库：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987212035847802981034\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ curl -I -s myapplication:5000\r\n\r\nHTTP/1.0 500 INTERNAL SERVER ERROR</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987212035847802981034-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035847802981034-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987212035847802981034-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987212035847802981034-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">curl</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">I</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">s</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">myapplication</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">5000</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035847802981034-2\"> </div><div class=\"crayon-line\" id=\"crayon-5987212035847802981034-3\"><span class=\"crayon-v\">HTTP</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">1.0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">500</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">INTERNAL </span><span class=\"crayon-e\">SERVER </span><span class=\"crayon-v\">ERROR</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0007 seconds] -->\r\n<p><strong>-I </strong>选项用于显示头信息，<strong>-s </strong>选项表示使用静默模式，不显示错误和进度。检查数据库的端点是否正确：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987212035851743840925\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ curl -I -s database:27017\r\n\r\nHTTP/1.0 200 OK</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987212035851743840925-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035851743840925-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987212035851743840925-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987212035851743840925-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">curl</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">I</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">s</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">database</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">27017</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035851743840925-2\"> </div><div class=\"crayon-line\" id=\"crayon-5987212035851743840925-3\"><span class=\"crayon-v\">HTTP</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">1.0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">200</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OK</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0007 seconds] -->\r\n<p>那么可能是什么问题呢？ 检查您的应用程序是否可以访问数据库以外的其他位置：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987212035855120424579\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ curl -I -s https://opensource.com\r\n\r\nHTTP/1.1 200 OK</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987212035855120424579-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035855120424579-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987212035855120424579-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987212035855120424579-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">curl</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">I</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">s</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">https</span><span class=\"crayon-o\">:</span><span class=\"crayon-c\">//opensource.com</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035855120424579-2\"> </div><div class=\"crayon-line\" id=\"crayon-5987212035855120424579-3\"><span class=\"crayon-v\">HTTP</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">1.1</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">200</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OK</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0007 seconds] -->\r\n<p>看起来这没问题，现在尝试访问数据库。您的应用程序正在使用数据库的主机名，因此请先尝试：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987212035858550735327\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ curl database:27017\r\n\r\ncurl: (6) Couldn't resolve host 'database'</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987212035858550735327-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035858550735327-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987212035858550735327-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987212035858550735327-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">curl </span><span class=\"crayon-v\">database</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">27017</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035858550735327-2\"> </div><div class=\"crayon-line\" id=\"crayon-5987212035858550735327-3\"><span class=\"crayon-v\">curl</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">6</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Couldn</span><span class=\"crayon-s\">'t resolve host '</span><span class=\"crayon-i\">database</span>'</div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0006 seconds] -->\r\n<p>这表示您的应用程序无法解析数据库，因为数据库的 URL 不可用或主机（容器或VM）没有可用于解析主机名的域名服务器。</p>\n<h1>2. python -m json.tool / jq</h1>\n<p>使用 curl 后，API 调用的输出可读性可能较差。有时候，你希望将生成的 JSON 数据格式化输出以查找特定的条目。Python 有一个内置的库可帮助您实现这个需求。可以使用 <strong>python -m json.tool </strong>来缩进和组织 JSON。要使用 Python 的 JSON 模块，需要使用管道机制，将 JSON 文件的输出作为输入，写入到 <strong>python -m json.tool</strong> 命令行。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721203585b656210461\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ cat test.json\r\n{\"title\":\"Person\",\"type\":\"object\",\"properties\":{\"firstName\":{\"type\":\"string\"},\"lastName\":{\"type\":\"string\"},\"age\":{\"description\":\"Age in years\",\"type\":\"integer\",\"minimum\":0}},\"required\":[\"firstName\",\"lastName\"]}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721203585b656210461-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203585b656210461-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721203585b656210461-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">cat </span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">json</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203585b656210461-2\"><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"title\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"Person\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"object\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">\"properties\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"firstName\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"string\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">\"lastName\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"string\"</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">\"age\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-sy\">{</span><span class=\"crayon-s\">\"description\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"Age in years\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-s\">\"integer\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">\"minimum\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">\"required\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-sy\">[</span><span class=\"crayon-s\">\"firstName\"</span><span class=\"crayon-sy\">,</span><span class=\"crayon-s\">\"lastName\"</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0012 seconds] -->\r\n<p>要使用 Python 库，使用 <strong>-m</strong> (module) 选项将输出内容和 Python 库组合成管道。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721203585f199393477\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ cat test.json | python -m json.tool\r\n{\r\n    \"properties\": {\r\n        \"age\": {\r\n            \"description\": \"Age in years\",\r\n            \"minimum\": 0,\r\n            \"type\": \"integer\"\r\n        },\r\n        \"firstName\": {\r\n            \"type\": \"string\"\r\n        },\r\n        \"lastName\": {\r\n            \"type\": \"string\"\r\n        }\r\n    },\r\n    \"required\": [\r\n        \"firstName\",\r\n        \"lastName\"\r\n    ],\r\n    \"title\": \"Person\",\r\n    \"type\": \"object\"\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721203585f199393477-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203585f199393477-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-598721203585f199393477-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203585f199393477-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-598721203585f199393477-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203585f199393477-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-598721203585f199393477-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203585f199393477-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-598721203585f199393477-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203585f199393477-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-598721203585f199393477-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203585f199393477-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-598721203585f199393477-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203585f199393477-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-598721203585f199393477-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203585f199393477-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-598721203585f199393477-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203585f199393477-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-598721203585f199393477-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203585f199393477-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-598721203585f199393477-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203585f199393477-22\">22</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721203585f199393477-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">cat </span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">json</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">python</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">m</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">json</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">tool</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203585f199393477-2\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-598721203585f199393477-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"properties\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203585f199393477-4\"><span class=\"crayon-h\">        </span><span class=\"crayon-s\">\"age\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-598721203585f199393477-5\"><span class=\"crayon-h\">            </span><span class=\"crayon-s\">\"description\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"Age in years\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203585f199393477-6\"><span class=\"crayon-h\">            </span><span class=\"crayon-s\">\"minimum\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-598721203585f199393477-7\"><span class=\"crayon-h\">            </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"integer\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203585f199393477-8\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-598721203585f199393477-9\"><span class=\"crayon-h\">        </span><span class=\"crayon-s\">\"firstName\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203585f199393477-10\"><span class=\"crayon-h\">            </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"string\"</span></div><div class=\"crayon-line\" id=\"crayon-598721203585f199393477-11\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203585f199393477-12\"><span class=\"crayon-h\">        </span><span class=\"crayon-s\">\"lastName\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-598721203585f199393477-13\"><span class=\"crayon-h\">            </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"string\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203585f199393477-14\"><span class=\"crayon-h\">        </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-598721203585f199393477-15\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203585f199393477-16\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"required\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-598721203585f199393477-17\"><span class=\"crayon-h\">        </span><span class=\"crayon-s\">\"firstName\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203585f199393477-18\"><span class=\"crayon-h\">        </span><span class=\"crayon-s\">\"lastName\"</span></div><div class=\"crayon-line\" id=\"crayon-598721203585f199393477-19\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203585f199393477-20\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"title\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"Person\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-598721203585f199393477-21\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"object\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203585f199393477-22\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0022 seconds] -->\r\n<p>对于更高级的 JSON 解析，可以安装 <strong><a href=\"https://stedolan.github.io/jq/download/\" target=\"_blank\" rel=\"nofollow\">jq</a>。j</strong><strong>q </strong>提供了一些从 JSON 输入中提取特定值的选项。要像上面的 Python 模块一样将 JSON 输出格式化，只需将 jq 应用到输出即可。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987212035866535611900\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ cat test.json | jq\r\n{\r\n  \"title\": \"Person\",\r\n  \"type\": \"object\",\r\n  \"properties\": {\r\n    \"firstName\": {\r\n      \"type\": \"string\"\r\n    },\r\n    \"lastName\": {\r\n      \"type\": \"string\"\r\n    },\r\n    \"age\": {\r\n      \"description\": \"Age in years\",\r\n      \"type\": \"integer\",\r\n      \"minimum\": 0\r\n    }\r\n  },\r\n  \"required\": [\r\n    \"firstName\",\r\n    \"lastName\"\r\n  ]\r\n}</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987212035866535611900-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035866535611900-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987212035866535611900-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035866535611900-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987212035866535611900-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035866535611900-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5987212035866535611900-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035866535611900-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-5987212035866535611900-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035866535611900-10\">10</div><div class=\"crayon-num\" data-line=\"crayon-5987212035866535611900-11\">11</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035866535611900-12\">12</div><div class=\"crayon-num\" data-line=\"crayon-5987212035866535611900-13\">13</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035866535611900-14\">14</div><div class=\"crayon-num\" data-line=\"crayon-5987212035866535611900-15\">15</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035866535611900-16\">16</div><div class=\"crayon-num\" data-line=\"crayon-5987212035866535611900-17\">17</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035866535611900-18\">18</div><div class=\"crayon-num\" data-line=\"crayon-5987212035866535611900-19\">19</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035866535611900-20\">20</div><div class=\"crayon-num\" data-line=\"crayon-5987212035866535611900-21\">21</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035866535611900-22\">22</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987212035866535611900-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">cat </span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">json</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">jq</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035866535611900-2\"><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987212035866535611900-3\"><span class=\"crayon-h\">  </span><span class=\"crayon-s\">\"title\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"Person\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035866535611900-4\"><span class=\"crayon-h\">  </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"object\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5987212035866535611900-5\"><span class=\"crayon-h\">  </span><span class=\"crayon-s\">\"properties\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035866535611900-6\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"firstName\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987212035866535611900-7\"><span class=\"crayon-h\">      </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"string\"</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035866535611900-8\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5987212035866535611900-9\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"lastName\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035866535611900-10\"><span class=\"crayon-h\">      </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"string\"</span></div><div class=\"crayon-line\" id=\"crayon-5987212035866535611900-11\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035866535611900-12\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"age\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">{</span></div><div class=\"crayon-line\" id=\"crayon-5987212035866535611900-13\"><span class=\"crayon-h\">      </span><span class=\"crayon-s\">\"description\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"Age in years\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035866535611900-14\"><span class=\"crayon-h\">      </span><span class=\"crayon-s\">\"type\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-s\">\"integer\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line\" id=\"crayon-5987212035866535611900-15\"><span class=\"crayon-h\">      </span><span class=\"crayon-s\">\"minimum\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035866535611900-16\"><span class=\"crayon-h\">    </span><span class=\"crayon-sy\">}</span></div><div class=\"crayon-line\" id=\"crayon-5987212035866535611900-17\"><span class=\"crayon-h\">  </span><span class=\"crayon-sy\">}</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035866535611900-18\"><span class=\"crayon-h\">  </span><span class=\"crayon-s\">\"required\"</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span></div><div class=\"crayon-line\" id=\"crayon-5987212035866535611900-19\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"firstName\"</span><span class=\"crayon-sy\">,</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035866535611900-20\"><span class=\"crayon-h\">    </span><span class=\"crayon-s\">\"lastName\"</span></div><div class=\"crayon-line\" id=\"crayon-5987212035866535611900-21\"><span class=\"crayon-h\">  </span><span class=\"crayon-sy\">]</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035866535611900-22\"><span class=\"crayon-sy\">}</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0024 seconds] -->\r\n<p></p>\n<h1>3. ls</h1>\n<p><strong>ls </strong>用于列出目录中的文件，系统管理员和开发者会经常使用这个命令。在容器空间中，这条命令可以帮助确定容器镜像中的目录和文件。除了查找文件，<strong>ls </strong>还可以用于检查权限。下面的示例中，由于权限问题，你不能运行 myapp。当你使用 <strong>ls -l </strong>检查权限时，你会发现它的权限在 <strong>-rw-r–r–</strong> 中没有”x”，只有读写的权限。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721203586d676230388\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ ./myapp\r\nbash: ./myapp: Permission denied\r\n$ ls -l myapp\r\n-rw-r--r--. 1 root root 33 Jul 21 18:36 myapp</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721203586d676230388-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203586d676230388-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-598721203586d676230388-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203586d676230388-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721203586d676230388-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">myapp</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203586d676230388-2\"><span class=\"crayon-v\">bash</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">.</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">myapp</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Permission </span><span class=\"crayon-i\">denied</span></div><div class=\"crayon-line\" id=\"crayon-598721203586d676230388-3\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ls</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">l</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">myapp</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203586d676230388-4\"><span class=\"crayon-o\">-</span><span class=\"crayon-v\">rw</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">r</span><span class=\"crayon-o\">--</span><span class=\"crayon-v\">r</span><span class=\"crayon-o\">--</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">root </span><span class=\"crayon-i\">root</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">33</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jul</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">21</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">36</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">myapp</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p></p>\n<h1>4. tail</h1>\n<p><strong>tail </strong>显示文件的最后一部分内容。通常情况下，你不需要浏览每行日志以进行故障排除。而是需要检查日志中对应用程序的最新请求的说明。例如，当你向 Apache HTTP 服务器发起请求时，可以使用 <strong>tail</strong> 来检查日志中发生的情况。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/d3bb1474cbffe499ef82ea809c54c078.png\"><img class=\"aligncenter wp-image-112081 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/d3bb1474cbffe499ef82ea809c54c078.png\" alt=\"205506_GAYc_2918182\" width=\"800\" height=\"321\"></a></p>\n<p><em>使用 <strong>tail -f </strong>来跟踪日志文件并在发起请求时查看它们。</em></p>\n<p><strong>-f</strong> 选项表示跟随的意思，它可在日志被写入文件时输出它们。下面的示例具有每隔几秒访问端点的后台脚本，日志会记录请求。除了实时跟踪日志，还可以使用 <strong>tail </strong>带上 <strong>-n </strong>选项来查看文件的最后 100 行。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987212035874262463466\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ tail -n 100 /var/log/httpd/access_log</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987212035874262463466-1\">1</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987212035874262463466-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tail</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">n</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">100</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">httpd</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">access_log</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0006 seconds] -->\r\n<p></p>\n<h1>5. cat</h1>\n<p><strong>cat </strong>主要用于查看文件内容和合并文件。你可能会使用 <strong>cat </strong>来检查依赖项文件的内容，或确认已在本地构建的应用程序的版本。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987212035879470374759\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ cat requirements.txt\r\nflask\r\nflask_pymongo</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987212035879470374759-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035879470374759-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987212035879470374759-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987212035879470374759-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">cat </span><span class=\"crayon-v\">requirements</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">txt</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035879470374759-2\"><span class=\"crayon-e\">flask</span></div><div class=\"crayon-line\" id=\"crayon-5987212035879470374759-3\"><span class=\"crayon-v\">flask_pymongo</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p>上面的示例检查您的 Python Flask 应用程序是否已将 Flask 列为依赖项。</p>\n<h1>6. grep</h1>\n<p>grep 能使用特定模式匹配（包括正则表达式）搜索文本。如果你在另一条命令的输出中寻找特定的模式，<strong>grep </strong>会高亮显示相关的行。可使用这条命令来搜索日志文件以及特定的进程等。如果想查看 Apache Tomcat 是否启动，你可能会命令行的数量给淹没。但讲输出的内容和 <strong>grep </strong>命令组合成管道，可以将表示服务器已启动的行独立出来。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721203587f024209885\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ cat tomcat.log | grep org.apache.catalina.startup.Catalina.start\r\n01-Jul-2017 18:03:47.542 INFO [main] org.apache.catalina.startup.Catalina.start Server startup in 681 ms</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721203587f024209885-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203587f024209885-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721203587f024209885-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">cat </span><span class=\"crayon-v\">tomcat</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">log</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">grep </span><span class=\"crayon-v\">org</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">apache</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">catalina</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">startup</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">Catalina</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">start</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203587f024209885-2\"><span class=\"crayon-cn\">01</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">Jul</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">2017</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">03</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">47.542</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">INFO</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">main</span><span class=\"crayon-sy\">]</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">org</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">apache</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">catalina</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">startup</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">Catalina</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">start </span><span class=\"crayon-e\">Server </span><span class=\"crayon-e\">startup </span><span class=\"crayon-st\">in</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">681</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ms</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0014 seconds] -->\r\n<p></p>\n<h1>7. ps</h1>\n<p><strong>ps </strong>用于查看进程的各种状态信息。使用该命令可确定正在运行的应用程序或确认预期的进程。例如，如果要检查正在运行的 Tomcat Web 服务器，可使用带有选项的 <strong>ps </strong>来获取 Tomcat 的进程 ID。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987212035885181995531\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ ps -ef\r\nUID        PID  PPID  C STIME TTY          TIME CMD\r\nroot         1     0  2 18:55 ?        00:00:02 /docker-java-home/jre/bi\r\nroot        59     0  0 18:55 pts/0    00:00:00 /bin/sh\r\nroot        75    59  0 18:57 pts/0    00:00:00 ps -ef</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987212035885181995531-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035885181995531-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987212035885181995531-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035885181995531-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987212035885181995531-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987212035885181995531-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ps</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">ef</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035885181995531-2\"><span class=\"crayon-e\">UID        </span><span class=\"crayon-e\">PID  </span><span class=\"crayon-i\">PPID</span><span class=\"crayon-h\">  </span><span class=\"crayon-i\">C</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">STIME </span><span class=\"crayon-e\">TTY          </span><span class=\"crayon-e\">TIME </span><span class=\"crayon-e\">CMD</span></div><div class=\"crayon-line\" id=\"crayon-5987212035885181995531-3\"><span class=\"crayon-i\">root</span><span class=\"crayon-h\">         </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\">     </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">55</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\">        </span><span class=\"crayon-cn\">00</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">00</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">02</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">docker</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">java</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">home</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">jre</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">bi</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035885181995531-4\"><span class=\"crayon-i\">root</span><span class=\"crayon-h\">        </span><span class=\"crayon-cn\">59</span><span class=\"crayon-h\">     </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">55</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">pts</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\">    </span><span class=\"crayon-cn\">00</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">00</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">00</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">bin</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">sh</span></div><div class=\"crayon-line\" id=\"crayon-5987212035885181995531-5\"><span class=\"crayon-i\">root</span><span class=\"crayon-h\">        </span><span class=\"crayon-cn\">75</span><span class=\"crayon-h\">    </span><span class=\"crayon-cn\">59</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">57</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">pts</span><span class=\"crayon-o\">/</span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\">    </span><span class=\"crayon-cn\">00</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">00</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">00</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ps</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">ef</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0021 seconds] -->\r\n<p>为了更好的易读性，可使用 <strong>grep </strong>和 <strong>ps </strong>组合成管道。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721203588b028799403\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ ps -ef | grep tomcat\r\nroot         1     0  1 18:55 ?        00:00:02 /docker-java-home/jre/bi</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721203588b028799403-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203588b028799403-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721203588b028799403-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ps</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">ef</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">|</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">grep </span><span class=\"crayon-e\">tomcat</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203588b028799403-2\"><span class=\"crayon-i\">root</span><span class=\"crayon-h\">         </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\">     </span><span class=\"crayon-cn\">0</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">18</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">55</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">?</span><span class=\"crayon-h\">        </span><span class=\"crayon-cn\">00</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">00</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">02</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">docker</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">java</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">home</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">jre</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">bi</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0011 seconds] -->\r\n<p></p>\n<h1>8. env</h1>\n<p><strong>env </strong>用于列出所有环境变量及为其赋值。在故障排除期间，你可能会发现需要检查是否有错误的环境变量来阻止应用程序启动。在下面的示例中，该命令用于检查程序主机上设置的环境变量。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721203588f635602484\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ env\r\nPYTHON_PIP_VERSION=9.0.1\r\nHOME=/root\r\nDB_NAME=test\r\nPATH=/usr/local/bin:/usr/local/sbin\r\nLANG=C.UTF-8\r\nPYTHON_VERSION=3.4.6\r\nPWD=/\r\nDB_URI=mongodb://database:27017/test</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721203588f635602484-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203588f635602484-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-598721203588f635602484-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203588f635602484-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-598721203588f635602484-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203588f635602484-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-598721203588f635602484-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203588f635602484-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-598721203588f635602484-9\">9</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721203588f635602484-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">env</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203588f635602484-2\"><span class=\"crayon-v\">PYTHON_PIP_VERSION</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">9.0.1</span></div><div class=\"crayon-line\" id=\"crayon-598721203588f635602484-3\"><span class=\"crayon-v\">HOME</span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">root</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203588f635602484-4\"><span class=\"crayon-v\">DB_NAME</span><span class=\"crayon-o\">=</span><span class=\"crayon-e\">test</span></div><div class=\"crayon-line\" id=\"crayon-598721203588f635602484-5\"><span class=\"crayon-v\">PATH</span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">usr</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">local</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">bin</span><span class=\"crayon-o\">:</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">usr</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">local</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">sbin</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203588f635602484-6\"><span class=\"crayon-v\">LANG</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">C</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">UTF</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">8</span></div><div class=\"crayon-line\" id=\"crayon-598721203588f635602484-7\"><span class=\"crayon-v\">PYTHON_VERSION</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">3.4.6</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203588f635602484-8\"><span class=\"crayon-v\">PWD</span><span class=\"crayon-o\">=</span><span class=\"crayon-o\">/</span></div><div class=\"crayon-line\" id=\"crayon-598721203588f635602484-9\"><span class=\"crayon-v\">DB_URI</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">mongodb</span><span class=\"crayon-o\">:</span><span class=\"crayon-c\">//database:27017/test</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p>请注意，该应用程序正在使用 Python 3，并具有连接到 MongoDB 数据库的环境变量。</p>\n<h1>9. top</h1>\n<p><strong>top </strong>用于显示系统中各个进程的信息和资源占用状况，类似于 Windows 的任务管理器。使用该命令可确定哪些进程正在运行，以及它们消耗了多少的内存和 CPU。一种常见的情况是当你运行一个应用程序时，它在一分钟后挂掉。这时，你首先检查应用程序的返回错误，发现是一个内存错误。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987212035892140465843\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ tail myapp.log\r\nTraceback (most recent call last):\r\nMemoryError</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987212035892140465843-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035892140465843-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987212035892140465843-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987212035892140465843-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">tail </span><span class=\"crayon-v\">myapp</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">log</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035892140465843-2\"><span class=\"crayon-e\">Traceback</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-e\">most </span><span class=\"crayon-e\">recent </span><span class=\"crayon-e\">call </span><span class=\"crayon-v\">last</span><span class=\"crayon-sy\">)</span><span class=\"crayon-o\">:</span></div><div class=\"crayon-line\" id=\"crayon-5987212035892140465843-3\"><span class=\"crayon-v\">MemoryError</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0006 seconds] -->\r\n<p>你的应用是否真的内存不足？要确认这个问题，可使用 <strong>top </strong>来查看应用程序消耗多少 CPU 和内存。当使用 <strong>top </strong>命令后，您注意到一个 Python 应用程序使用了大部分的 CPU，其内存使用量也迅速攀升。当它运行时，如果进程是你的应用程序，则按”C”键来查看完整命令并进行逆向工程。发现原来是你的内存密集型应用程序(<strong>memeater.py</strong>)。当你的应用程序已经用尽内存，系统会杀掉它并返回一个内存不足(OOM)的错误。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/eeb3863a3e031513712e9556d1c6eeed.png\"><img class=\"aligncenter wp-image-112086 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/eeb3863a3e031513712e9556d1c6eeed.png\" alt=\"205506_GAYc_2918182\" width=\"800\" height=\"332\"></a></p>\n<p><em>应用程序的内存和 CPU 使用量增加，最终因为内存不足而被杀掉。</em></p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/8cef41f3180be447f1405efebfc8420c.png\"><img class=\"aligncenter wp-image-112087 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/8cef41f3180be447f1405efebfc8420c.png\" alt=\"205506_GAYc_2918182\" width=\"800\" height=\"290\"></a></p>\n<p><em>通过按下”C”键，可以看到启动该应用程序的完整命令</em></p>\n<p>除了检查应用程序，还可以使用 <strong>top </strong>来调试其他使用 CPU 或内存的进程。</p>\n<h1>10. netstat</h1>\n<p><strong>netstat </strong>用于显示网络状态信息。该命令可显示正在使用的网络端口及其传入连接。但是，<strong>netstat </strong>在 Linux 中不能开箱即用。如果需要安装它，需要在 <strong><a href=\"https://wiki.linuxfoundation.org/networking/net-tools\" target=\"_blank\" rel=\"nofollow\">net-tools</a> </strong>包中找到它。作为在本地进行试验或将应用程序推送到主机的开发者，可能会收到端口已被分配或地址已被使用的错误。使用 <strong>netstat</strong> 得到协议、进程和端口这些信息，下图表明 Apache HTTP 服务器已经在下面的主机上使用了 80 端口。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/da463bd1dfe1c75df76fff92f6fa4842.png\"><img class=\"aligncenter wp-image-112088 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/da463bd1dfe1c75df76fff92f6fa4842.png\" alt=\"205506_GAYc_2918182\" width=\"800\" height=\"284\"></a></p>\n<p><em>使用 <strong>netstat -tulpn </strong>表明 Apache 已经在这台机器上使用了 80 端口。</em></p>\n<h1>11. ip address</h1>\n<p>如果 <strong>ip address </strong>在你的主机上不能使用，必须使用 <strong><a href=\"https://wiki.linuxfoundation.org/networking/iproute2\" target=\"_blank\" rel=\"nofollow\">iproute2</a> </strong>包进行安装。<strong>i</strong><strong>p address </strong>用于显示应用程序的主机接口和 IP 地址。可使用 <strong>i</strong><strong>p address </strong>来验证你的容器或主机的 IP 地址。例如，当你的容器连接到两个网络时，<strong>i</strong><strong>p address </strong>可显示哪个接口连接到了哪个网络。对于简单的检查，可以随时使用 <strong>ip address </strong>命令获取主机的 IP 地址。下面的示例展示了在接口 eth0 上的 Web 层容器的 IP 地址为 172.17.0.2</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/f47acafef2423ba78048bffb330f5a06.png\"><img class=\"aligncenter wp-image-112089 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/f47acafef2423ba78048bffb330f5a06.png\" alt=\"205506_GAYc_2918182\" width=\"800\" height=\"89\"></a></p>\n<p><em>使用 <strong>ip address </strong>显示 eth0 接口的 IP 地址为 172.17.0.2</em></p>\n<h1>12. lsof</h1>\n<p><strong>lsof </strong>用于列出当前系统打开的文件(list open files)。在某些 Linux 系统中，可能需要使用 <a href=\"http://www.linuxfromscratch.org/blfs/view/svn/general/lsof.html\" target=\"_blank\" rel=\"nofollow\">lsof</a> 包来安装<strong>lsof</strong>。在 Linux 中，几乎任何和系统的交互都被视为一个文件。因此，如果你的应用程序写入文件或代开网络连接，<strong>lsof </strong>将会把这个交互映射为一个文件。与 <strong>netstat </strong>类似，可使用 <strong>lsof </strong>来检查侦听端口。例如，如果要检查 80 端口是否正在被使用，可使用 <strong>lsof </strong>来检查哪个进程正在使用它。下面的示例中，可以看到 httpd (Apache) 在 80 端口上侦听。还可以使用 <strong>lsof </strong>来检查 httpd 的进程ID，检查 Web 服务器的二进制文件所在位置(<strong>/usr/sbin/httpd</strong>)。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/c03a535f9ce77f7c52d661cbdd907bfe.png\"><img class=\"aligncenter wp-image-112090 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/c03a535f9ce77f7c52d661cbdd907bfe.png\" alt=\"205506_GAYc_2918182\" width=\"800\" height=\"252\"></a></p>\n<p><em><strong>Lsof </strong>表明了 httpd 在 80 端口上侦听。检查 httpd 的进程ID还可以显示所有需要运行的文件httpd。</em></p>\n<p>打开文件列表中的打开文件的名称有助于确定进程的来源，特别是 Apache。</p>\n<h1>13. df</h1>\n<p>可以使用 <strong>df</strong> 显示空闲的磁盘空间(display free disk space)以排查磁盘空间问题。挡在容器管理器上运行应用程序时，可能会收到一条错误信息，提示容器主机上缺少可用空间。虽然磁盘空间应该由系统管理程序来管理和优化，你仍可以使用 <strong>df </strong>找出目录中的现有空间并确认是否没有空间。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/d4981e341da22b6f3dd72ffc98003b59.png\"><img class=\"aligncenter wp-image-112091 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/d4981e341da22b6f3dd72ffc98003b59.png\" alt=\"205506_GAYc_2918182\" width=\"800\" height=\"258\"></a></p>\n<p><em><strong>Df</strong> 显示每个文件系统的磁盘空间、绝对空间以及其可用性。</em></p>\n<p><strong>-h </strong>选项表示以可读性较高的方式来显示信息，上面的例子表示这个主机具有大量的磁盘空间。</p>\n<h1>14. du</h1>\n<p><strong>du</strong> 命令也是用于查看使用空间的，但是与 df 命令不同的是 du 命令是对文件和目录磁盘使用的空间的查看，要获取有关哪些文件在目录中使用磁盘空间的更多详细信息，可以使用 du 命令，和 df 命令还是有一些区别的。例如，你想了解那个日志文件占用 <strong>/var/log </strong>目录最多的空间，可以使用 <strong>du</strong> 命令加上 <strong>-h</strong> 选项和用于获取总大小的 <strong>-s </strong>选项。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-5987212035899594099458\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ du -sh /var/log/*\r\n1.8M  /var/log/anaconda\r\n384K  /var/log/audit\r\n4.0K  /var/log/boot.log\r\n0 /var/log/chrony\r\n4.0K  /var/log/cron\r\n4.0K  /var/log/maillog\r\n64K /var/log/messages</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-5987212035899594099458-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035899594099458-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-5987212035899594099458-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035899594099458-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-5987212035899594099458-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035899594099458-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-5987212035899594099458-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-5987212035899594099458-8\">8</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-5987212035899594099458-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">du</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">sh</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-o\">*</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035899594099458-2\"><span class=\"crayon-cn\">1.8M</span><span class=\"crayon-h\">  </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-i\">anaconda</span></div><div class=\"crayon-line\" id=\"crayon-5987212035899594099458-3\"><span class=\"crayon-cn\">384K</span><span class=\"crayon-h\">  </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-i\">audit</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035899594099458-4\"><span class=\"crayon-cn\">4.0K</span><span class=\"crayon-h\">  </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">boot</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">log</span></div><div class=\"crayon-line\" id=\"crayon-5987212035899594099458-5\"><span class=\"crayon-cn\">0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-i\">chrony</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035899594099458-6\"><span class=\"crayon-cn\">4.0K</span><span class=\"crayon-h\">  </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-i\">cron</span></div><div class=\"crayon-line\" id=\"crayon-5987212035899594099458-7\"><span class=\"crayon-cn\">4.0K</span><span class=\"crayon-h\">  </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-i\">maillog</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-5987212035899594099458-8\"><span class=\"crayon-cn\">64K</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">/</span><span class=\"crayon-t\">var</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">log</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">messages</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0017 seconds] -->\r\n<p>上面的示例中显示了 <strong>/var/log </strong>下的的最大目录为 <strong>/var/log/audit</strong>。可以将 <strong>du</strong> 和 <strong>df</strong> 搭配使用，以确定在应用程序的主机上使用的磁盘空间。</p>\n<h1>15. id</h1>\n<p>要检查运行应用程序的用户，可使用 <strong>id </strong>命令来返回用户身份。<strong>id </strong>命令可以显示真实有效的用户ID(UID)和组ID(GID)。下面的示例使用 <a href=\"https://www.vagrantup.com/\" target=\"_blank\" rel=\"nofollow\">Vagrant</a> 来测试应用程序并隔离其开发环境。登录进 Vagrant 盒子后，如果尝试安装 Apache HTTP Server（依赖关系），系统会提示你需要以 root 身份执行该命令。要检查你的用户ID和组ID，使用 <strong>id </strong>命令，会发现你正在”vagrant”组中以”vagrant”用户身份运行。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598721203589d365148044\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ yum -y install httpd\r\nLoaded plugins: fastestmirror\r\nYou need to be root to perform this command.\r\n$ id\r\nuid=1000(vagrant) gid=1000(vagrant) groups=1000(vagrant) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598721203589d365148044-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203589d365148044-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-598721203589d365148044-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598721203589d365148044-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-598721203589d365148044-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598721203589d365148044-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">yum</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">y</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">install </span><span class=\"crayon-e\">httpd</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203589d365148044-2\"><span class=\"crayon-e\">Loaded </span><span class=\"crayon-v\">plugins</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">fastestmirror</span></div><div class=\"crayon-line\" id=\"crayon-598721203589d365148044-3\"><span class=\"crayon-e\">You </span><span class=\"crayon-e\">need </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">be </span><span class=\"crayon-e\">root </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">perform </span><span class=\"crayon-r\">this</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">command</span><span class=\"crayon-sy\">.</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598721203589d365148044-4\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">id</span></div><div class=\"crayon-line\" id=\"crayon-598721203589d365148044-5\"><span class=\"crayon-v\">uid</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">1000</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">vagrant</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">gid</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">1000</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">vagrant</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">groups</span><span class=\"crayon-o\">=</span><span class=\"crayon-cn\">1000</span><span class=\"crayon-sy\">(</span><span class=\"crayon-v\">vagrant</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">context</span><span class=\"crayon-o\">=</span><span class=\"crayon-v\">unconfined_u</span><span class=\"crayon-o\">:</span><span class=\"crayon-v\">unconfined_r</span><span class=\"crayon-o\">:</span><span class=\"crayon-v\">unconfined_t</span><span class=\"crayon-o\">:</span><span class=\"crayon-v\">s0</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">s0</span><span class=\"crayon-o\">:</span><span class=\"crayon-v\">c0</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">c1023</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0016 seconds] -->\r\n<p>要解决此问题，必须以超级用户的身份运行该命令，这将提供提升的权限。</p>\n<h1>16. chmod</h1>\n<p><strong>c</strong><strong>hmod</strong> 命令用来变更文件或目录的权限。当你在主机上首次运行应用程序的二进制文件时，可能会收到错误提示信息“拒绝访问”。如 <strong>ls </strong>的示例所示，可以用于检查应用程序二进制文件的权限。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59872120358a1284321516\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ ls -l\r\ntotal 4\r\n-rw-rw-r--. 1 vagrant vagrant 34 Jul 11 02:17 test.sh</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59872120358a1284321516-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358a1284321516-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59872120358a1284321516-3\">3</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59872120358a1284321516-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ls</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">l</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358a1284321516-2\"><span class=\"crayon-i\">total</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span></div><div class=\"crayon-line\" id=\"crayon-59872120358a1284321516-3\"><span class=\"crayon-o\">-</span><span class=\"crayon-v\">rw</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">rw</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">r</span><span class=\"crayon-o\">--</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">vagrant </span><span class=\"crayon-i\">vagrant</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">34</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jul</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">02</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">17</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">sh</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0011 seconds] -->\r\n<p>这表明您没有权限（没有“x”）来运行二进制文件。<strong>c</strong><strong>hmod </strong>可以修改权限，使的用户能够运行二进制文件。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59872120358a4853083764\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ chmod +x test.sh\r\n[vagrant@localhost ~]$ ls -l\r\ntotal 4\r\n-rwxrwxr-x. 1 vagrant vagrant 34 Jul 11 02:17 test.sh</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59872120358a4853083764-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358a4853083764-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59872120358a4853083764-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358a4853083764-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59872120358a4853083764-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">chmod</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-i\">x</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">sh</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358a4853083764-2\"><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">vagrant</span><span class=\"crayon-sy\">@</span><span class=\"crayon-v\">localhost</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">~</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ls</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">l</span></div><div class=\"crayon-line\" id=\"crayon-59872120358a4853083764-3\"><span class=\"crayon-i\">total</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">4</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358a4853083764-4\"><span class=\"crayon-o\">-</span><span class=\"crayon-v\">rwxrwxr</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">x</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">vagrant </span><span class=\"crayon-i\">vagrant</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">34</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">Jul</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">11</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">02</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">17</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">test</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">sh</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p>如例子所示，这将更新权限，使其具有可执行的权限。现在当你尝试执行二进制文件时，应用程序不会抛出拒绝访问的错误。当将二进制文件加载到容器时，<strong>Chmod</strong> 可能很有用。它能保证容器具有合适的权限以执行二进制文件。</p>\n<h1>17. dig / nslookup</h1>\n<p><strong>dig </strong>命令是常用的域名查询工具，可以用来测试域名系统工作是否正常。域名服务器(DNS)有助于将 URL 解析为一组应用程序服务器。然而，你会发现有些 URL 不能被解析，这会导致应用程序的连接问题。例如，假如你尝试从应用程序的主机访问你的数据库。你收到一个”不能解析”的错误。要进行故障排查，你尝试使用 <strong>dig</strong>（DNS 查询工具）或 <strong>nslookup</strong>（查询 Internet 域名服务器）来确定应用程序似乎无法解析数据的原因。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59872120358a8382222849\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ nslookup mydatabase\r\nServer:   10.0.2.3\r\nAddress:  10.0.2.3#53\r\n\r\n** server can't find mydatabase: NXDOMAIN</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59872120358a8382222849-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358a8382222849-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59872120358a8382222849-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358a8382222849-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59872120358a8382222849-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59872120358a8382222849-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">nslookup </span><span class=\"crayon-e\">mydatabase</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358a8382222849-2\"><span class=\"crayon-v\">Server</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">   </span><span class=\"crayon-cn\">10.0.2.3</span></div><div class=\"crayon-line\" id=\"crayon-59872120358a8382222849-3\"><span class=\"crayon-v\">Address</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">  </span><span class=\"crayon-cn\">10.0.2.3</span><span class=\"crayon-p\">#53</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358a8382222849-4\"> </div><div class=\"crayon-line\" id=\"crayon-59872120358a8382222849-5\"><span class=\"crayon-o\">*</span><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">server </span><span class=\"crayon-i\">can</span>'<span class=\"crayon-i\">t</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">find </span><span class=\"crayon-v\">mydatabase</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">NXDOMAIN</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0009 seconds] -->\r\n<p>使用 <strong>nslookup </strong>显示无法解析 <strong>mydatabase</strong>。尝试使用 <strong>dig </strong>解决，但仍是相同的结果。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59872120358ad797149618\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ dig mydatabase\r\n\r\n; &lt;&lt;&gt;&gt; DiG 9.9.4-RedHat-9.9.4-50.el7_3.1 &lt;&lt;&gt;&gt; mydatabase\r\n;; global options: +cmd\r\n;; connection timed out; no servers could be reached</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59872120358ad797149618-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358ad797149618-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59872120358ad797149618-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358ad797149618-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59872120358ad797149618-5\">5</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59872120358ad797149618-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">dig </span><span class=\"crayon-i\">mydatabase</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358ad797149618-2\"> </div><div class=\"crayon-line\" id=\"crayon-59872120358ad797149618-3\"><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-o\">&gt;&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">DiG</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">9.9.4</span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">RedHat</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">9.9.4</span><span class=\"crayon-o\">-</span><span class=\"crayon-cn\">50.el7_3.1</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">&lt;&lt;</span><span class=\"crayon-o\">&gt;&gt;</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">mydatabase</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358ad797149618-4\"><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-m\">global</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">options</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">+</span><span class=\"crayon-i\">cmd</span></div><div class=\"crayon-line\" id=\"crayon-59872120358ad797149618-5\"><span class=\"crayon-sy\">;</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">connection </span><span class=\"crayon-e\">timed </span><span class=\"crayon-v\">out</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">no </span><span class=\"crayon-e\">servers </span><span class=\"crayon-e\">could </span><span class=\"crayon-e\">be </span><span class=\"crayon-v\">reached</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0013 seconds] -->\r\n<p>这些错误可能是由许多不同的问题引起的。如果无法调试出根本原因，与系统管理员联系以进行更多的调查。对于本地测试，这些问题可能表示你的主机的域名服务器未正确配置。要使用这些命令，需要安装 <strong><a href=\"http://www.linuxfromscratch.org/blfs/view/svn/basicnet/bind-utils.html\" target=\"_blank\" rel=\"nofollow\">BIND Utilities</a> </strong>包<strong>。</strong></p>\n<h1>18. iptables</h1>\n<p>iptables 用于阻止或允许 Linux 主机上的流量，用于 IP 包过滤器管理，类似于网络防火墙。此工具可阻止某些应用程序接收或发送请求。更具体地说，如果您的应用程序难以访问另一个端点，可能已被 iptables 拒绝流量访问该端点。例如，假设您的应用程序的主机无法访问 Opensource.com，您使用 <strong>curl </strong>来测试连接。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59872120358b4092941959\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ curl -vvv opensource.com\r\n* About to connect() to opensource.com port 80 (#0)\r\n*   Trying 54.204.39.132...\r\n* Connection timed out\r\n* Failed connect to opensource.com:80; Connection timed out\r\n* Closing connection 0\r\ncurl: (7) Failed connect to opensource.com:80; Connection timed out</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59872120358b4092941959-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358b4092941959-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59872120358b4092941959-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358b4092941959-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59872120358b4092941959-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358b4092941959-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59872120358b4092941959-7\">7</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59872120358b4092941959-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">curl</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">vvv </span><span class=\"crayon-v\">opensource</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e \">com</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358b4092941959-2\"><span class=\"crayon-e \">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">About </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">connect</span><span class=\"crayon-sy\">(</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">opensource</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">com </span><span class=\"crayon-i\">port</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">80</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-p\">#0)</span></div><div class=\"crayon-line\" id=\"crayon-59872120358b4092941959-3\"><span class=\"crayon-o\">*</span><span class=\"crayon-h\">   </span><span class=\"crayon-i\">Trying</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">54.204.39.132...</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358b4092941959-4\"><span class=\"crayon-o\">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Connection </span><span class=\"crayon-e\">timed </span><span class=\"crayon-e \">out</span></div><div class=\"crayon-line\" id=\"crayon-59872120358b4092941959-5\"><span class=\"crayon-e \">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Failed </span><span class=\"crayon-e\">connect </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">opensource</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">com</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">80</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Connection </span><span class=\"crayon-e\">timed </span><span class=\"crayon-e \">out</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358b4092941959-6\"><span class=\"crayon-e \">*</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Closing </span><span class=\"crayon-i\">connection</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">0</span></div><div class=\"crayon-line\" id=\"crayon-59872120358b4092941959-7\"><span class=\"crayon-v\">curl</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">7</span><span class=\"crayon-sy\">)</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Failed </span><span class=\"crayon-e\">connect </span><span class=\"crayon-st\">to</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">opensource</span><span class=\"crayon-sy\">.</span><span class=\"crayon-v\">com</span><span class=\"crayon-o\">:</span><span class=\"crayon-cn\">80</span><span class=\"crayon-sy\">;</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">Connection </span><span class=\"crayon-e\">timed </span><span class=\"crayon-v\">out</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0019 seconds] -->\r\n<p>连接超时。您怀疑某些东西可能会阻塞流量，因此您使用 <strong>-S </strong>选项显示 <strong>iptables </strong>规则。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59872120358ba069432327\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ iptables -S\r\n-P INPUT DROP\r\n-P FORWARD DROP\r\n-P OUTPUT DROP\r\n-A INPUT -p tcp -m tcp --dport 22 -j ACCEPT\r\n-A INPUT -i eth0 -p udp -m udp --sport 53 -j ACCEPT\r\n-A OUTPUT -p tcp -m tcp --sport 22 -j ACCEPT\r\n-A OUTPUT -o eth0 -p udp -m udp --dport 53 -j ACCEPT</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59872120358ba069432327-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358ba069432327-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59872120358ba069432327-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358ba069432327-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59872120358ba069432327-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358ba069432327-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59872120358ba069432327-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358ba069432327-8\">8</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59872120358ba069432327-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">iptables</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">S</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358ba069432327-2\"><span class=\"crayon-o\">-</span><span class=\"crayon-i\">P</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">INPUT </span><span class=\"crayon-v\">DROP</span></div><div class=\"crayon-line\" id=\"crayon-59872120358ba069432327-3\"><span class=\"crayon-o\">-</span><span class=\"crayon-i\">P</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">FORWARD </span><span class=\"crayon-v\">DROP</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358ba069432327-4\"><span class=\"crayon-o\">-</span><span class=\"crayon-i\">P</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">OUTPUT </span><span class=\"crayon-v\">DROP</span></div><div class=\"crayon-line\" id=\"crayon-59872120358ba069432327-5\"><span class=\"crayon-o\">-</span><span class=\"crayon-i\">A</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">INPUT</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">p</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tcp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">m</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tcp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-i\">dport</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">22</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">j</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ACCEPT</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358ba069432327-6\"><span class=\"crayon-o\">-</span><span class=\"crayon-i\">A</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">INPUT</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">i</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">eth0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">p</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">udp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">m</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">udp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-i\">sport</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">53</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">j</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ACCEPT</span></div><div class=\"crayon-line\" id=\"crayon-59872120358ba069432327-7\"><span class=\"crayon-o\">-</span><span class=\"crayon-i\">A</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OUTPUT</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">p</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tcp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">m</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">tcp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-i\">sport</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">22</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">j</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ACCEPT</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358ba069432327-8\"><span class=\"crayon-o\">-</span><span class=\"crayon-i\">A</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">OUTPUT</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">o</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">eth0</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">p</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">udp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">m</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">udp</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-i\">dport</span><span class=\"crayon-h\"> </span><span class=\"crayon-cn\">53</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">j</span><span class=\"crayon-h\"> </span><span class=\"crayon-v\">ACCEPT</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0029 seconds] -->\r\n<p>前三个规则显示，默认情况下流量已被丢弃。剩下的规则表示允许 SSH 和 DNS 流量。在这种情况下，如果需要允许流量到外部端点的规则，请跟上 sysadmin。如果这是用于本地开发或测试的主机，可使用 <strong>iptables </strong>命令来允许合适的流量。添加允许到主机的流量的规则时一定要谨慎。</p>\n<h1>19. sestatus</h1>\n<p>通常会在企业管理的应用程序主机上使用 SELinux（一个 Linux 安全模块）。SELinux 对主机上运行的进程提供最低权限的访问，防止潜在的恶意进程访问系统上的重要文件。某些情况下，应用程序需要访问特定文件，但可能会发生错误。要检查 SELinux 是否阻止了应用程序，使用 <strong>tail </strong>和 <strong>grep </strong>在 <strong>/var/log/audit </strong>日志记录中查找”denied”（被拒绝）的信息。否则，使用 <strong>sestatus </strong>来检查是否启动了 SELinux。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59872120358c1308348554\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ sestatus\r\nSELinux status:                 enabled\r\nSELinuxfs mount:                /sys/fs/selinux\r\nSELinux root directory:         /etc/selinux\r\nLoaded policy name:             targeted\r\nCurrent mode:                   enforcing\r\nMode from config file:          enforcing\r\nPolicy MLS status:              enabled\r\nPolicy deny_unknown status:     allowed\r\nMax kernel policy version:      28</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59872120358c1308348554-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358c1308348554-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59872120358c1308348554-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358c1308348554-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-59872120358c1308348554-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358c1308348554-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-59872120358c1308348554-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358c1308348554-8\">8</div><div class=\"crayon-num\" data-line=\"crayon-59872120358c1308348554-9\">9</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358c1308348554-10\">10</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59872120358c1308348554-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">sestatus</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358c1308348554-2\"><span class=\"crayon-e\">SELinux </span><span class=\"crayon-v\">status</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">                 </span><span class=\"crayon-e\">enabled</span></div><div class=\"crayon-line\" id=\"crayon-59872120358c1308348554-3\"><span class=\"crayon-e\">SELinuxfs </span><span class=\"crayon-v\">mount</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">                </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">sys</span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">fs</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">selinux</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358c1308348554-4\"><span class=\"crayon-e\">SELinux </span><span class=\"crayon-e\">root </span><span class=\"crayon-v\">directory</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">         </span><span class=\"crayon-o\">/</span><span class=\"crayon-v\">etc</span><span class=\"crayon-o\">/</span><span class=\"crayon-e\">selinux</span></div><div class=\"crayon-line\" id=\"crayon-59872120358c1308348554-5\"><span class=\"crayon-e\">Loaded </span><span class=\"crayon-e\">policy </span><span class=\"crayon-v\">name</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">             </span><span class=\"crayon-e\">targeted</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358c1308348554-6\"><span class=\"crayon-e\">Current </span><span class=\"crayon-v\">mode</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">                   </span><span class=\"crayon-e\">enforcing</span></div><div class=\"crayon-line\" id=\"crayon-59872120358c1308348554-7\"><span class=\"crayon-e\">Mode </span><span class=\"crayon-e\">from </span><span class=\"crayon-e\">config </span><span class=\"crayon-v\">file</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">          </span><span class=\"crayon-e\">enforcing</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358c1308348554-8\"><span class=\"crayon-e\">Policy </span><span class=\"crayon-e\">MLS </span><span class=\"crayon-v\">status</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">              </span><span class=\"crayon-e\">enabled</span></div><div class=\"crayon-line\" id=\"crayon-59872120358c1308348554-9\"><span class=\"crayon-e\">Policy </span><span class=\"crayon-e\">deny_unknown </span><span class=\"crayon-v\">status</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">     </span><span class=\"crayon-e\">allowed</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358c1308348554-10\"><span class=\"crayon-e\">Max </span><span class=\"crayon-e\">kernel </span><span class=\"crayon-e\">policy </span><span class=\"crayon-v\">version</span><span class=\"crayon-o\">:</span><span class=\"crayon-h\">      </span><span class=\"crayon-cn\">28</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0016 seconds] -->\r\n<p>上面的输出表示应用程序的主机已启用 SELinux。在本地开发环境中，可以更新 <strong>SELinux</strong> 使得权限更宽松。</p>\n<h1>20. history</h1>\n<p>当你使用大量的命令进行测试和调试时，可能会忘记有用的命令。每个 shell 都有一个 <strong>history </strong>命令的变体。它可显示自会话开始以来使用的命令的历史记录。可以使用 <strong>history </strong>来记录用来排除应用程序故障的命令。history 命令用于显示指定数目的指令命令，读取历史命令文件中的目录到历史命令缓冲区和将历史命令缓冲区中的目录写入命令文件。</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-59872120358c8604039702\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n$ history\r\n    1  clear\r\n    2  df -h\r\n    3  du</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-59872120358c8604039702-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358c8604039702-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-59872120358c8604039702-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-59872120358c8604039702-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-59872120358c8604039702-1\"><span class=\"crayon-sy\">$</span><span class=\"crayon-h\"> </span><span class=\"crayon-i\">history</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358c8604039702-2\"><span class=\"crayon-h\">    </span><span class=\"crayon-cn\">1</span><span class=\"crayon-h\">  </span><span class=\"crayon-i\">clear</span></div><div class=\"crayon-line\" id=\"crayon-59872120358c8604039702-3\"><span class=\"crayon-h\">    </span><span class=\"crayon-cn\">2</span><span class=\"crayon-h\">  </span><span class=\"crayon-v\">df</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">h</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-59872120358c8604039702-4\"><span class=\"crayon-h\">    </span><span class=\"crayon-cn\">3</span><span class=\"crayon-h\">  </span><span class=\"crayon-v\">du</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0007 seconds] -->\r\n<p>如果希望执行之前历史记录中的命令，但又不想重新输入，该怎么办？使用符号 <strong>!</strong> 即可，可以使用符号 <strong>!</strong> 执行指定序号的历史命令。例如，要执行第 2 个历史命令，则输入<strong>!</strong>2，</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/08/84a8a291f13fb68c3468a03906458adb.png\"><img class=\"aligncenter wp-image-112092 size-full\" src=\"http://jbcdn2.b0.upaiyun.com/2017/08/84a8a291f13fb68c3468a03906458adb.png\" alt=\"205506_GAYc_2918182\" width=\"800\" height=\"121\"></a></p>\n<p>在需要重新执行的命令的指定编号前添加 <strong>! </strong>即可重新执行</p>\n<p>这些基本命令能增强排查故障的专业技能，可检查为什么应用程序可以在一个开发环境中工作，而在另一个开发环境中则不可以。许多系统管理员使用这些命令来调试系统问题。了解一些有用的故障排查命令可帮助解决应用程序的问题。</p>\n<p> </p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112085\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112085votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112085\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 3 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "1", "fav_nums": "3", "comment_nums": "", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/08/7599b213c6d67d39e4bb2391c276fbb5.png"]},{"url_object_id": "d5fef9276de73d832c00914fd1bc2fc4", "create_date": "2017/07/26", "front_image_path": "full/35011d6168be00e949624c665041dc724e3ad786.jpg", "title": "MySQL EXPLAIN 详解", "url": "http://blog.jobbole.com/112021/", "tags": "IT技术,MySQL,数据库", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"http://www.jianshu.com/p/ea3fc71fdc45\">高广超</a>   </div><p>MySQL EXPLAIN命令是查询性能优化不可缺少的一部分，该文主要讲解explain命令的使用及相关参数说明。</p>\n<h3>EXPLAIN Output Columns</h3>\n<table>\n<thead>\n<tr>\n<th>列名</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>id</td>\n<td>执行编号，标识select所属的行。如果在语句中没子查询或关联查询，只有唯一的select，每行都将显示1。否则，内层的select语句一般会顺序编号，对应于其在原始语句中的位置</td>\n</tr>\n<tr>\n<td>select_type</td>\n<td>显示本行是简单或复杂select。如果查询有任何复杂的子查询，则最外层标记为PRIMARY（DERIVED、UNION、UNION RESUlT）</td>\n</tr>\n<tr>\n<td>table</td>\n<td>访问引用哪个表（引用某个查询，如“derived3”）</td>\n</tr>\n<tr>\n<td>type</td>\n<td>数据访问/读取操作类型（ALL、index、range、ref、eq_ref、const/system、NULL）</td>\n</tr>\n<tr>\n<td>possible_keys</td>\n<td>揭示哪一些索引可能有利于高效的查找</td>\n</tr>\n<tr>\n<td>key</td>\n<td>显示mysql决定采用哪个索引来优化查询</td>\n</tr>\n<tr>\n<td>key_len</td>\n<td>显示mysql在索引里使用的字节数</td>\n</tr>\n<tr>\n<td>ref</td>\n<td>显示了之前的表在key列记录的索引中查找值所用的列或常量</td>\n</tr>\n<tr>\n<td>rows</td>\n<td>为了找到所需的行而需要读取的行数，估算值，不精确。通过把所有rows列值相乘，可粗略估算整个查询会检查的行数</td>\n</tr>\n<tr>\n<td>Extra</td>\n<td>额外信息，如using index、filesort等</td>\n</tr>\n</tbody>\n</table>\n<h4>id</h4>\n<p>id是用来顺序标识整个查询中SELELCT 语句的，在嵌套查询中id越大的语句越先执行。该值可能为NULL，如果这一行用来说明的是其他行的联合结果。</p>\n<h4>select_type</h4>\n<p>表示查询的类型</p>\n<table>\n<thead>\n<tr>\n<th>类型</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>simple</td>\n<td>简单子查询，不包含子查询和union</td>\n</tr>\n<tr>\n<td>primary</td>\n<td>包含union或者子查询，最外层的部分标记为primary</td>\n</tr>\n<tr>\n<td>subquery</td>\n<td>一般子查询中的子查询被标记为subquery，也就是位于select列表中的查询</td>\n</tr>\n<tr>\n<td>derived</td>\n<td>派生表——该临时表是从子查询派生出来的，位于form中的子查询</td>\n</tr>\n<tr>\n<td>union</td>\n<td>位于union中第二个及其以后的子查询被标记为union，第一个就被标记为primary如果是union位于from中则标记为derived</td>\n</tr>\n<tr>\n<td>union result</td>\n<td>用来从匿名临时表里检索结果的select被标记为union result</td>\n</tr>\n<tr>\n<td>dependent union</td>\n<td>顾名思义，首先需要满足UNION的条件，及UNION中第二个以及后面的SELECT语句，同时该语句依赖外部的查询</td>\n</tr>\n<tr>\n<td>subquery</td>\n<td>子查询中第一个SELECT语句</td>\n</tr>\n<tr>\n<td>dependent subquery</td>\n<td>和DEPENDENT UNION相对UNION一样</td>\n</tr>\n</tbody>\n</table>\n<h4>table</h4>\n<p>对应行正在访问哪一个表，表名或者别名</p>\n<ul>\n<li>关联优化器会为查询选择关联顺序，左侧深度优先</li>\n<li>当from中有子查询的时候，表名是derivedN的形式，N指向子查询，也就是explain结果中的下一列</li>\n<li>当有union result的时候，表名是union 1,2等的形式，1,2表示参与union的query id</li>\n</ul>\n<p>注意：MySQL对待这些表和普通表一样，但是这些“临时表”是没有任何索引的。</p>\n<h4>type</h4>\n<p>type显示的是访问类型，是较为重要的一个指标，结果值从好到坏依次是：<br>\nsystem &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; ALL ，一般来说，得保证查询至少达到range级别，最好能达到ref。</p>\n<table>\n<thead>\n<tr>\n<th>类型</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>All</td>\n<td>最坏的情况,全表扫描</td>\n</tr>\n<tr>\n<td>index</td>\n<td>和全表扫描一样。只是扫描表的时候按照索引次序进行而不是行。主要优点就是避免了排序, 但是开销仍然非常大。如在Extra列看到Using index，说明正在使用覆盖索引，只扫描索引的数据，它比按索引次序全表扫描的开销要小很多</td>\n</tr>\n<tr>\n<td>range</td>\n<td>范围扫描，一个有限制的索引扫描。key 列显示使用了哪个索引。当使用=、 &lt;&gt;、&gt;、&gt;=、&lt;、&lt;=、IS NULL、&lt;=&gt;、BETWEEN 或者 IN 操作符,用常量比较关键字列时,可以使用 range</td>\n</tr>\n<tr>\n<td>ref</td>\n<td>一种索引访问，它返回所有匹配某个单个值的行。此类索引访问只有当使用非唯一性索引或唯一性索引非唯一性前缀时才会发生。这个类型跟eq_ref不同的是，它用在关联操作只使用了索引的最左前缀，或者索引不是UNIQUE和PRIMARY KEY。ref可以用于使用=或&lt;=&gt;操作符的带索引的列。</td>\n</tr>\n<tr>\n<td>eq_ref</td>\n<td>最多只返回一条符合条件的记录。使用唯一性索引或主键查找时会发生 （高效）</td>\n</tr>\n<tr>\n<td>const</td>\n<td>当确定最多只会有一行匹配的时候，MySQL优化器会在查询前读取它而且只读取一次，因此非常快。当主键放入where子句时，mysql把这个查询转为一个常量（高效）</td>\n</tr>\n<tr>\n<td>system</td>\n<td>这是const连接类型的一种特例，表仅有一行满足条件。</td>\n</tr>\n<tr>\n<td>Null</td>\n<td>意味说mysql能在优化阶段分解查询语句，在执行阶段甚至用不到访问表或索引（高效）</td>\n</tr>\n</tbody>\n</table>\n<h4>possible_keys</h4>\n<p>显示查询使用了哪些索引，表示该索引可以进行高效地查找，但是列出来的索引对于后续优化过程可能是没有用的</p>\n<h4>key</h4>\n<p>key列显示MySQL实际决定使用的键（索引）。如果没有选择索引，键是NULL。要想强制MySQL使用或忽视possible_keys列中的索引，在查询中使用FORCE INDEX、USE INDEX或者IGNORE INDEX。</p>\n<h4>key_len</h4>\n<p>key_len列显示MySQL决定使用的键长度。如果键是NULL，则长度为NULL。使用的索引的长度。在不损失精确性的情况下，长度越短越好 。</p>\n<h4>ref</h4>\n<p>ref列显示使用哪个列或常数与key一起从表中选择行。</p>\n<h4>rows</h4>\n<p>rows列显示MySQL认为它执行查询时必须检查的行数。注意这是一个预估值。</p>\n<h4>Extra</h4>\n<p>Extra是EXPLAIN输出中另外一个很重要的列，该列显示MySQL在查询过程中的一些详细信息，MySQL查询优化器执行查询的过程中对查询计划的重要补充信息。</p>\n<table>\n<thead>\n<tr>\n<th>类型</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Using filesort</td>\n<td>MySQL有两种方式可以生成有序的结果，通过排序操作或者使用索引，当Extra中出现了Using filesort 说明MySQL使用了后者，但注意虽然叫filesort但并不是说明就是用了文件来进行排序，只要可能排序都是在内存里完成的。大部分情况下利用索引排序更快，所以一般这时也要考虑优化查询了。使用文件完成排序操作，这是可能是ordery by，group by语句的结果，这可能是一个CPU密集型的过程，可以通过选择合适的索引来改进性能，用索引来为查询结果排序。</td>\n</tr>\n<tr>\n<td>Using temporary</td>\n<td>用临时表保存中间结果，常用于GROUP BY 和 ORDER BY操作中，一般看到它说明查询需要优化了，就算避免不了临时表的使用也要尽量避免硬盘临时表的使用。</td>\n</tr>\n<tr>\n<td>Not exists</td>\n<td>MYSQL优化了LEFT JOIN，一旦它找到了匹配LEFT JOIN标准的行， 就不再搜索了。</td>\n</tr>\n<tr>\n<td>Using index</td>\n<td>说明查询是覆盖了索引的，不需要读取数据文件，从索引树（索引文件）中即可获得信息。如果同时出现using where，表明索引被用来执行索引键值的查找，没有using where，表明索引用来读取数据而非执行查找动作。这是MySQL服务层完成的，但无需再回表查询记录。</td>\n</tr>\n<tr>\n<td>Using index condition</td>\n<td>这是MySQL 5.6出来的新特性，叫做“索引条件推送”。简单说一点就是MySQL原来在索引上是不能执行如like这样的操作的，但是现在可以了，这样减少了不必要的IO操作，但是只能用在二级索引上。</td>\n</tr>\n<tr>\n<td>Using where</td>\n<td>使用了WHERE从句来限制哪些行将与下一张表匹配或者是返回给用户。<strong>注意</strong>：Extra列出现Using where表示MySQL服务器将存储引擎返回服务层以后再应用WHERE条件过滤。</td>\n</tr>\n<tr>\n<td>Using join buffer</td>\n<td>使用了连接缓存：<strong>Block Nested Loop</strong>，连接算法是块嵌套循环连接;<strong>Batched Key Access</strong>，连接算法是批量索引连接</td>\n</tr>\n<tr>\n<td>impossible where</td>\n<td>where子句的值总是false，不能用来获取任何元组</td>\n</tr>\n<tr>\n<td>select tables optimized away</td>\n<td>在没有GROUP BY子句的情况下，基于索引优化MIN/MAX操作，或者对于MyISAM存储引擎优化COUNT(*)操作，不必等到执行阶段再进行计算，查询执行计划生成的阶段即完成优化。</td>\n</tr>\n<tr>\n<td>distinct</td>\n<td>优化distinct操作，在找到第一匹配的元组后即停止找同样值的动作</td>\n</tr>\n</tbody>\n</table>\n<h3>参考资料</h3>\n<p>高性能mysql第三版<br>\n<a href=\"https://dev.mysql.com/doc/refman/5.7/en/explain-output.html\" target=\"_blank\">https://dev.mysql.com/doc/refman/5.7/en/explain-output.html</a></p>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112021\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112021votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112021\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 4 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "1", "fav_nums": "4", "comment_nums": "", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2015/11/e78e36715813f49e9e62fe0c6050075c.png"]},{"url_object_id": "4220d150717c8d45c995d3ccaa8b8996", "create_date": "2017/07/26", "front_image_path": "full/71bf111fee57343e3033080c83e8e714bef0e88d.jpg", "title": "小王子之程序员版", "url": "http://blog.jobbole.com/111959/", "tags": "职场,程序员", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文由 <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/huangxiaofei\">黄小非</a> 翻译。未经许可，禁止转载！<br>英文出处：<a target=\"_blank\" href=\"http://ferd.ca/the-little-printf.html\">Fred Hebert</a>。欢迎加入<a target=\"_blank\" href=\"http://group.jobbole.com/category/feedback/trans-team/\">翻译组</a>。</div><p>【伯乐在线提示】：本文较长，Fred Hebert 仿照《小王子》小说，写了一个小程序员在学习软件开发中的各种历险，分了 11 个小故事。正如读者 lei 的评论所言：所有程序员都是文中这些人的缩影。</p>\n<p>补充：《小王子》是法国作家安托万·德·圣·埃克苏佩里于 1942 年写成的著名儿童文学短篇小说。本书的主人公是来自外星球的小王子。书中以一位飞行员作为故事叙述者，讲述了小王子从自己星球出发前往地球的过程中，所经历的各种历险。</p>\n<p> </p>\n<p> </p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/3b102356e4b2e8b92940143a3a70bed0.png\"><img class=\"aligncenter size-full wp-image-65334\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/3b102356e4b2e8b92940143a3a70bed0.png\" alt=\"printf-nocover\" width=\"387\" height=\"424\"></a></p>\n<h3>第 0 章</h3>\n<p>我出生在电子游戏和电脑泛滥年代之前。所以我还算幸运，有足够的时间和我哥，还有小伙伴们一起做户外运动，还发明我们自己的游戏。</p>\n<p>我们自己扮演英雄，拿着一根树枝，我们就能瞬间把它想象成弓、剑、枪，甚至是望远镜，当然也可以是任何其他东西。哦，对了，唯一的例外就是你不能把它想象成回旋镖，因为真的回旋镖扔出去是会自己飞回来的，但是树枝扔出去了，你要自己去捡回来。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/f0a415ae533c3befdffdf1b417a054ae.png\"><img class=\"aligncenter size-full wp-image-65343\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/f0a415ae533c3befdffdf1b417a054ae.png\" alt=\"boomerang\" width=\"356\" height=\"230\"></a></p>\n<p>后来我们就长大了，再这么玩就有些尴尬了。要知道，在孩子们开始觉得大人的世界很精彩的阶段，你要是再玩那些把松果想象成魔法手榴弹的游戏，这就很不合群了。迟早你要面对成长的烦恼。不过，能有一个完整的童年还是很幸运。</p>\n<p>后来我就开始学会玩电子游戏了，当然也开始使用电脑。电子游戏的世界可绝对是你梦寐以求的世界，因为它能把你想象中的东西在你面前实现出来。玩游戏很消耗时间，但是它绝对会让你体验到不同的人生。</p>\n<p>不过对于电子游戏来说，有一个特点：那就是你不负责创造，你只负责响应和付出时间。我长到青少年的岁数，还当过即兴表演的演员。所以说，无论是与人相处，还是装作旁若无人，这对我都不是问题。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/c0d8cbc8c759f27640821750644a554c.png\"><img class=\"aligncenter size-full wp-image-65339\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/c0d8cbc8c759f27640821750644a554c.png\" alt=\"improv\" width=\"360\" height=\"289\"></a></p>\n<p>当然，在魁北克做即兴表演还是有点儿不同寻常，因为我们是在溜冰场地上表演——你知道冰球在加拿大多火吗。</p>\n<p>后来我去了职业学校学习多媒体，大概是 2005 年到 2008 年这个时段，我终究还是要做些编程的事情。不过我发现编程是个有意思的事情！我又感觉到了创造性！并且我还能靠这个赚钱！于是我设计了我的第一套游戏，这可让我受益匪浅。<a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/2f5fe97ea19c4f50e42da989f216c5ea.png\"><img class=\"aligncenter size-full wp-image-65337\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/2f5fe97ea19c4f50e42da989f216c5ea.png\" alt=\"game\" width=\"472\" height=\"400\"></a></p>\n<p>不过后来又有人告诉我：“你做的并不是真正的电子游戏。你做的只是一个 HTML 表单。而且你做的时候应该用数组来表示文字和选项，这样效果会更好。你写的代码应该更整洁一些。”</p>\n<p>我对这个评价觉得有点儿沮丧。我做的这个游戏是一个基于文字的游戏，文字大概有 11 页，通过选择来“进行你的冒险”。不过我意识到，如果想让大家对我做的东西更加满意，我还有很多东西要学。</p>\n<p>我应该学一些“真正的编程知识”。于是我从基于JScript 的 GUI 工具跳到了一些更牛的东西上面，例如 PHP。我学了 PHP，同时也学了 JavaScript。可是后来，我听说这些还是不行，我还得学一些“真正的编程知识”。别人跟我说，PHP 不行，我应该学的是 Python，当然后来我真的去学了。</p>\n<p>不过“真正的程序员”还会一些更时髦的东西，Python 的 Lambda 可到不了那个逼格，而且面向对象编程模式简直就是弱爆了。人家告诉我说，我应该去读一读 SICP，毕竟这是计算机科学的圣经嘛。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/88196eec64f6b673f4e1ce9ebe35eb80.png\"><img class=\"aligncenter size-full wp-image-65349\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/88196eec64f6b673f4e1ce9ebe35eb80.png\" alt=\"sicp\" width=\"309\" height=\"456\"></a></p>\n<p>然后我就接触了 Scheme。我还买了 Brian Kernighan 和 Dennis Ritchie<i><i class=\"01\"> </i></i>合写的《The C Programming Language》，因为真正的程序员就是要用 C 语言写程序的嘛。我还在本地大学报了一个业余班去上课，同时我还得去上班，因为真正的程序员都是很懂数学和算法的嘛，所以我也得学。我开始读论文，看书，因为真正的程序员在算法这件事情上肯定是与时俱进的啊。</p>\n<p>后来，我学了 Erlang 语言，而且还靠这门语言找了份工作。我写了一本 Erlang 的书。不过有意思的是，从来没人问过我是不是这本书的作者？我还有没有写其他的书？或者书里的图是不是我画的？好吧，我找到了一份教 Erlang 语言的工作，但是却从来没有在生产环境中用过这门语言。</p>\n<h3>第 1 章</h3>\n<p>我就这样一直在全世界飞来飞去，教给别人一些连我自己都没有做过的事情，结果突然之间大家就觉得我也是真正的程序员了。要知道我的工作一开始和写程序是没什么关系的。</p>\n<p>有一天，我参加完某个技术会议回家，然后被滞留在机场了，正当我气急败坏地在电脑上打字的时候，突然听到了一个奇怪的，但是很绅士的声音对我说：</p>\n<p>“能帮我设计一个系统吗？”</p>\n<p>“啥？”</p>\n<p>“设计一个系统！“</p>\n<p>我被这个请求惊呆了，于是抬起了头。我环顾四周，看到了一个小孩，他非常希望成为一名程序员，然后他说我可以叫他”printf”，当然，我觉得这肯定不是他的真名，而且这个名字也挺蠢的。他看上去长得这个样子：</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/e91da181fb13d148dcb5b74e34579a96.png\"><img class=\"aligncenter size-full wp-image-65333\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/e91da181fb13d148dcb5b74e34579a96.png\" alt=\"printf-end\" width=\"393\" height=\"423\"></a></p>\n<p><q class=\"printf\"></q>”我不是很懂电脑，但是看上去你很懂。我想写一个博客程序给大家用，然后还想让大家阅读这个博客。所以麻烦你帮我写一个系统吧。”</p>\n<p>这可是一个让人吃惊的请求，可能是因为我已经 20 个小时没睡觉的原因，我还不是很理解，或者说我感觉还是很不真实。我跟他说，这可不是简单的事情。我不太清楚他到底要做什么？有没有考虑过失败了怎么办？这个博客要支持多少人同时在线阅读呢？服务器的主机放在哪儿呢？在缺乏这么多信息的前提下，我是没法设计一个合理系统的。</p>\n<p>“这些都不重要。就给我设计一个系统就好。”</p>\n<p>好吧，那么我就画了一个系统的架构图：</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/23bf341a92d7e72309b27ca82f202995.png\"><img class=\"aligncenter size-full wp-image-65347\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/23bf341a92d7e72309b27ca82f202995.png\" alt=\"arch1\" width=\"467\" height=\"251\"></a></p>\n<p>他看了看，然后说：“不行，这个系统还不够好。给我再做一个吧。“</p>\n<p>然后我就又做了一个：<br>\n<a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/b9b614d4b48593d53f73e56f015f79d1.png\"><img class=\"aligncenter size-full wp-image-65346\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/b9b614d4b48593d53f73e56f015f79d1.png\" alt=\"arch2\" width=\"583\" height=\"337\"></a></p>\n<p>接着我跟他简要解释了一下这个系统是如何工作的。</p>\n<p>我的新朋友礼貌地笑了笑，说：”这不是我要的系统，它太复杂了，好多功能我其实都不需要。“</p>\n<p>我听了感觉气不打一处来啊，我可是考虑了冗余、系统监控、备份、缓存还有很多其他的机制，来降低负载，减轻额外的处理器负担，并且还能对系统进行有效保护，失效备援，易于部署等等。要知道，如果平时我给人拿出这种方案，那可是要收咨询费的！好吧我失去耐心了，然后我就画了下面这个图：</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/ed300d72e9e18a9845bd8da8da96cae3.png\"><img class=\"aligncenter size-full wp-image-65344\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/ed300d72e9e18a9845bd8da8da96cae3.png\" alt=\"blackbox\" width=\"188\" height=\"176\"></a></p>\n<p>然后我还补充说：“这就是你要的设计。你要的系统就在这个黑盒子里。”我希望这个设计方案能让他放过我。不过我听到了一句非常意外的回答：</p>\n<p>“没错！这就是我要的系统！”</p>\n<p>这就是我和小 printf 初识的故事。</p>\n<h3>第 2 章</h3>\n<p>我迅速地对小 printf 做了点调查。发现他之前写的东西都是些小程序，基于表单的小网页，还有一些无关紧要的命令行工具。这些东西平淡无奇，就算是做出来了也很快会被人忘记。</p>\n<p>然后突然之间，他就开始做包含好几个模块的大项目了。这个项目要用到 sockets，要能访问本地硬盘，而且还要和数据库交互。程序刚一做出来的时候，小 printf 还觉得很神奇。但是即便如此这个项目还是差强人意。</p>\n<p>这个项目还需要重构，需要更细致的测试，需要更完备的文档，需要更好的包装和分析。项目上线已本来应该正常运行，但是某一天早上，它崩溃了。</p>\n<p>接下来就是各种崩溃，崩了又崩。</p>\n<p>系统配置不对，日志界面也不再滚动，磁盘速度忽快忽慢，网络不定时抽风，bug 开始各种出现，系统编码也让人匪夷所思，数据库需要清理，事务也被挂起，证书过期，各种漏洞开始暴露，系统监测则什么动静也没有。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/2a137d24c99e91c1d8b1d4fee8b313bb.png\"><img class=\"aligncenter size-full wp-image-65350\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/2a137d24c99e91c1d8b1d4fee8b313bb.png\" alt=\"spaghetti\" width=\"243\" height=\"143\"></a></p>\n<p>系统开始变成一锅粥了。</p>\n<p>他对我说：“事实上我什么都不懂！我本应根据我的需求来做判断的。我太想做一个完美的系统，花了这么多的时间，结果却是‘磨刀误了砍柴功’。当然，我还是知道这个系统的美妙之处的。“</p>\n<p>于是一天早晨，他决定离开办公室。他对着一大堆电脑指示灯说了「再见」。他离开是为了要看看，除了他那乱糟糟的服务器之外，软件的世界还能给他提供些什么好办法来实现他的系统。</p>\n<p>如果照现在的情况，只会是日志继续不停地累计，直到硬盘存爆了为止。</p>\n<h3>第 3 章</h3>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/72c115153857d62127329f76d4615d75.png\"><img class=\"aligncenter size-full wp-image-65342\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/72c115153857d62127329f76d4615d75.png\" alt=\"building\" width=\"394\" height=\"281\"></a></p>\n<p>他来到了一个工作区，想找个经验丰富的人指点迷津。</p>\n<p>他找的第一个人是一个超级自信的高级工程师，他看上去地位很高的样子。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/e71c20866e199431e56c0e63c09a7c93.png\"><img class=\"aligncenter size-full wp-image-65335\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/e71c20866e199431e56c0e63c09a7c93.png\" alt=\"pro\" width=\"362\" height=\"425\"></a><q class=\"other\"></q>”啊，来向我取经啊！你可找对人了，我可是这个领域的专家！“这个人说。</p>\n<p>”专家？”小 printf 问到，”这就是说你什么程序都能写，什么程序都会写？“</p>\n<p>”那当然！“专家回答到。他补充说：”总的来说，我只写那些值得写的程序。我可不写那些没意义的东西。我能写但不写的那些程序，都是因为太简单，所以不劳我动手。“</p>\n<p>”啊，那你能帮我看一下我的系统吗？”就在小 printf 开始阐述他的系统的时候，这位专家打断了他：</p>\n<p>“抱歉，我真心觉得这么做没什么意义。”</p>\n<p>“为什么？”</p>\n<p>“因为经验。我善于编写我善于的程序，我给我善于编写的东西编程。我要严格限制我只做我擅长做的事情，这样才能变得更好。我管这个叫做‘职业安全’，这就是程序界的适者生存原理，而且这一行就是这么玩的。“</p>\n<p>”那你为什么不能帮我呢？“</p>\n<p>”好吧，你看，如果我花时间帮助了你，那么我就会让我的技术自我投资的方向发生分散和偏离——这对我来说是失策。对于你来说，最好的学习方法就是我当年做的那样：通过痛苦的努力来找到解决的办法。这有助于锻造你的个性。“</p>\n<p>”但是这样效率好低。“</p>\n<p>”好吧那你就去学校学，你也可以自学。但是无论哪种做法，都只是把那些想不劳而获的懒人踢出去，让真正愿意踏实学习的人留下来。如果不是这样的话，那我坚持恪守的价值观就会随之崩溃。“</p>\n<p>”那你觉得跟人合作，或者是你的同事能不能帮助你？“</p>\n<p>”并不能。我工作状态最好的时候其实是我一个人独自待着而且没人打扰的时候。每次我被迫和别人一起工作的时候，几乎可以肯定我们做的东西没法凑到一起。最后只能是我怒了，然后把他们写的东西又自己重新再写一遍，然后这才能行。“</p>\n<p>小 printf 对这个专家不愿帮助别人的态度感到非常意外，而且也对专家描述的周围的人能力如此之差感到很困惑。专家把自己的全部视野只集中在自己擅长的领域，只解决自己能解决的问题，这听上去有点儿悲哀。</p>\n<p>”我明白了…我觉得你别给我帮助的话就最好了。“ 小 printf 说到。</p>\n<p>”你什么意思？“自带高大上光环的专家似乎感到了自己的价值观受到了挑战。”你是说我的做的工作毫无趣味可言吗？“</p>\n<p>”哦，并不是，你做的工作很有趣。不过从你的眼光中看来，我只是一个烦躁而讨厌的家伙。我是来寻求帮助的，不是来找罪受的。“</p>\n<p>小 printf 迅速地离开了这个专家，因为他明白，除非你在他的”职业安全“范围之内，否则根本就不能碰他。</p>\n<h3>第 4 章</h3>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/1ca156937bc6ffd234324776df20998e.png\"><img class=\"aligncenter size-full wp-image-65361\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/1ca156937bc6ffd234324776df20998e.png\" alt=\"books\" width=\"461\" height=\"360\"></a></p>\n<p>在继续寻找帮助的路上，小 printf 来到了一个办公室的的门口，办公室里四面都是书架，书架上放着装帧优美的硬皮书，书上有各式各样的精美图画，一个人坐在办公室里面。</p>\n<p>“先生你的书真不错啊“小 printf 说。</p>\n<p>”谢谢！我觉得这些书都是程序员必备的材料。如果你没有这些书，你都不好意思跟人家说你是真正的程序员。“</p>\n<p>”啊，那我觉得我可能就不算是真正的程序员了“，小 printf 说，”那你最喜欢哪本书呢？“</p>\n<p>”哦，大部分书我还没看过呢。“</p>\n<p>”那你不是个优秀的程序员咯？“</p>\n<p>”啊不，我不是。“这个开发者骄傲地补充到：”实际上，我是个糟糕的程序员。“</p>\n<p>”真遗憾，“，小 printf 说，”我可是不断在进步呢。“</p>\n<p>“你听说过 Dunning-Kruger 效应没？”，房间中的人问到。</p>\n<p>“没有，那是个啥玩意儿？”</p>\n<p>“就是一种认知偏差。它的意思大概就是说，那些能力不太强的人更容易高估自己，而能力很强的人更容易低估自己。”</p>\n<p>“所以按照你的意思，如果我认为我在进步，其实是因为我不够好造成的？”</p>\n<p>“是啊，就是这个意思。很可能就是你其实能力不强。而我，我公开声称自己是一个糟糕的程序员。但是根据 Dunning-Kruger 效应，我很可能是在低估我自己，这就意味着我其实是一个很棒的程序员，你还不明白吗？”</p>\n<p>“为什么会这样？”</p>\n<p>“那是因为自黑是程序员的一大法宝。当你自我感觉良好的时候，你实际上已经停滞不前了。”</p>\n<p>“但是这样一来不就意味着，一旦你自己感觉不错的时候，你就开始走下坡路了，所以你应该让自己感觉糟糕起来吗？”</p>\n<p>“对的。但是这件事情正确的做法是，你要对任何东西都说很糟糕，即便是你不知道怎么解决问题也要这么说。这样就能让你看上去很聪明，而且又并不用真的做什么。“</p>\n<p>”能具体解释一下么？“</p>\n<p>”比如我在网上看到了一个让我不爽的项目。然后我就说这个项目所有的地方都不对，但是又并不具体说哪儿不对。我只需要轻描淡写地说，因为做这个项目的人本身就是个白痴，就这样就可以了。“</p>\n<p>“但是你这么说，别人怎么会信呢？”</p>\n<p>“哈哈，我觉得他们都愿意相信他们做错了，而且他们也愿意让别人指出来。这就有点儿像烟雾或者镜子。实际上没人知道自己做的东西是啥样，他们只能知道自己做的东西看上去是啥样。”</p>\n<p>“那么如果他们说他们没法解决问题，让你来帮他们的话，那你怎么办？“</p>\n<p>”这样的话就又回到了一切事情都很糟糕的那个问题；你就说你很忙，有很多事情要做，然后你还很悲观。这样的话，他们就只能靠他们自己了。“</p>\n<p>”所以说这一切都只是摆个姿态而已？这对你来说只是一个套路？你懂的时候装作不懂，是为了让真正啥都不懂的人失去信心，你不懂的时候装懂，是为了让真正懂的人感觉糟糕。“</p>\n<p>”在大多数情况下，有能力没什么用。只有名声才是最重要的。老板招人的时候喜欢招自己的朋友，公司裁人的时候不招人喜欢的和不被重视的人会先被裁。这就是规则。如果你想改变社会的规则，你就会成为异类。这就是套路。业界就是这么运作的，学术界也大致如此，尽管这些都是潜规则，但是我还是都看出来了。一切都取决于你认识谁，如何推销自己，如果经营你的个人品牌。只有这样你才能在业界拥有一席之地。“</p>\n<p>”如果我必须要觉得自己很糟糕，而且还得让别人觉得很糟糕，这样才能找到工作的话，那我想还是算了。“小 printf 说完就走开了。</p>\n<h3>第 5 章</h3>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/27adece4ab9b8ec687df066fb64d100a.png\"><img class=\"aligncenter size-full wp-image-65348\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/27adece4ab9b8ec687df066fb64d100a.png\" alt=\"realprog\" width=\"489\" height=\"488\"></a></p>\n<p>接下来就是午餐时间了，printf打断了一个全神贯注工作忘记吃午饭的人，他一直盯着屏幕，饭都已经凉了。</p>\n<p>工作这么忙碌的人应该很擅长软件行业。于是小 printf 问到：</p>\n<p>”如果主数据库崩溃了，那从数据库也会崩溃么？“</p>\n<p>”你运行的一切东西。“这个忙碌的人回答说，”迟早都会崩溃的。“</p>\n<p>”那么那些告诉你程序崩溃的程序呢？它们也会崩溃么？“</p>\n<p>”是的，它们也会崩溃。所有的大型系统在任意时刻都处在某种部分崩溃的状态。“</p>\n<p>”那么，我们搭建可靠系统（reliable system）的意义在哪儿呢？“</p>\n<p>这个忙碌的人不知道，他也在思考同样的问题，因为就在此时，他们又接到了一个问题，说是一朵云坏掉了，造成了天空塌下来砸到了头上。</p>\n<p>”那么，搭建可靠系统的意义到底在哪儿呢？“小 printf 追问到。</p>\n<p>这个忙碌的人此时一脸的不爽，一看就是在工作遇到问题的样子。他就像一个放了学被留下来不让走的孩子，而且他的三明治显然是废了。他很不耐烦地大声回答说：</p>\n<p>“显然没有任何意义。因为程序本身就是一坨屎。”</p>\n<p>“噢！”他倒抽了一口气。</p>\n<p>接下来，就是一段完全的沉默。</p>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/3b7432892c1dbafb839a60491ad99734.png\"><img class=\"aligncenter size-full wp-image-65351\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/3b7432892c1dbafb839a60491ad99734.png\" alt=\"trashcan\" width=\"229\" height=\"381\"></a></p>\n<p>小 printf 打破了沉默，并且带着一丝愤怒：</p>\n<p>“我不相信你说的话。程序确实是脆弱的，但是程序员能够通过努力让程序变得更好且可用。”</p>\n<p>没有回应。这个时候忙碌的人已经打开一个文档，查看如何从头启动一个集群备份，情况似乎变得越来越糟糕了。</p>\n<p>“那么你真的相信可靠的程–”</p>\n<p>“噢不！”忙碌的人说，“不不不！我不相信什么好的或者可靠的程序！再也不信了！它们都不行！我告诉你我现在脑袋里想的就是怎么处理手头的这个垃圾系统。你没看到是我在努力维持让这些东西运行吗？这些破玩意儿多么重要！”</p>\n<p>小 printf 瞪了回来，表情有些惊愕。</p>\n<p>“都坏成这样了还很重要？你的口气就像是个真正的程序员似的。“</p>\n<p>他补充说：</p>\n<p>”你把概念完全搞混了。世界上有成百上千的程序，年复一年地运行，而且总是会崩溃。但是即便如此人们还是需要这些程序，使用这些程序。而且我知道还有一种程序，它们只会在单台笔记本上运行，但是只要发生一点点错误，其结果就能瞬间毁灭整个社区。如果这样，你还认为不重要吗？“</p>\n<p>接下来这个忙碌的人就不再说话了。</p>\n<h3>第 6 章</h3>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/7350f2b08649e74bdbe6927120ebe2e3.png\"><img class=\"aligncenter size-full wp-image-65338\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/7350f2b08649e74bdbe6927120ebe2e3.png\" alt=\"frameworks\" width=\"529\" height=\"487\"></a></p>\n<p>小 printf 造访的第四个工作区有一个人，他的电脑前贴满了各种不知名的即时贴。</p>\n<p>”motor-mvc, quadrangular JS, GoQuery, cometeor, 还有一些听上去像是日语的东西, …“</p>\n<p>”Hi,“ 小 printf 打断了他，”请问你在做什么呢？“</p>\n<p>”alchemist, bongodb, mochascript, walktime.js, portasql, …“这个人不停地念叨。</p>\n<p>”请问您在做什么呢？“小 printf 又问了一遍，这次声音更大了一些。</p>\n<p>”噢，我在尝试新的框架，工具，数据库，编程语言。“</p>\n<p>”哇！你好像进度很快啊，效率和10个程序员加起来一样高。“</p>\n<p>”是啊，你看，这个行业的前进速度是非常快的！“他对着手机看了几秒，然后补充说，”这儿！cardboard.io 框架推出了 3.5 版本，这个版本和 3.4 不兼容，目前已经产生了 4 个 fork 了！我必须要把他们都试一遍，然后决定自己用哪个。“</p>\n<p>”但是你学这么多，都拿来做什么呢？“</p>\n<p>”我是一个提前学习主义者。如果你不保持着与时俱进的心态，现在你可能还要靠写 COBOL 或者 MUMPS 来过日子呢。如果你想做大事情，就要确保自己站在浪潮之巅。“</p>\n<p>”那这么做有效果么？“</p>\n<p>”有啊，我在 Rails 火起来之前就知道它要火了，我在 node.js 流行起来就知道它要流行了。我参与了 Redis、Mongodb 和 Riak早期的 beta 测试！我是第一个用 Vagrant 的人，后来又切换到了Docker上面，当然现在的潮流是 Unikernel“</p>\n<p>”酷，那么你掌握了这么多最前沿的技术，有什么回报呢？“</p>\n<p>”哦，并没有回报，Rails 变得越来越臃肿了以后，我就必须得赶快去关注别的重要技术，保证自己不要落后。其他的各种技术差不多也是这个套路。目前我希望掌握的是 Unikernel。“</p>\n<p>”明白了。“，小 printf 补充到，”那么这些新框架和技术都会用来解决哪些问题呢？“</p>\n<p>”噢，不是重大技术我们不用，我主要是要确保这一点，这样才能让我们公司不至于把资源花费到没有未来的技术上。这是很重要的，因为如果你不这么做的话，你的技术就会被那帮花白胡子的过时老程序员绑架，为了避免这样，你就必须成为一个自我驱动力强大的学习者，一个提前学习主义者。“</p>\n<p>”真有趣。“小 printf 插了一句嘴。</p>\n<p>”这可不是有趣，这是很难做到的！在创业的世界里，如果你想要吸引人才，你就必须要通过优秀的技术来招揽他们！否则你就是个不灵活的落后者。没人愿意做不灵活的落后者。“</p>\n<p>小 printf 赶紧说：”不，我不是这个意思。“，然后他补充到，”我感到有趣的地方在于，工具本来是用来给我们解决问题的，但是对于你来说，工具本身却成了问题。“</p>\n<p>接下来，这个人就站在他那个新潮的健身式办公桌前，没有任何回应了，小 printf 真希望自己赶紧出去。</p>\n<h3>第 7 章</h3>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/6a7cef8b627c1b5bbdef6056762200a1.png\"><img class=\"aligncenter size-full wp-image-65362\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/6a7cef8b627c1b5bbdef6056762200a1.png\" alt=\"ops\" width=\"363\" height=\"349\"></a></p>\n<p>在下一个办公室，坐着一个看上去很疲倦的员工，他的桌子上堆满了空咖啡杯。她无精打采地坐着，愤怒地敲击着键盘。</p>\n<p>”嗨！“小 printf 说。</p>\n<p>这个疲倦的女人并没有停下手上的动作。他继续愤怒地敲击着键盘。</p>\n<p>”你好？“小 printf 又打了一遍招呼。</p>\n<p>这个女人忽然间停了下来，从抽屉里取出一只水壶，然后大口喝起水来。</p>\n<p>”我的工作太糟糕了。“她说，”我是做 Devops 的。一开始还好，我大部分时间做开发，偶尔也做做调试的事情，但是随着时间的推移，情况变得越来越糟糕。我开始在各处救火，但是问题还是不断发生。我解决了其中的大部分问题，但是有些小毛病还是要期盼奇迹发生，这才能赶得上开发计划预定的期限，而且开发工作也是我的。“</p>\n<p>”他们没有再找个人帮帮你么？“</p>\n<p>”没有，这就是问题的所在。小问题总是到处发生，因为我必须要解决这些问题，所以我在做开发的时候就不可能像以前只做开发时那么专注，所以我本身就会制造更多的问题。现在，我每天都没日没夜地给系统灭火，我真是恨死我的工作了。“</p>\n<p>”那你的雇主为什么什么都不做呢？“</p>\n<p>”那是因为我擅长我的工作啊，我长期以来一直可以控制住局面，而且大家都已经习惯了。当你把创造奇迹变成一种习惯的时候，人们就适应了。然后你就会被困在‘总是要创造奇迹’的局面当中，否则人们就会认为是你的工作不得力。“</p>\n<p>”这听上去可真是悲哀！“</p>\n<p>”是啊。因为你是最熟悉怎么去给系统灭火的人，所以你就总得去，久而久之就是你的工作了，直到有一天老板雇了新人来替代你做你心爱的工作。如果你真的很在意你的工作的话，那么就去做那种谁都不愿意干的脏活累活，接下来所有人都会感谢你，你干得越多人们就会越感谢你，直到所有的脏活累活全都归你。当然，这样的话工作就没有什么乐趣可言了。“</p>\n<p>”那么你可真不走运。“小 printf 说。</p>\n<p>说着，她的呼叫器又响了。</p>\n<p>”那个女人，”小 printf 对自己说，就像是他父亲的口吻，“那个女人的工作被所有人轻视，专家、明星程序员、提前学习主义者，他们都看不上她的工作。但是她做的工作才是唯一有帮助的。这很可能是因为她总是在考虑别人，而不是只考虑自己吧。”</p>\n<h3>第 8 章</h3>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/e3b19d8ef4b712035dd80e8738020147.png\"><img class=\"aligncenter size-full wp-image-65363\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/e3b19d8ef4b712035dd80e8738020147.png\" alt=\"architect\" width=\"449\" height=\"377\"></a></p>\n<p>在建筑的一角，小 printf 发现了一间大办公室，办公室有巨大的落地窗，窗外视野极好。办公室内有一张非常大的办公桌，桌子上的文件堆成了小山，有一个老绅士坐在办公桌前。</p>\n<p>“啊，开发者来了”老绅士看到小 printf 走到门厅，于是就大声喊到，“进来！”</p>\n<p>透过窗户看去，小 printf 注意到窗户的玻璃上写着各种各样的字，还有用修正液涂改的痕迹，以至于窗外的风景都快被各种圈圈点点，箭头，圆柱等几何图形给盖住了，而且上面还画了云朵的图案。明明窗外就有真正的云，为什么还要在窗户上画云朵的形状？还有整个图案的含义也让人很感兴趣。</p>\n<p>”这是什么？“，小 printf 指着窗户问。</p>\n<p>”这个么？这是我们的生产系统！“那个老绅士说，一副看上去对外面事物毫不关心的样子，”我是一个软件架构师。“</p>\n<p>”软件架构师是什么？”</p>\n<p>“多数情况下，架构师是那种最了解组件之间的结构，并且最能够合理调度组件关系的人，架构师能让大型系统的各个部分完美协调地工作。同时，软件架构师也了解数据库、编程语言、框架、编辑器、序列化格式、协议以及诸如封装、协议隔离等概念。“</p>\n<p>”听上去真有趣！“小 printf 说，“终于有一个人能够回答所有的问题了！”他看了一眼架构师的图，“你的系统真是让人印象深刻啊！那么这个系统速度快么？”</p>\n<p>“我不知道，”架构师说，“应该挺快的吧。”</p>\n<p>“那系统的代码呢？写得好么？”</p>\n<p>“我也没法告诉你”</p>\n<p>“用户对系统满意么？”</p>\n<p>“恐怕我还是没法告诉你。”</p>\n<p>“但是你是软件架构师啊！”</p>\n<p>“对啊！但是我并不是开发者啊。软件架构师的任务并不是去写模块、类，也不是调用类库。软件架构师的工作相比写代码来说要重要得多。软件架构师会和开发者，程序员们聊天，问他们问题，给他们提供指导。如果程序员问的问题很有趣，那么架构师也许会亲自出马给这个问题做规划。”</p>\n<p>“为什么要这样？”</p>\n<p>“因为我们更有经验啊。我们对系统能做哪些事，不能做哪些事了解得更多。开发者则是我们知识的延伸，他们会去把优秀的系统真正做出来。”</p>\n<p>“但是你们不亲自编码，怎么能确认开发过程是顺利的呢？”</p>\n<p>“因为我们信任开发人员啊。”</p>\n<p>“所以你相信开发人员能够正确实现你的想法，并且不会产生他们自己的想法？”</p>\n<p>软件架构师听了小 printf 的话后明显有些震惊，他说：”我想我还是有点儿脱节。“，他最后承认说，“问题确实存在，别人总是跟你说要按照某种思想或者主意去做事，但是你又没法有效验证你做的事情是不是真的符合这种思想。”他低下了头，沉思着，“有的时候软件架构师既不做软件，也不做架构，这貌似是真的。”</p>\n<p>接着，小 printf 离开了坊间，然后结束了他的访问，离开了大楼。</p>\n<h3>第 9 章</h3>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/badf773e339eb22672ab17db1335c747.png\"><img class=\"aligncenter size-full wp-image-65341\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/badf773e339eb22672ab17db1335c747.png\" alt=\"charity\" width=\"410\" height=\"299\"></a></p>\n<p>小 printf 刚一走出门，就碰到了一个男人正在路边募集善款。</p>\n<p>“Hi，”那个男人说，“你今天想不想给别人献点儿爱心呢？”</p>\n<p>”好吧，这样做我感觉可能会好点儿“，小 printf 回答说，”我已经在这栋大楼里待了一整天，可是我出来的时候感觉更加困惑了。“</p>\n<p>”啊，我明白了。这些人都是开发者。他们其实一点儿也帮不上忙，对不？他们总是喊着要改变世界，而且他们确实也做到了。“</p>\n<p>”但是为什么感觉这么奇怪呢？“小 printf 回答到。</p>\n<p>”好吧，因为他们的工作就是把人们的职业转换成程序，让人们安逸的生活变得更加安逸。软件会吞噬整个世界，然后给让世界面貌一新……不过从深层次来看，面貌一新的世界还是那个旧世界，只是面貌变了而已。之所你觉得奇怪，是因为世界的改变并不一定朝好的方向改变。我们现在面临的问题其实和以前一样多，需要填的坑也和以前一样深。“</p>\n<p>”那么我怎么才能让自己感觉好一点儿呢？”小 printf 显得有些焦虑。</p>\n<p>这个男人思考了一会儿，然后希望小 printf 能和他一起来帮助别人，这是他认为的能让自己感觉变好的方式。printf用了一整个下午告诉这个人自己的问题和经历。这个人听完了以后沉默了很长一段时间，然后说：</p>\n<p>“人们在社会中相互博弈，扮演不同角色，追逐和享受的名声，解决错综复杂的问题后得到瞬间的快感，这些都只是过眼云烟。最终，如果你没有解决什么有意义的问题，如果你完全不考虑别人，那么你是无法做到内心满足的。”</p>\n<p>“得不到内心的满足也许也没什么，也许会很糟糕，在你成长的过程中，你的满足感可能来自于你的工作之外，也可能来自于工作。工作可以仅仅就是工作，也可以是单纯为了钱，也可以为了兴趣。这些都OK。只要你能从生命中的某处找到内心的满足，那就好了。”</p>\n<p>“最后，只有当你以人类的面孔去解决问题的时候，你才会觉得真的正确；真正关键的点其实和电脑没关系。”</p>\n<p>“真正的关键在于你用心花在系统上的精力，这才是最重要的。“，那个人补充到，”如果你忘记了为什么花这么多精力的初衷，当一切都变成了关乎个人骄傲的游戏，那么事情的性质就变了，从可慰变成可悲。“</p>\n<p>”开发者们常常会忘记一个事实；如果你失去了对事物的眼光，那么在开发系统本身就成为了一个问题，这样的话最有效的办法就是把系统废掉，因为系统自己就是问题的根源。“</p>\n<p>”只有当你以人类的面孔去解决问题的时候，才会觉得真的正确。“，小 printf 不断重复着这句话，他铭记在心。</p>\n<h3>第 10 章</h3>\n<p><a href=\"http://jbcdn2.b0.upaiyun.com/2017/06/c3e439e098ad3e922e7c338db045c453.png\"><img class=\"aligncenter size-full wp-image-65332\" src=\"http://jbcdn2.b0.upaiyun.com/2017/06/c3e439e098ad3e922e7c338db045c453.png\" alt=\"printf\" width=\"569\" height=\"638\"></a></p>\n<p>坐在我身旁的Printf现在要起身回家了。跟他的一席对话让我意识到了我现在所做的事情和我的爱好有多么大的距离，而我的爱好才是我真正开始编程的动力。小 printf 遇到的每一个角色，我每天也都会遇到很多。我曾受到他们的鼓舞，希望成为他们的一员，我可能也鼓励过别人这么做。</p>\n<p>当我还在挣扎着成为一个真正的程序员的时候，小 printf 却没有这么做。他说他成不了一个真正的程序员也没关系，他更希望能成为一个长着人类面孔的程序员。</p>\n<p>时至今日，回首望去，我的困境并没有改变，我还是要在人类的面孔和纯粹的工作之间做出选择，我希望我能有这个能力。而且在这两者之间好像也没有什么中间地段可以让我去选择。</p>\n<p>无论如何，小 printf 觉得他不需要做一个真正的程序员了，我想我和他的感觉是一样的。</p>\n\r\n        \r\n            <blockquote class=\"rewards\">\n        <p><strong>打赏支持我翻译更多好文章，谢谢！</strong></p>\n        <a href=\"#rewardbox\" id=\"rewards-button\" class=\"fancybox\"><span class=\"btn-bluet-blue href-style\"><i class=\"fa fa-jpy\"></i> 打赏译者</span></a>\n    </blockquote>\n\n    <div id=\"rewardbox\">\n        <h4>打赏支持我翻译更多好文章，谢谢！</h4>\n                <p>\n                        <img src=\"http://www.jobbole.com/wp-content/uploads/2016/04/78805a221a988e79ef3f42d7c5bfd4187.jpeg\">\n            \n                    </p>\n    </div>\n\n    \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"111959\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"111959votetotal\">6</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"111959\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 7 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 4 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/huangxiaofei\">黄小非</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/huangxiaofei\">\r\n\t\t\t<img src=\"http://www.jobbole.com/wp-content/uploads/avatars/5423/Corbis-42-221258652.jpg\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            黄小非：毕业于重庆大学计算机系，南开大学软件工程硕士，SCJP。 目前在一家国企信息中心任职软件开发工程师。主要技术兴趣为Java平台相关技术、系统构架、C/C++、计算机图形学等。（新浪微博：@黄小非）        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/huangxiaofei\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/huangxiaofei/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/huangxiaofei/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 63</a> · <a title=\"微博主页\" target=\"_blank\" href=\"http://weibo.com/huangxiaofei2002\"><i class=\"fa fa-weibo\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "6", "fav_nums": "7", "comment_nums": "4", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/06/3b102356e4b2e8b92940143a3a70bed0.png"]},{"url_object_id": "edadb3aea0db398bd4790e74f9295bb1", "create_date": "2017/07/27", "front_image_path": "full/eadb28355fab57e9672e5c965147ef4caca04ac4.jpg", "title": "27 个机器学习、数学、Python 速查表", "url": "http://blog.jobbole.com/112009/", "tags": "工具与资源,Python,数学,机器学习", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">本文由 <a href=\"http://blog.jobbole.com\">伯乐在线</a> - <a href=\"http://www.jobbole.com/members/shaozhengjiang\">iPytLab</a> 翻译。未经许可，禁止转载！<br>英文出处：<a target=\"_blank\" href=\"https://unsupervisedmethods.com/cheat-sheet-of-machine-learning-and-python-and-math-cheat-sheets-a4afe4e791b6\">Robbie Allen</a>。欢迎加入<a target=\"_blank\" href=\"http://group.jobbole.com/category/feedback/trans-team/\">翻译组</a>。</div><p>机器学习涉及到的方面非常多。当我开始准备复习这些内容的时候，我找到了许多不同的”速查表”, 这些速查表针对某一主题都罗列出了所有我需要知道的知识重点。最终我编译了超过 20 份机器学习相关的速查表，其中一些是我经常用到的而且我相信其他人也会从中受益。本文整理了我在网络上找到的 27 个速查表，我认为比较好。如果我有遗漏，欢迎补充。</p>\n<p>如今机器学习领域的发展相当迅速，我可以想象出来这些资源将会很快过时，但是至少在当前，在2017年6月1日，他们都是相当流行的。</p>\n<p>如果你们像我一样想要一次性批量下载所有资源，我已经将 27 个速查表整理打包（<a href=\"https://www.dropbox.com/s/v3yg8djhdf24g6v/UnsupervisedMethods.com%20-%20Cheat%20Sheets.zip?dl=0\" target=\"_blank\">Dropbox</a>、<a href=\"https://pan.baidu.com/s/1mi0viGS\" target=\"_blank\">百度云</a>）好了，请尽情享用吧！</p>\n<p>如果你喜欢本文，记得给我在下面点个 zan 哦。</p>\n<h2 id=\"机器学习\">机器学习\n</h2><p>这里我从一些和机器学习算法相关的流程图和表格中选择了我认为最全面的几个并在下面罗列出来。</p>\n<h3 id=\"Neural-Network-Architectures\">Neural Network Architectures\n</h3><p>链接: <a href=\"http://www.asimovinstitute.org/neural-network-zoo/\" target=\"_blank\" rel=\"external\">http://www.asimovinstitute.org/neural-network-zoo/</a><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/NN.png\" alt=\"\"></p>\n<p> </p>\n<p style=\"text-align: center;\"><em>The Neural Network Zoo</em></p>\n<h3 id=\"Microsoft-Azure-Algorithm-Flowchart\">Microsoft Azure Algorithm Flowchart\n</h3><p>链接: <a href=\"https://docs.microsoft.com/en-us/azure/machine-learning/machine-learning-algorithm-cheat-sheet\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">https://docs.microsoft.com/en-us/azure/machine-learning/machine-learning-algorithm-cheat-sheet</span></a></p>\n<p><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/MS.png\" alt=\"\"></p>\n<p style=\"text-align: center;\"><em>Machine learning algorithm cheat sheet for Microsoft Azure Machine Learning Studio</em></p>\n<h3 id=\"SAS-Algorithm-Flowchart\">SAS Algorithm Flowchart\n</h3><p>链接: <a href=\"http://blogs.sas.com/content/subconsciousmusings/2017/04/12/machine-learning-algorithm-use/\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">http://blogs.sas.com/content/subconsciousmusings/2017/04/12/machine-learning-algorithm-use/</span></a></p>\n<p><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/SAS.png\" alt=\"\"></p>\n<p style=\"text-align: center;\"><em>SAS: Which machine learning algorithm should I use?</em></p>\n<h3 id=\"Algorithm-Summary\">Algorithm Summary\n</h3><p>链接: <a href=\"http://machinelearningmastery.com/a-tour-of-machine-learning-algorithms/\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">http://machinelearningmastery.com/a-tour-of-machine-learning-algorithms/</span></a></p>\n<p><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/AS.png\" alt=\"\"></p>\n<p style=\"text-align: center;\"><em>A Tour of Machine Learning Algorithms</em></p>\n<p style=\"text-align: center;\"><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/best.jpeg\" rel=\"gallery0\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/best.jpeg\" alt=\"\"></a><br>\n<em>Which are the best known machine learning algorithms?</em></p>\n<h3 id=\"Algorithm-Pro-Con\">Algorithm Pro/Con\n</h3><p>链接: <a href=\"https://blog.dataiku.com/machine-learning-explained-algorithms-are-your-friend\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">https://blog.dataiku.com/machine-learning-explained-algorithms-are-your-friend</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/CON.jpeg\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/CON.jpeg\" alt=\"\"></span></a></p>\n<h2 id=\"Python\">Python\n</h2><p>网上在线的Python资源可以说是相当的多。在这一部分，我挑选了我遇到的几个最好的速查表呈献给大家。</p>\n<h3 id=\"ML算法\">ML算法\n</h3><p>链接: <a href=\"https://www.analyticsvidhya.com/blog/2015/09/full-cheatsheet-machine-learning-algorithms/\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">https://www.analyticsvidhya.com/blog/2015/09/full-cheatsheet-machine-learning-algorithms/</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/PYALGO.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/PYALGO.png\" alt=\"\"></span></a></p>\n<h3 id=\"Python基础\">Python基础\n</h3><p>链接: <a href=\"http://datasciencefree.com/python.pdf\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">http://datasciencefree.com/python.pdf</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/PYBASIC.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/PYBASIC.png\" alt=\"\"></span></a></p>\n<p>链接: <a href=\"https://www.datacamp.com/community/tutorials/python-data-science-cheat-sheet-basics#gs.0x1rxEA\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">https://www.datacamp.com/community/tutorials/python-data-science-cheat-sheet-basics#gs.0x1rxEA</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/PYBASIC2.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/PYBASIC2.png\" alt=\"\"></span></a></p>\n<h3 id=\"Numpy\">Numpy\n</h3><p>链接: <a href=\"https://www.dataquest.io/blog/numpy-cheat-sheet/\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">https://www.dataquest.io/blog/numpy-cheat-sheet/</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/NUMPY.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/NUMPY.png\" alt=\"\"></span></a></p>\n<p>链接: <a href=\"http://datasciencefree.com/numpy.pdf\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">http://datasciencefree.com/numpy.pdf</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/numpy-pdf.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/numpy-pdf.png\" alt=\"\"></span></a></p>\n<p>链接: <a href=\"https://www.datacamp.com/community/blog/python-numpy-cheat-sheet#gs.Nw3V6CE\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">https://www.datacamp.com/community/blog/python-numpy-cheat-sheet#gs.Nw3V6CE</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/numpy3.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/numpy3.png\" alt=\"\"></span></a></p>\n<p>链接: <a href=\"https://github.com/donnemartin/data-science-ipython-notebooks/blob/master/numpy/numpy.ipynb\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">https://github.com/donnemartin/data-science-ipython-notebooks/blob/master/numpy/numpy.ipynb</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/numpy4.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/numpy4.png\" alt=\"\"></span></a></p>\n<h3 id=\"Pandas\">Pandas\n</h3><p>链接: <a href=\"http://datasciencefree.com/pandas.pdf\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">http://datasciencefree.com/pandas.pdf</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/pandas.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/pandas.png\" alt=\"\"></span></a></p>\n<p>链接: <a href=\"https://www.datacamp.com/community/blog/python-pandas-cheat-sheet#gs.S4P4T=U\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">https://www.datacamp.com/community/blog/python-pandas-cheat-sheet#gs.S4P4T=U</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/pandas2.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/pandas2.png\" alt=\"\"></span></a></p>\n<p>链接: <a href=\"https://github.com/donnemartin/data-science-ipython-notebooks/blob/master/pandas/pandas.ipynb\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">https://github.com/donnemartin/data-science-ipython-notebooks/blob/master/pandas/pandas.ipynb</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/pandas3.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/pandas3.png\" alt=\"\"></span></a></p>\n<h3 id=\"Matplotlib\">Matplotlib\n</h3><p>链接: <a href=\"https://www.datacamp.com/community/blog/python-matplotlib-cheat-sheet\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">https://www.datacamp.com/community/blog/python-matplotlib-cheat-sheet</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/matplotlib.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/matplotlib.png\" alt=\"\"></span></a></p>\n<p>链接: <a href=\"https://github.com/donnemartin/data-science-ipython-notebooks/blob/master/matplotlib/matplotlib.ipynb\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">https://github.com/donnemartin/data-science-ipython-notebooks/blob/master/matplotlib/matplotlib.ipynb</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/matplotlib2.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/matplotlib2.png\" alt=\"\"></span></a></p>\n<h3 id=\"Scikit-Learn\">Scikit Learn\n</h3><p>链接: <a href=\"https://www.datacamp.com/community/blog/scikit-learn-cheat-sheet#gs.fZ2A1Jk\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">https://www.datacamp.com/community/blog/scikit-learn-cheat-sheet#gs.fZ2A1Jk</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/skl.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/skl.png\" alt=\"\"></span></a></p>\n<p>链接: <a href=\"http://peekaboo-vision.blogspot.de/2013/01/machine-learning-cheat-sheet-for-scikit.html\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">http://peekaboo-vision.blogspot.de/2013/01/machine-learning-cheat-sheet-for-scikit.html</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/skl2.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/skl2.png\" alt=\"\"></span></a></p>\n<p>链接: <a href=\"https://github.com/rcompton/ml_cheat_sheet/blob/master/supervised_learning.ipynb\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">https://github.com/rcompton/ml_cheat_sheet/blob/master/supervised_learning.ipynb</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/skl3.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/skl3.png\" alt=\"\"></span></a></p>\n<h3 id=\"Tensorflow\">Tensorflow\n</h3><p>链接: <a href=\"https://github.com/aymericdamien/TensorFlow-Examples/blob/master/notebooks/1_Introduction/basic_operations.ipynb\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">https://github.com/aymericdamien/TensorFlow-Examples/blob/master/notebooks/1_Introduction/basic_operations.ipynb</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/tf.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/tf.png\" alt=\"\"></span></a></p>\n<h3 id=\"Pytorch\">Pytorch\n</h3><p>链接: <a href=\"https://github.com/bfortuner/pytorch-cheatsheet\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">https://github.com/bfortuner/pytorch-cheatsheet</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/torch.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/torch.png\" alt=\"\"></span></a></p>\n<h2 id=\"数学\">数学\n</h2><p>如果你想真正的理解机器学习，你需要有扎实的统计学(尤其是概率论), 线性代数以及微积分基础。我在上大学的时候辅修了数学专业，但是我肯定还是需要对这些数学知识进行复习。如果你想理解常用机器学习算法背后的数学原理，那么下面的这些速查表将会是你需要的。</p>\n<h3 id=\"概率论\">概率论\n</h3><p>链接: <a href=\"http://www.wzchen.com/s/probability_cheatsheet.pdf\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">http://www.wzchen.com/s/probability_cheatsheet.pdf</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/prob.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/prob.png\" alt=\"\"></span></a></p>\n<h3 id=\"线性代数\">线性代数\n</h3><p>链接: <a href=\"https://minireference.com/static/tutorials/linear_algebra_in_4_pages.pdf\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">https://minireference.com/static/tutorials/linear_algebra_in_4_pages.pdf</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/la.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/la.png\" alt=\"\"></span></a></p>\n<h3 id=\"统计学\">统计学\n</h3><p>链接: <a href=\"http://web.mit.edu/~csvoss/Public/usabo/stats_handout.pdf\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">http://web.mit.edu/~csvoss/Public/usabo/stats_handout.pdf</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/stat.png\" rel=\"gallery0\"><span style=\"color: #0066cc;\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/stat.png\" alt=\"\"></span></a></p>\n<h3 id=\"微积分\">微积分\n</h3><p>链接: <a href=\"http://tutorial.math.lamar.edu/getfile.aspx?file=B,41,N\" target=\"_blank\" rel=\"external\"><span style=\"color: #0066cc;\">http://tutorial.math.lamar.edu/getfile.aspx?file=B,41,N</span></a></p>\n<p><a class=\"fancybox\" href=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/calculus.png\" rel=\"gallery0\"><img src=\"http://pytlab.org/assets/images/blog_img/2017-07-25-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-Python-%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E7%9A%84%E9%80%9F%E6%9F%A5%E8%A1%A8/calculus.png\" alt=\"\"></a></p>\n<p>打包下载：<a href=\"https://www.dropbox.com/s/v3yg8djhdf24g6v/UnsupervisedMethods.com%20-%20Cheat%20Sheets.zip?dl=0\" target=\"_blank\">Dropbox</a>、<a href=\"https://pan.baidu.com/s/1mi0viGS\" target=\"_blank\">百度云</a></p>\n\r\n        \r\n            <blockquote class=\"rewards\">\n        <p><strong>打赏支持我翻译更多好文章，谢谢！</strong></p>\n        <a href=\"#rewardbox\" id=\"rewards-button\" class=\"fancybox\"><span class=\"btn-bluet-blue href-style\"><i class=\"fa fa-jpy\"></i> 打赏译者</span></a>\n    </blockquote>\n\n    <div id=\"rewardbox\">\n        <h4>打赏支持我翻译更多好文章，谢谢！</h4>\n                <p>\n                        <img src=\"http://jbcdn2.b0.upaiyun.com/2016/05/c3d3aeee3e50259c10c3524201fc68db.jpg\">\n            \n                    </p>\n    </div>\n\n    \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112009\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112009votetotal\">5</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112009\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 22 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 1 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n<div id=\"author-bio\">\r\n\t\r\n\t<h3 class=\"widget-title\">\r\n\t关于作者：<a target=\"_blank\" href=\"http://www.jobbole.com/members/shaozhengjiang\">iPytLab</a>\r\n\t</h3>\r\n\t<div class=\"alignleft\">\r\n\t\t<a target=\"_blank\" href=\"http://www.jobbole.com/members/shaozhengjiang\">\r\n\t\t\t<img src=\"http://jbcdn2.b0.upaiyun.com/2017/07/d3f741a9dd5c4194b365e95b06a56c09.jpeg\">\r\n\t\t</a>\r\n\t</div>\r\n\r\n    <div class=\"author-bio-info\">\r\n\r\n        <span class=\"author-bio-info-block\">\r\n            喜欢写程序的计算化学狗，Python/C/C++/Fortran, 个人博客 http://pytlab.org        </span>\r\n        <span class=\"author-bio-info-block\">\r\n            <a href=\"http://www.jobbole.com/members/shaozhengjiang\" target=\"_blank\"><i class=\"fa fa-user\"></i> 个人主页</a> ·\r\n            <a href=\"http://blog.jobbole.com/author/shaozhengjiang/\" target=\"_blank\"><i class=\"fa fa-file-text-o\"></i> 我的文章</a>\r\n\r\n             · <a title=\"声望值\" target=\"_blank\" href=\"http://www.jobbole.com/members/shaozhengjiang/reputation/\"><i class=\"fa fa-graduation-cap\"></i> 11</a> · <a title=\"我的网站\" target=\"_blank\" href=\"http://pytlab.org\"><i class=\"fa fa-link\"></i></a> <a title=\"微博主页\" target=\"_blank\" href=\"http://weibo.com/shaowugui\"><i class=\"fa fa-weibo\"></i></a> <a title=\"GitHub主页\" target=\"_blank\" href=\"https://github.com/PytLab\"><i class=\"fa fa-github\"></i></a> <a title=\"Stack Overflow主页\" target=\"_blank\" href=\"http://stackoverflow.com/users/4014840/pytlab\"><i class=\"fa fa-stack-overflow\"></i></a>         </span>\r\n    </div>\r\n\t<div class=\"clear\"></div>\r\n</div>\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "5", "fav_nums": "22", "comment_nums": "1", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2017/04/ff247977ac3e5237654ad324e8c880ed.jpg"]},{"url_object_id": "42ebcbade0688b35076d01309348c96f", "create_date": "2017/07/27", "front_image_path": "full/75f6595b87bc254afe77bc1151f1aea91fb72f4b.jpg", "title": "MySQL 高性能表设计规范", "url": "http://blog.jobbole.com/112035/", "tags": "IT技术,MySQL,数据库", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a target=\"_blank\" href=\"http://www.jianshu.com/p/f797bbe11d76\">高广超</a>   </div><div>\n<div>\n<p>良好的逻辑设计和物理设计是高性能的基石， 应该根据系统将要执行的查询语句来设计schema, 这往往需要权衡各种因素。</p>\n<h2>一、选择优化的数据类型</h2>\n<p>MySQL支持的数据类型非常多， 选择正确的数据类型对于获得高性能至关重要。</p>\n<h4>更小的通常更好</h4>\n<p>更小的数据类型通常更快， 因为它们占用更少的磁盘、 内存和CPU缓存， 并且处理时需要的CPU周期也更少。</p>\n<h4>简单就好</h4>\n<p>简单数据类型的操作通常需要更少的CPU周期。 例如， 整型比字符操作代价更低， 因为字符集和校对规则（排序规则 ）使字符比较比整型比较更复杂。</p>\n<h4>尽量避免NULL</h4>\n<p>如果查询中包含可为NULL 的列， 对MySQL来说更难优化， 因为可为NULL 的列使得索引、 索引统计和值比较都更复杂。 可为NULL的列会使用更多的存储空间， 在MySQL里也需要特殊处理。 当可为NULL的列被索引时， 每个索引记录需要一个额外的字节， 在MyISAM里甚至还可能导致固定大小的索引（例如只有一个整数列的索引）变成可变大小的索引。<br>\n当然也有例外， 例如InnoDB 使用单独的位 (bit) 存储NULL值， 所以对于稀疏数据有很好的空间效率。</p>\n<h3>1.整数类型</h3>\n<p>有两种类型的数字：整数 (whole number) 和实数 (real number) 。 如果存储整数， 可以使用这几种整数类型：TINYINT, SMALLINT, MEDIUMINT, INT, BIGINT。分别使用8,16, 24, 32, 64位存储空间。</p>\n<p>整数类型有可选的 **UNSIGNED ** 属性，表示不允许负值，这大致可以使正数的上限提高一倍。 例如 TINYINT. UNSIGNED 可以存储的范围是 0 – 255, 而 TINYINT 的存储范围是 -128 -127 。</p>\n<p><strong>有符号和无符号类型使用相同的存储空间，并具有相同的性能</strong> ， 因此可以根据实际情况选择合适的类型。</p>\n<p>你的选择决定 MySQL 是怎么在内存和磁盘中保存数据的。 然而， 整数计算一般使用64 位的 BIGINT 整数， 即使在 32 位环境也是如此。（ 一些聚合函数是例外， 它们使用DECIMAL 或 DOUBLE 进行计算）。</p>\n<p>MySQL 可以为整数类型指定宽度， 例如 INT(11), 对大多数应用这是没有意义的：它不会限制值的合法范围，只是规定了MySQL 的一些交互工具（例如 MySQL 命令行客户端）用来显示字符的个数。 对于存储和计算来说， INT(1) 和 INT(20) 是相同的。</p>\n<h3>2.实数类型</h3>\n<p>实数是带有小数部分的数字。 然而， 它们不只是为了存储小数部分，也可以使用DECIMAL 存储比 BIGINT 还大的整数。</p>\n<p>FLOAT和DOUBLE类型支持使用标准的浮点运算进行近似计算。<br>\nDECIMAL类型用于存储精确的小数。<br>\n浮点和DECIMAL类型都可以指定精度。 对于DECIMAL列， 可以指定小数点前后所允许的最大位数。这会影响列的空间消耗。</p>\n<p>有多种方法可以指定浮点列所需要的精度， 这会使得MySQL选择不同的数据类型，或者在存储时对值进行取舍。 这些精度定义是非标准的，<strong>所以我们建议只指定数据类型，不指定精度。</strong></p>\n<p><strong>浮点类型在存储同样范围的值时， 通常比DECIMAL使用更少的空间。FLOAT使用4个字节存储。DOUBLE占用8个字节，相比FLOAT有更高的精度和更大的范围。和整数类型一样， 能选择的只是存储类型； MySQL使用DOUBLE作为内部浮点计算的类型。</strong></p>\n<p>因为需要额外的空间和计算开销，所以应该尽量只在对小数进行精确计算时才使用DECIMAL。<strong>但在数据最比较大的时候， 可以考虑使用BIGINT代替DECIMAL, 将需要存储的货币单位根据小数的位数乘以相应的倍数即可。</strong></p>\n<h3>3.字符串类型</h3>\n<h4>VARCHAR</h4>\n<p>用于存储可变⻓字符串，长度支持到65535<br>\n需要使用1或2个额外字节记录字符串的长度<br>\n适合：字符串的最大⻓度比平均⻓度⼤很多；更新很少</p>\n<h4>CHAR</h4>\n<p>定⻓，⻓度范围是1~255<br>\n适合：存储很短的字符串，或者所有值接近同一个长度；经常变更</p>\n<h4>慷慨是不明智的</h4>\n<p>使用VARCHAR(5)和VARCHAR(200)存储’hello’的空间开销是一样的。 那么使用更短的列有什么优势吗？</p>\n<p>事实证明有很大的优势。 更长的列会消耗更多的内存， 因为MySQL通常会分配固定大小的内存块来保存内部值。 尤其是使用内存临时表进行排序或操作时会特别糟糕。 在利用磁盘临时表进行排序时也同样糟糕。</p>\n<p>所以最好的策略是只分配真正需要的空间。</p>\n<h3>4.BLOB和TEXT类型</h3>\n<p>BLOB和 TEXT都是为存储很大的数据而设计的字符串数据类型， 分别采用 二进制和字符方式存储 。</p>\n<p>与其他类型不同， MySQL把每个BLOB和TEXT值当作一个独立的对象处理。 存储引擎在存储时通常会做特殊处理。 当BLOB和TEXT值太大时，InnoDB会使用专门的 “外部“存储区域来进行存储， 此时每个值在行内需要1 – 4个字节存储 存储区域存储实际的值。</p>\n<p>BLOB 和 TEXT 之间仅有的不同是 BLOB 类型存储的是二进制数据， 没有排序规则或字符集， 而 TEXT类型有字符集和排序规则</p>\n<h3>5.日期和时间类型</h3>\n<p>大部分时间类型都没有替代品， 因此没有什么是最佳选择的问题。 唯一的问题是保存日期和时间的时候需要做什么。 MySQL提供两种相似的日期类型： DATE TIME和 TIMESTAMP。</p>\n<p>但是目前我们更建议存储时间戳的方式，因此该处不再对 DATE TIME和 TIMESTAMP做过多说明。</p>\n<h3>5.其他类型</h3>\n<h4>5.1选择标识符</h4>\n<p>在可以满足值的范围的需求， 井且预留未来增长空间的前提下， 应该选择最小的数据类型。</p>\n<h5>整数类型</h5>\n<p>整数通常是标识列最好的选择， 因为它们很快并且可以使用AUTO_INCREMENT。</p>\n<h5>ENUM和SET类型</h5>\n<p>对于标识列来说，EMUM和SET类型通常是一个糟糕的选择， 尽管对某些只包含固定状态或者类型的静态 ”定义表” 来说可能是没有问题的。ENUM和SET列适合存储固定信息， 例如有序的状态、 产品类型、 人的性别。</p>\n<h5>字符串类型</h5>\n<p>如果可能， 应该避免使用字符串类型作为标识列， 因为它们很消耗空间， 并且通常比数字类型慢。</p>\n<p>对于完全 “随机” 的字符串也需要多加注意， 例如 MDS() 、 SHAl() 或者 UUID() 产生的字符串。 这些函数生成的新值会任意分布在很大的空间内， 这会导致 INSERT 以及一些SELECT语句变得很慢。如果存储 UUID 值， 则应该移除 “-“符号。</p>\n<h4>5.2特殊类型数据</h4>\n<p>某些类型的数据井不直接与内置类型一致。 低千秒级精度的时间戳就是一个例子，另一个例子是以个1Pv4地址，人们经常使用VARCHAR(15)列来存储IP地址，然而， 它们实际上是32位无符号整数， 不是字符串。用小数点将地址分成四段的表示方法只是为了让人们阅读容易。所以应该用无符号整数存储IP地址。MySQL提供INET_ATON()和INET_NTOA()函数在这两种表示方法之间转换。</p>\n<h2>二、表结构设计</h2>\n<h3>1.范式和反范式</h3>\n<p>对于任何给定的数据通常都有很多种表示方法， 从完全的范式化到完全的反范式化， 以及两者的折中。 在范式化的数据库中， 每个事实数据会出现并且只出现一次。 相反， 在反范式化的数据库中， 信息是冗余的， 可能会存储在多个地方。</p>\n<h4>范式的优点和缺点</h4>\n<p>为性能提升考虑时，经常会被建议对 schema 进行范式化设计，尤其是写密集的场景。</p>\n<ul>\n<li>范式化的更新操作通常比反范式化要快。</li>\n<li>当数据较好地范式化时，就只有很少或者没有重复数据，所以只需要修改更少的数据。</li>\n<li>范式化的表通常更小，可以更好地放在内存里，所以执行操作会更快。</li>\n<li>很少有多余的数据意味着检索列表数据时更少需要 DISTINCT 或者 GROUP BY语句。</li>\n</ul>\n<h4>反范式的优点和缺点</h4>\n<p>不需要关联表，则对大部分查询最差的情况——即使表没有使用索引——是全表扫描。 当数据比内存大时这可能比关联要快得多，因为这样避免了随机I/0。</p>\n<p>单独的表也能使用更有效的索引策略。</p>\n<h4>混用范式化和反范式化</h4>\n<p>在实际应用中经常需要混用，可能使用部分范式化的 schema 、 缓存表，以及其他技巧。<br>\n表适当增加冗余字段，如性能优先，但会增加复杂度。可避免表关联查询。</p>\n<h4>简单熟悉数据库范式</h4>\n</div>\n</div>\n<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598722b937844835384877\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n第一范式(1NF)：字段值具有原子性,不能再分(所有关系型数据库系统都满足第一范式);\r\n 例如：姓名字段,其中姓和名是一个整体,如果区分姓和名那么必须设立两个独立字段;\r\n \r\n第二范式(2NF)：一个表必须有主键,即每行数据都能被唯一的区分;\r\n 备注：必须先满足第一范式;\r\n \r\n第三范式(3NF)：一个表中不能包涵其他相关表中非关键字段的信息,即数据表不能有沉余字段;\r\n 备注：必须先满足第二范式;</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598722b937844835384877-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598722b937844835384877-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-598722b937844835384877-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598722b937844835384877-4\">4</div><div class=\"crayon-num\" data-line=\"crayon-598722b937844835384877-5\">5</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598722b937844835384877-6\">6</div><div class=\"crayon-num\" data-line=\"crayon-598722b937844835384877-7\">7</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598722b937844835384877-8\">8</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598722b937844835384877-1\">第一范式<span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">1NF</span><span class=\"crayon-sy\">)</span>：字段值具有原子性<span class=\"crayon-sy\">,</span>不能再分<span class=\"crayon-sy\">(</span>所有关系型数据库系统都满足第一范式<span class=\"crayon-sy\">)</span><span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598722b937844835384877-2\"><span class=\"crayon-h\"> </span>例如：姓名字段<span class=\"crayon-sy\">,</span>其中姓和名是一个整体<span class=\"crayon-sy\">,</span>如果区分姓和名那么必须设立两个独立字段<span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-598722b937844835384877-3\"><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598722b937844835384877-4\">第二范式<span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">2NF</span><span class=\"crayon-sy\">)</span>：一个表必须有主键<span class=\"crayon-sy\">,</span>即每行数据都能被唯一的区分<span class=\"crayon-sy\">;</span></div><div class=\"crayon-line\" id=\"crayon-598722b937844835384877-5\"><span class=\"crayon-h\"> </span>备注：必须先满足第一范式<span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598722b937844835384877-6\"><span class=\"crayon-h\"> </span></div><div class=\"crayon-line\" id=\"crayon-598722b937844835384877-7\">第三范式<span class=\"crayon-sy\">(</span><span class=\"crayon-cn\">3NF</span><span class=\"crayon-sy\">)</span>：一个表中不能包涵其他相关表中非关键字段的信息<span class=\"crayon-sy\">,</span>即数据表不能有沉余字段<span class=\"crayon-sy\">;</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598722b937844835384877-8\"><span class=\"crayon-h\"> </span>备注：必须先满足第二范式<span class=\"crayon-sy\">;</span></div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0020 seconds] -->\r\n<p></p>\n<div>\n<div>\n<h3>2.表字段少⽽精</h3>\n<ul>\n<li>I/O高效</li>\n<li>字段分开维护简单</li>\n<li>单表1G体积 500W⾏行评估</li>\n<li>单⾏行不超过200Byte</li>\n<li>单表不超过50个INT字段</li>\n<li>单表不超过20个CHAR(10)字段</li>\n<li>建议单表字段数控制在20个以内</li>\n<li>拆分TEXT/BLOB，TEXT类型处理性能远低于VARCHAR，强制生成硬盘临时表浪费更多空间。</li>\n</ul>\n<h4>参考资料：</h4>\n<p>高性能mysql第三版</p>\n</div>\n</div>\n<hr>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112035\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112035votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112035\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 5 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i> 2 评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "1", "fav_nums": "5", "comment_nums": "2", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2015/11/dea4002e77dd3ecd398568bf746ea46c.png"]},{"url_object_id": "88788cea8b7d43a9d12b07781442834c", "create_date": "2017/07/26", "front_image_path": "full/80b4614d2c41c6d4f76f79bebe8e4d4beca33f43.jpg", "title": "教你如何比谷歌搜索更快速有效地利用 man", "url": "http://blog.jobbole.com/112016/", "tags": "IT技术,Linux", "content": "<div class=\"entry\">\r\n\r\n        \t\t\t<div class=\"textwidget\"></div>\n\t\t\r\n\t\t<div class=\"copyright-area\">原文出处： <a ref=\"nofollow\" target=\"_blank\" href=\"https://opensource.com/article/17/7/using-man-pages\">Greg Pittman</a>   译文出处：<a target=\"_blank\" href=\"https://linux.cn/article-8722-1.html\">Linux中国/toyijiu</a>   </div><blockquote><p>Linux 的帮助手册其实拥有很多有用的信息，而且比你想象中更容易使用</p></blockquote>\n<p>我们通常通过 google 来查询 Linux 中的命令说明，但是其实还有一个更好的办法：那就是通过 Linux 自带的 <strong>man 帮助页</strong>来查询命令详尽完整的使用说明。</p>\n<p>man 页面的历史本身比 Linux 还长，可以追溯到 Unix 早期那个年代。 通过<a href=\"https://en.wikipedia.org/wiki/Man_page\">这个 Wikipedia</a> 可以知道，Dennis Ritchie 和 Ken Thompson 在 1971 年写了第一个 man 帮助页，那个年代的计算器使用的还是像烤箱一样的计算机，个人电脑还未出世。man 帮助页也有它自己的一套设计精炼的语法，和 Unix 与 Linux 一样，man 帮助页也不是一成不变的，它就像 Linux 内核一样不停地发展更新。</p>\n<p>Man 帮助页通过数字标识符来分成不同类型的内容：</p>\n<ol>\n<li>一般用户命令</li>\n<li>系统调用命令</li>\n<li>库函数</li>\n<li>特殊的文件和驱动程序</li>\n<li>文件格式</li>\n<li>游戏和屏保</li>\n<li>杂项</li>\n<li>系统管理命令和守护进程</li>\n</ol>\n<p>尽管如此，用户一般也不需要知道他们想查询的命令是属于哪一个类型的。</p>\n<p>这些文件格式化的方式在当今许多用户看来有点古怪。因为最开始他们是用 <strong>trooff</strong> 的方式，通过 PostScript 打印机来打印，所以包含了头部和布局方面的格式化信息。在 Linux 中，取而代之使用了一种叫做 <a href=\"https://en.wikipedia.org/wiki/Groff_(software)\">groff</a> 的方法。</p>\n<p>在我的 Fedora 系统中，man 帮助页相关的文件存储在 <code>/usr/share/man</code> 下的子目录中（比如 <code>man1</code> 存储第一部分的命令），还有进一步的子目录用于存储 man 帮助页的翻译。</p>\n<p>如果你在 Shell 中查找 <code>man</code> 命令的 man 帮助页，你时间看到将是 gzip 工具压缩的 <code>man.1.gz</code> 文件。想要查询 man 帮助页，需要输入类似如下命令：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598722b95d94a851536510\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nman man\r\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598722b95d94a851536510-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598722b95d94a851536510-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598722b95d94a851536510-1\"><span class=\"crayon-e\">man </span><span class=\"crayon-i\">man</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598722b95d94a851536510-2\"> </div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p>这个例子会显示 <code>man</code> 命令的 man 帮助页，这将先解压 man 帮助页文件，然后解释格式化指令并用 <code>less</code> 显示结果，所以导航操作和在 <code>less</code> 中一样。</p>\n<p>所有的 man 帮助页都应该显示这些子段落：<strong>Name</strong>、 <strong>Synopsis</strong>、 <strong>Description</strong>、<strong>Examples</strong>、<strong>See</strong>、<strong>Also</strong>。有些还会添加一些额外的子段落，比如 <strong>Options</strong>、 <strong>Exit</strong>、<strong>Status</strong>、 <strong>Environment</strong>、<strong>Bugs</strong>、<strong>Files</strong>、<strong>Author</strong>、<strong>Reporting</strong>、<strong>Bugs</strong>、<strong>History</strong>、<strong>Copyright</strong>。</p>\n<h3 id=\"toc_1\">详细说明一个 man 帮助页</h3>\n<p>为了更详细地介绍一个典型的 man 帮助页，就用 ls 命令的帮助页来分析吧，在 <strong>Name</strong> 分段下，我们可以看到如下内容：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598722b95d957912998503\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nls - list directory contents\r\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598722b95d957912998503-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598722b95d957912998503-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598722b95d957912998503-1\"><span class=\"crayon-v\">ls</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-h\"> </span><span class=\"crayon-e\">list </span><span class=\"crayon-e\">directory </span><span class=\"crayon-i\">contents</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598722b95d957912998503-2\"> </div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p>它会简要地告诉我 <code>ls</code> 这条命令的作用.</p>\n<p>在 <code>Synopsis</code> 分段下，我们可以看到如下的内容:</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598722b95d95c387705069\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nls [OPTION]... [FILE]…\r\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598722b95d95c387705069-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598722b95d95c387705069-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598722b95d95c387705069-1\"><span class=\"crayon-i\">ls</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">OPTION</span><span class=\"crayon-sy\">]</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-sy\">.</span><span class=\"crayon-h\"> </span><span class=\"crayon-sy\">[</span><span class=\"crayon-v\">FILE</span><span class=\"crayon-sy\">]</span>…</div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598722b95d95c387705069-2\"> </div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0005 seconds] -->\r\n<p>任何在中括号中的元素都是可选的。你可以只输入 <code>ls</code> 命令，后面不接任何参数。参数后面的省略号表示你可以添加任意多个彼此兼容的参数，以及许多文件名。对于 <code>[FILE]</code> 参数，你可以指定具体的目录名，或者可以使用通配符 <code>*</code>，比如这个例子，它会显示 <code>Documents</code> 文件夹下的 <code>.txt</code> 文件：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598722b95d960278900040\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nls Documents/*.txt\r\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598722b95d960278900040-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598722b95d960278900040-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598722b95d960278900040-1\"><span class=\"crayon-e\">ls </span><span class=\"crayon-v\">Documents</span><span class=\"crayon-o\">/</span><span class=\"crayon-o\">*</span><span class=\"crayon-sy\">.</span><span class=\"crayon-i\">txt</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598722b95d960278900040-2\"> </div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p>在 <strong>Description</strong> 分段下, 我们可以看到关于这条命令更加详细的信息，还有关于这条命令各个参数作用的详细介绍的列表，比如说 <code>ls</code> 命令第一个选项 <code>-a</code> 参数，它的作用是显示包括隐藏文件/目录在内的所有文件：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598722b95d963853617369\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\n-a, --all \r\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598722b95d963853617369-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598722b95d963853617369-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598722b95d963853617369-1\"><span class=\"crayon-o\">-</span><span class=\"crayon-v\">a</span><span class=\"crayon-sy\">,</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">--</span><span class=\"crayon-i\">all</span><span class=\"crayon-h\"> </span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598722b95d963853617369-2\"> </div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p>如果我们想用这些参数，要么用它们的别名，比如 <code>-a</code>，要么用它们的全名，比如 <code>--all</code>（两条中划线）。然而并不是所有参数都有全名和别名（比如 <code>--author</code> 只有一种），而且两者的名字并不总是相互关联的（<code>-F</code> 和 <code>--classify</code>）。当你想用多个参数时，要么以空格隔开，要么共用一个连字符 <code>-</code>，在连字符后连续输入你需要的参数（不要添加空格）。比如下面两个等价的例子：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598722b95d967375859980\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nls -a -d -l\r\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598722b95d967375859980-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598722b95d967375859980-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598722b95d967375859980-1\"><span class=\"crayon-v\">ls</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">a</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-v\">d</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">l</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598722b95d967375859980-2\"> </div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0004 seconds] -->\r\n<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598722b95d96c858260022\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\nls -adl\r\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598722b95d96c858260022-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598722b95d96c858260022-2\">2</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598722b95d96c858260022-1\"><span class=\"crayon-v\">ls</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-i\">adl</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598722b95d96c858260022-2\"> </div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0003 seconds] -->\r\n<p>但是 <code>tar</code> 这个命令有些例外，由于一些历史遗留原因，当参数使用别名时可以不用添加连字符 <code>-</code>，因此以下两种命令都是合法的：</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->\r\n\r\n\t\t<div id=\"crayon-598722b95d970455905340\" class=\"crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate\" data-settings=\" minimize scroll-always\" style=\" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;\">\r\n\t\t\r\n\t\t\t<div class=\"crayon-toolbar\" data-settings=\" show\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><span class=\"crayon-title\"></span>\r\n\t\t\t<div class=\"crayon-tools\" style=\"font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;\"><div class=\"crayon-button crayon-nums-button\" title=\"切换是否显示行编号\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-plain-button\" title=\"纯文本显示代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-wrap-button\" title=\"切换自动换行\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-expand-button\" title=\"点击展开代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-copy-button\" title=\"复制代码\"><div class=\"crayon-button-icon\"></div></div><div class=\"crayon-button crayon-popup-button\" title=\"在新窗口中显示代码\"><div class=\"crayon-button-icon\"></div></div></div></div>\r\n\t\t\t<div class=\"crayon-info\" style=\"min-height: 18.2px !important; line-height: 18.2px !important;\"></div>\r\n\t\t\t<div class=\"crayon-plain-wrap\"><textarea wrap=\"soft\" class=\"crayon-plain print-no\" data-settings=\"dblclick\" readonly style=\"-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;\">\ntar -cvf filearchive.tar thisdirectory/\r\n\r\ntar cvf filearchive.tar thisdirectory/\r\n</textarea></div>\r\n\t\t\t<div class=\"crayon-main\" style=\"\">\r\n\t\t\t\t<table class=\"crayon-table\">\r\n\t\t\t\t\t<tr class=\"crayon-row\">\r\n\t\t\t\t<td class=\"crayon-nums \" data-settings=\"show\">\r\n\t\t\t\t\t<div class=\"crayon-nums-content\" style=\"font-size: 13px !important; line-height: 15px !important;\"><div class=\"crayon-num\" data-line=\"crayon-598722b95d970455905340-1\">1</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598722b95d970455905340-2\">2</div><div class=\"crayon-num\" data-line=\"crayon-598722b95d970455905340-3\">3</div><div class=\"crayon-num crayon-striped-num\" data-line=\"crayon-598722b95d970455905340-4\">4</div></div>\r\n\t\t\t\t</td>\r\n\t\t\t\t\t\t<td class=\"crayon-code\"><div class=\"crayon-pre\" style=\"font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;\"><div class=\"crayon-line\" id=\"crayon-598722b95d970455905340-1\"><span class=\"crayon-v\">tar</span><span class=\"crayon-h\"> </span><span class=\"crayon-o\">-</span><span class=\"crayon-e\">cvf </span><span class=\"crayon-v\">filearchive</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">tar </span><span class=\"crayon-v\">thisdirectory</span><span class=\"crayon-o\">/</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598722b95d970455905340-2\"> </div><div class=\"crayon-line\" id=\"crayon-598722b95d970455905340-3\"><span class=\"crayon-e\">tar </span><span class=\"crayon-e\">cvf </span><span class=\"crayon-v\">filearchive</span><span class=\"crayon-sy\">.</span><span class=\"crayon-e\">tar </span><span class=\"crayon-v\">thisdirectory</span><span class=\"crayon-o\">/</span></div><div class=\"crayon-line crayon-striped-line\" id=\"crayon-598722b95d970455905340-4\"> </div></div></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t</table>\r\n\t\t\t</div>\r\n\t\t</div>\r\n<!-- [Format Time: 0.0006 seconds] -->\r\n<p><strong>ls</strong> 的 <strong>Description</strong> 分段后是 <strong>Author</strong>、<strong>Reporting Bugs</strong>、<strong>Copyright</strong>、 <strong>See Also</strong> 等分段。</p>\n<p><strong>See Also</strong> 分段会提供一些相关的 man 帮助页，没事的话可以看看。毕竟除了命令外还有许多其他类型的 man 帮助页。</p>\n<p>有一些命令不是系统命令，而是 Bash 特有的，比如 <code>alias</code> 和 <code>cd</code>。这些 Bash 特有的命令可以在 <strong>BASH_BUILTINS</strong> man 帮助页中查看，和上面的比起来它们的描述更加精炼，不过内容都是类似的。</p>\n<p>其实通过 man 帮助页让你可以获得大量有用的信息，特别是当你想用一个已经很久没用过的命令，需要复习下这条命令的作用时。这个时候 man 帮助页饱受非议的简洁性反而对你来说是更好的。</p>\n<hr>\n<p>作者简介：</p>\n<p>Greg Pittman – Greg 是住在肯塔基州路易斯维尔的一位退休神经学家，但是却对计算机和编程保持着长久的兴趣，从二十世纪六十年代就开始捣腾 Fortran IV 了。随着 Linux 和开源软件的到来，更加激起了他去学习的兴趣并投身于这项事业中，并成为 Scribus 组织的一员。</p>\n<hr>\n\r\n        \r\n        \r\n        \n    <div class=\"post-adds\">\n        <span data-post-id=\"112016\" class=\" btn-bluet-bigger href-style vote-post-up   register-user-only \"><i class=\"fa  fa-thumbs-o-up\"></i> <h10 id=\"112016votetotal\">1</h10> 赞</span>\n        <span data-book-type=\"1\" data-site-id=\"2\" data-item-id=\"112016\" data-item-type=\"1\" class=\" btn-bluet-bigger href-style bookmark-btn  register-user-only \"><i class=\"fa fa-bookmark-o  \"></i> 4 收藏</span>\n\n                    <a href=\"#article-comment\"><span class=\"btn-bluet-bigger href-style hide-on-480\"><i class=\"fa fa-comments-o\"></i>  评论</span></a>\n        \n        \n        \n        <!-- JiaThis Button BEGIN -->\n        <div class=\"jiathis_style_24x24\" style=\"display: inline-flex; position: relative; margin: 0; clear: both;float: right;\">\n            <a class=\"jiathis_button_tsina\"></a>\n            <a class=\"jiathis_button_weixin\"></a>\n            <a class=\"jiathis_button_qzone\"></a>\n            <a class=\"jiathis_button_fb hide-on-480\"></a>\n            <a href=\"http://www.jiathis.com/share?uid=1745061\" class=\"jiathis jiathis_txt jiathis_separator jtico jtico_jiathis\" target=\"_blank\"></a>\n        </div>\n\n    </div>\n\n\n\n\r\n        <!-- BEGIN #author-bio -->\r\n\r\n\r\n<!-- END #author-bio -->\r\n\t</div>", "praise_nums": "1", "fav_nums": "4", "comment_nums": "", "front_image_url": ["http://jbcdn2.b0.upaiyun.com/2015/10/008d9c47f50ab5eac3f349d238b3b6dc.jpg"]}]